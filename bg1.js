var ur=Object.defineProperty;var hr=(e,t,n)=>t in e?ur(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var C=(e,t,n)=>(hr(e,typeof t!="symbol"?t+"":t,n),n);var le,g,Kt,q,st,qt,Le,Zt,_e={},Xt=[],fr=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function V(e,t){for(var n in t)e[n]=t[n];return e}function en(e){var t=e.parentNode;t&&t.removeChild(e)}function ge(e,t,n){var i,o,s,a={};for(s in t)s=="key"?i=t[s]:s=="ref"?o=t[s]:a[s]=t[s];if(arguments.length>2&&(a.children=arguments.length>3?le.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(s in e.defaultProps)a[s]===void 0&&(a[s]=e.defaultProps[s]);return ie(e,a,i,o,null)}function ie(e,t,n,i,o){var s={type:e,props:t,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:o??++Kt};return o==null&&g.vnode!=null&&g.vnode(s),s}function w(e){return e.children}function Y(e,t){this.props=e,this.context=t}function oe(e,t){if(t==null)return e.__?oe(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?oe(e):null}function tn(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return tn(e)}}function Re(e){(!e.__d&&(e.__d=!0)&&q.push(e)&&!ye.__r++||st!==g.debounceRendering)&&((st=g.debounceRendering)||qt)(ye)}function ye(){var e,t,n,i,o,s,a,l;for(q.sort(Le);e=q.shift();)e.__d&&(t=q.length,i=void 0,o=void 0,a=(s=(n=e).__v).__e,(l=n.__P)&&(i=[],(o=V({},s)).__v=s.__v+1,ze(l,s,o,n.__n,l.ownerSVGElement!==void 0,s.__h!=null?[a]:null,i,a??oe(s),s.__h),an(i,s),s.__e!=a&&tn(s)),q.length>t&&q.sort(Le));ye.__r=0}function nn(e,t,n,i,o,s,a,l,u,h){var c,p,f,d,m,k,y,S=i&&i.__k||Xt,b=S.length;for(n.__k=[],c=0;c<t.length;c++)if((d=n.__k[c]=(d=t[c])==null||typeof d=="boolean"||typeof d=="function"?null:typeof d=="string"||typeof d=="number"||typeof d=="bigint"?ie(null,d,null,null,d):Array.isArray(d)?ie(w,{children:d},null,null,null):d.__b>0?ie(d.type,d.props,d.key,d.ref?d.ref:null,d.__v):d)!=null){if(d.__=n,d.__b=n.__b+1,(f=S[c])===null||f&&d.key==f.key&&d.type===f.type)S[c]=void 0;else for(p=0;p<b;p++){if((f=S[p])&&d.key==f.key&&d.type===f.type){S[p]=void 0;break}f=null}ze(e,d,f=f||_e,o,s,a,l,u,h),m=d.__e,(p=d.ref)&&f.ref!=p&&(y||(y=[]),f.ref&&y.push(f.ref,null,d),y.push(p,d.__c||m,d)),m!=null?(k==null&&(k=m),typeof d.type=="function"&&d.__k===f.__k?d.__d=u=rn(d,u,e):u=sn(e,d,f,S,m,u),typeof n.type=="function"&&(n.__d=u)):u&&f.__e==u&&u.parentNode!=e&&(u=oe(f))}for(n.__e=k,c=b;c--;)S[c]!=null&&(typeof n.type=="function"&&S[c].__e!=null&&S[c].__e==n.__d&&(n.__d=on(i).nextSibling),cn(S[c],S[c]));if(y)for(c=0;c<y.length;c++)ln(y[c],y[++c],y[++c])}function rn(e,t,n){for(var i,o=e.__k,s=0;o&&s<o.length;s++)(i=o[s])&&(i.__=e,t=typeof i.type=="function"?rn(i,t,n):sn(n,i,i,o,i.__e,t));return t}function Q(e,t){return t=t||[],e==null||typeof e=="boolean"||(Array.isArray(e)?e.some(function(n){Q(n,t)}):t.push(e)),t}function sn(e,t,n,i,o,s){var a,l,u;if(t.__d!==void 0)a=t.__d,t.__d=void 0;else if(n==null||o!=s||o.parentNode==null)e:if(s==null||s.parentNode!==e)e.appendChild(o),a=null;else{for(l=s,u=0;(l=l.nextSibling)&&u<i.length;u+=1)if(l==o)break e;e.insertBefore(o,s),a=s}return a!==void 0?a:o.nextSibling}function on(e){var t,n,i;if(e.type==null||typeof e.type=="string")return e.__e;if(e.__k){for(t=e.__k.length-1;t>=0;t--)if((n=e.__k[t])&&(i=on(n)))return i}return null}function pr(e,t,n,i,o){var s;for(s in n)s==="children"||s==="key"||s in t||ve(e,s,null,n[s],i);for(s in t)o&&typeof t[s]!="function"||s==="children"||s==="key"||s==="value"||s==="checked"||n[s]===t[s]||ve(e,s,t[s],n[s],i)}function ot(e,t,n){t[0]==="-"?e.setProperty(t,n??""):e[t]=n==null?"":typeof n!="number"||fr.test(t)?n:n+"px"}function ve(e,t,n,i,o){var s;e:if(t==="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof i=="string"&&(e.style.cssText=i=""),i)for(t in i)n&&t in n||ot(e.style,t,"");if(n)for(t in n)i&&n[t]===i[t]||ot(e.style,t,n[t])}else if(t[0]==="o"&&t[1]==="n")s=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+s]=n,n?i||e.addEventListener(t,s?lt:at,s):e.removeEventListener(t,s?lt:at,s);else if(t!=="dangerouslySetInnerHTML"){if(o)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!=="width"&&t!=="height"&&t!=="href"&&t!=="list"&&t!=="form"&&t!=="tabIndex"&&t!=="download"&&t in e)try{e[t]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&t.indexOf("-")==-1?e.removeAttribute(t):e.setAttribute(t,n))}}function at(e){return this.l[e.type+!1](g.event?g.event(e):e)}function lt(e){return this.l[e.type+!0](g.event?g.event(e):e)}function ze(e,t,n,i,o,s,a,l,u){var h,c,p,f,d,m,k,y,S,b,_,x,N,I,v,E=t.type;if(t.constructor!==void 0)return null;n.__h!=null&&(u=n.__h,l=t.__e=n.__e,t.__h=null,s=[l]),(h=g.__b)&&h(t);try{e:if(typeof E=="function"){if(y=t.props,S=(h=E.contextType)&&i[h.__c],b=h?S?S.props.value:h.__:i,n.__c?k=(c=t.__c=n.__c).__=c.__E:("prototype"in E&&E.prototype.render?t.__c=c=new E(y,b):(t.__c=c=new Y(y,b),c.constructor=E,c.render=_r),S&&S.sub(c),c.props=y,c.state||(c.state={}),c.context=b,c.__n=i,p=c.__d=!0,c.__h=[],c._sb=[]),c.__s==null&&(c.__s=c.state),E.getDerivedStateFromProps!=null&&(c.__s==c.state&&(c.__s=V({},c.__s)),V(c.__s,E.getDerivedStateFromProps(y,c.__s))),f=c.props,d=c.state,c.__v=t,p)E.getDerivedStateFromProps==null&&c.componentWillMount!=null&&c.componentWillMount(),c.componentDidMount!=null&&c.__h.push(c.componentDidMount);else{if(E.getDerivedStateFromProps==null&&y!==f&&c.componentWillReceiveProps!=null&&c.componentWillReceiveProps(y,b),!c.__e&&c.shouldComponentUpdate!=null&&c.shouldComponentUpdate(y,c.__s,b)===!1||t.__v===n.__v){for(t.__v!==n.__v&&(c.props=y,c.state=c.__s,c.__d=!1),c.__e=!1,t.__e=n.__e,t.__k=n.__k,t.__k.forEach(function(j){j&&(j.__=t)}),_=0;_<c._sb.length;_++)c.__h.push(c._sb[_]);c._sb=[],c.__h.length&&a.push(c);break e}c.componentWillUpdate!=null&&c.componentWillUpdate(y,c.__s,b),c.componentDidUpdate!=null&&c.__h.push(function(){c.componentDidUpdate(f,d,m)})}if(c.context=b,c.props=y,c.__P=e,x=g.__r,N=0,"prototype"in E&&E.prototype.render){for(c.state=c.__s,c.__d=!1,x&&x(t),h=c.render(c.props,c.state,c.context),I=0;I<c._sb.length;I++)c.__h.push(c._sb[I]);c._sb=[]}else do c.__d=!1,x&&x(t),h=c.render(c.props,c.state,c.context),c.state=c.__s;while(c.__d&&++N<25);c.state=c.__s,c.getChildContext!=null&&(i=V(V({},i),c.getChildContext())),p||c.getSnapshotBeforeUpdate==null||(m=c.getSnapshotBeforeUpdate(f,d)),v=h!=null&&h.type===w&&h.key==null?h.props.children:h,nn(e,Array.isArray(v)?v:[v],t,n,i,o,s,a,l,u),c.base=t.__e,t.__h=null,c.__h.length&&a.push(c),k&&(c.__E=c.__=null),c.__e=!1}else s==null&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=mr(n.__e,t,n,i,o,s,a,u);(h=g.diffed)&&h(t)}catch(j){t.__v=null,(u||s!=null)&&(t.__e=l,t.__h=!!u,s[s.indexOf(l)]=null),g.__e(j,t,n)}}function an(e,t){g.__c&&g.__c(t,e),e.some(function(n){try{e=n.__h,n.__h=[],e.some(function(i){i.call(n)})}catch(i){g.__e(i,n.__v)}})}function mr(e,t,n,i,o,s,a,l){var u,h,c,p=n.props,f=t.props,d=t.type,m=0;if(d==="svg"&&(o=!0),s!=null){for(;m<s.length;m++)if((u=s[m])&&"setAttribute"in u==!!d&&(d?u.localName===d:u.nodeType===3)){e=u,s[m]=null;break}}if(e==null){if(d===null)return document.createTextNode(f);e=o?document.createElementNS("http://www.w3.org/2000/svg",d):document.createElement(d,f.is&&f),s=null,l=!1}if(d===null)p===f||l&&e.data===f||(e.data=f);else{if(s=s&&le.call(e.childNodes),h=(p=n.props||_e).dangerouslySetInnerHTML,c=f.dangerouslySetInnerHTML,!l){if(s!=null)for(p={},m=0;m<e.attributes.length;m++)p[e.attributes[m].name]=e.attributes[m].value;(c||h)&&(c&&(h&&c.__html==h.__html||c.__html===e.innerHTML)||(e.innerHTML=c&&c.__html||""))}if(pr(e,f,p,o,l),c)t.__k=[];else if(m=t.props.children,nn(e,Array.isArray(m)?m:[m],t,n,i,o&&d!=="foreignObject",s,a,s?s[0]:n.__k&&oe(n,0),l),s!=null)for(m=s.length;m--;)s[m]!=null&&en(s[m]);l||("value"in f&&(m=f.value)!==void 0&&(m!==e.value||d==="progress"&&!m||d==="option"&&m!==p.value)&&ve(e,"value",m,p.value,!1),"checked"in f&&(m=f.checked)!==void 0&&m!==e.checked&&ve(e,"checked",m,p.checked,!1))}return e}function ln(e,t,n){try{typeof e=="function"?e(t):e.current=t}catch(i){g.__e(i,n)}}function cn(e,t,n){var i,o;if(g.unmount&&g.unmount(e),(i=e.ref)&&(i.current&&i.current!==e.__e||ln(i,null,t)),(i=e.__c)!=null){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(s){g.__e(s,t)}i.base=i.__P=null,e.__c=void 0}if(i=e.__k)for(o=0;o<i.length;o++)i[o]&&cn(i[o],t,n||typeof e.type!="function");n||e.__e==null||en(e.__e),e.__=e.__e=e.__d=void 0}function _r(e,t,n){return this.constructor(e,n)}function dn(e,t,n){var i,o,s;g.__&&g.__(e,t),o=(i=typeof n=="function")?null:n&&n.__k||t.__k,s=[],ze(t,e=(!i&&n||t).__k=ge(w,null,[e]),o||_e,_e,t.ownerSVGElement!==void 0,!i&&n?[n]:o?null:t.firstChild?le.call(t.childNodes):null,s,!i&&n?n:o?o.__e:t.firstChild,i),an(s,e)}function gr(e,t,n){var i,o,s,a=V({},e.props);for(s in t)s=="key"?i=t[s]:s=="ref"?o=t[s]:a[s]=t[s];return arguments.length>2&&(a.children=arguments.length>3?le.call(arguments,2):n),ie(e.type,a,i||e.key,o||e.ref,null)}function W(e,t){var n={__c:t="__cC"+Zt++,__:e,Consumer:function(i,o){return i.children(o)},Provider:function(i){var o,s;return this.getChildContext||(o=[],(s={})[t]=this,this.getChildContext=function(){return s},this.shouldComponentUpdate=function(a){this.props.value!==a.value&&o.some(function(l){l.__e=!0,Re(l)})},this.sub=function(a){o.push(a);var l=a.componentWillUnmount;a.componentWillUnmount=function(){o.splice(o.indexOf(a),1),l&&l.call(a)}}),i.children}};return n.Provider.__=n.Consumer.contextType=n}le=Xt.slice,g={__e:function(e,t,n,i){for(var o,s,a;t=t.__;)if((o=t.__c)&&!o.__)try{if((s=o.constructor)&&s.getDerivedStateFromError!=null&&(o.setState(s.getDerivedStateFromError(e)),a=o.__d),o.componentDidCatch!=null&&(o.componentDidCatch(e,i||{}),a=o.__d),a)return o.__E=o}catch(l){e=l}throw e}},Kt=0,Y.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=V({},this.state),typeof e=="function"&&(e=e(V({},n),this.props)),e&&V(n,e),e!=null&&this.__v&&(t&&this._sb.push(t),Re(this))},Y.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),Re(this))},Y.prototype.render=w,q=[],qt=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Le=function(e,t){return e.__v.__b-t.__v.__b},ye.__r=0,Zt=0;var ee,P,Ee,ct,ae=0,un=[],fe=[],dt=g.__b,ut=g.__r,ht=g.diffed,ft=g.__c,pt=g.unmount;function ce(e,t){g.__h&&g.__h(P,e,ae||t),ae=0;var n=P.__H||(P.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({__V:fe}),n.__[e]}function T(e){return ae=1,yr(fn,e)}function yr(e,t,n){var i=ce(ee++,2);if(i.t=e,!i.__c&&(i.__=[n?n(t):fn(void 0,t),function(l){var u=i.__N?i.__N[0]:i.__[0],h=i.t(u,l);u!==h&&(i.__N=[h,i.__[1]],i.__c.setState({}))}],i.__c=P,!P.u)){var o=function(l,u,h){if(!i.__c.__H)return!0;var c=i.__c.__H.__.filter(function(f){return f.__c});if(c.every(function(f){return!f.__N}))return!s||s.call(this,l,u,h);var p=!1;return c.forEach(function(f){if(f.__N){var d=f.__[0];f.__=f.__N,f.__N=void 0,d!==f.__[0]&&(p=!0)}}),!(!p&&i.__c.props===l)&&(!s||s.call(this,l,u,h))};P.u=!0;var s=P.shouldComponentUpdate,a=P.componentWillUpdate;P.componentWillUpdate=function(l,u,h){if(this.__e){var c=s;s=void 0,o(l,u,h),s=c}a&&a.call(this,l,u,h)},P.shouldComponentUpdate=o}return i.__N||i.__}function A(e,t){var n=ce(ee++,3);!g.__s&&We(n.__H,t)&&(n.__=e,n.i=t,P.__H.__h.push(n))}function hn(e,t){var n=ce(ee++,4);!g.__s&&We(n.__H,t)&&(n.__=e,n.i=t,P.__h.push(n))}function H(e){return ae=5,He(function(){return{current:e}},[])}function He(e,t){var n=ce(ee++,7);return We(n.__H,t)?(n.__V=e(),n.i=t,n.__h=e,n.__V):n.__}function U(e,t){return ae=8,He(function(){return e},t)}function F(e){var t=P.context[e.__c],n=ce(ee++,9);return n.c=e,t?(n.__==null&&(n.__=!0,t.sub(P)),t.props.value):e.__}function vr(){for(var e;e=un.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(pe),e.__H.__h.forEach(Me),e.__H.__h=[]}catch(t){e.__H.__h=[],g.__e(t,e.__v)}}g.__b=function(e){P=null,dt&&dt(e)},g.__r=function(e){ut&&ut(e),ee=0;var t=(P=e.__c).__H;t&&(Ee===P?(t.__h=[],P.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.__V=fe,n.__N=n.i=void 0})):(t.__h.forEach(pe),t.__h.forEach(Me),t.__h=[])),Ee=P},g.diffed=function(e){ht&&ht(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(un.push(t)!==1&&ct===g.requestAnimationFrame||((ct=g.requestAnimationFrame)||br)(vr)),t.__H.__.forEach(function(n){n.i&&(n.__H=n.i),n.__V!==fe&&(n.__=n.__V),n.i=void 0,n.__V=fe})),Ee=P=null},g.__c=function(e,t){t.some(function(n){try{n.__h.forEach(pe),n.__h=n.__h.filter(function(i){return!i.__||Me(i)})}catch(i){t.some(function(o){o.__h&&(o.__h=[])}),t=[],g.__e(i,n.__v)}}),ft&&ft(e,t)},g.unmount=function(e){pt&&pt(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(i){try{pe(i)}catch(o){t=o}}),n.__H=void 0,t&&g.__e(t,n.__v))};var mt=typeof requestAnimationFrame=="function";function br(e){var t,n=function(){clearTimeout(i),mt&&cancelAnimationFrame(t),setTimeout(e)},i=setTimeout(n,100);mt&&(t=requestAnimationFrame(n))}function pe(e){var t=P,n=e.__c;typeof n=="function"&&(e.__c=void 0,n()),P=t}function Me(e){var t=P;e.__c=e.__(),P=t}function We(e,t){return!e||e.length!==t.length||t.some(function(n,i){return n!==e[i]})}function fn(e,t){return typeof t=="function"?t(e):t}function xr(e,t){for(var n in t)e[n]=t[n];return e}function _t(e,t){for(var n in e)if(n!=="__source"&&!(n in t))return!0;for(var i in t)if(i!=="__source"&&e[i]!==t[i])return!0;return!1}function gt(e){this.props=e}(gt.prototype=new Y).isPureReactComponent=!0,gt.prototype.shouldComponentUpdate=function(e,t){return _t(this.props,e)||_t(this.state,t)};var yt=g.__b;g.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),yt&&yt(e)};var vt=function(e,t){return e==null?null:Q(Q(e).map(t))},wr={map:vt,forEach:vt,count:function(e){return e?Q(e).length:0},only:function(e){var t=Q(e);if(t.length!==1)throw"Children.only";return t[0]},toArray:Q},kr=g.__e;g.__e=function(e,t,n,i){if(e.then){for(var o,s=t;s=s.__;)if((o=s.__c)&&o.__c)return t.__e==null&&(t.__e=n.__e,t.__k=n.__k),o.__c(e,t)}kr(e,t,n,i)};var bt=g.unmount;function pn(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach(function(i){typeof i.__c=="function"&&i.__c()}),e.__c.__H=null),(e=xr({},e)).__c!=null&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map(function(i){return pn(i,t,n)})),e}function mn(e,t,n){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map(function(i){return mn(i,t,n)}),e.__c&&e.__c.__P===t&&(e.__e&&n.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=n)),e}function Te(){this.__u=0,this.t=null,this.__b=null}function _n(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function de(){this.u=null,this.o=null}g.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&e.__h===!0&&(e.type=null),bt&&bt(e)},(Te.prototype=new Y).__c=function(e,t){var n=t.__c,i=this;i.t==null&&(i.t=[]),i.t.push(n);var o=_n(i.__v),s=!1,a=function(){s||(s=!0,n.__R=null,o?o(l):l())};n.__R=a;var l=function(){if(!--i.__u){if(i.state.__a){var h=i.state.__a;i.__v.__k[0]=mn(h,h.__c.__P,h.__c.__O)}var c;for(i.setState({__a:i.__b=null});c=i.t.pop();)c.forceUpdate()}},u=t.__h===!0;i.__u++||u||i.setState({__a:i.__b=i.__v.__k[0]}),e.then(a,a)},Te.prototype.componentWillUnmount=function(){this.t=[]},Te.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),i=this.__v.__k[0].__c;this.__v.__k[0]=pn(this.__b,n,i.__O=i.__P)}this.__b=null}var o=t.__a&&ge(w,null,e.fallback);return o&&(o.__h=null),[ge(w,null,t.__a?null:e.children),o]};var xt=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&(e.props.revealOrder[0]!=="t"||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};(de.prototype=new Y).__a=function(e){var t=this,n=_n(t.__v),i=t.o.get(e);return i[0]++,function(o){var s=function(){t.props.revealOrder?(i.push(o),xt(t,e,i)):o()};n?n(s):s()}},de.prototype.render=function(e){this.u=null,this.o=new Map;var t=Q(e.children);e.revealOrder&&e.revealOrder[0]==="b"&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},de.prototype.componentDidUpdate=de.prototype.componentDidMount=function(){var e=this;this.o.forEach(function(t,n){xt(e,n,t)})};var gn=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,Nr=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,Sr=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,Er=/[A-Z0-9]/g,Tr=typeof document<"u",Ir=function(e){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(e)};function Cr(e,t,n){return t.__k==null&&(t.textContent=""),dn(e,t),typeof n=="function"&&n(),e?e.__c:null}Y.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(e){Object.defineProperty(Y.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})});var wt=g.event;function Pr(){}function Ar(){return this.cancelBubble}function Dr(){return this.defaultPrevented}g.event=function(e){return wt&&(e=wt(e)),e.persist=Pr,e.isPropagationStopped=Ar,e.isDefaultPrevented=Dr,e.nativeEvent=e};var kt={configurable:!0,get:function(){return this.class}},Nt=g.vnode;g.vnode=function(e){var t=e.type,n=e.props,i=n;if(typeof t=="string"){for(var o in i={},n){var s=n[o];if(!(o==="value"&&"defaultValue"in n&&s==null||Tr&&o==="children"&&t==="noscript")){var a=o.toLowerCase();o==="defaultValue"&&"value"in n&&n.value==null?o="value":o==="download"&&s===!0?s="":a==="ondoubleclick"?o="ondblclick":a!=="onchange"||t!=="input"&&t!=="textarea"||Ir(n.type)?a==="onfocus"?o="onfocusin":a==="onblur"?o="onfocusout":Sr.test(o)?o=a:t.indexOf("-")===-1&&Nr.test(o)?o=o.replace(Er,"-$&").toLowerCase():s===null&&(s=void 0):a=o="oninput",a==="oninput"&&i[o=a]&&(o="oninputCapture"),i[o]=s}}t=="select"&&i.multiple&&Array.isArray(i.value)&&(i.value=Q(n.children).forEach(function(l){l.props.selected=i.value.indexOf(l.props.value)!=-1})),t=="select"&&i.defaultValue!=null&&(i.value=Q(n.children).forEach(function(l){l.props.selected=i.multiple?i.defaultValue.indexOf(l.props.value)!=-1:i.defaultValue==l.props.value})),e.props=i,n.class!=n.className&&(kt.enumerable="className"in n,n.className!=null&&(i.class=n.className),Object.defineProperty(i,"className",kt))}e.$$typeof=gn,Nt&&Nt(e)};var St=g.__r;g.__r=function(e){St&&St(e),e.__c};var Et=g.diffed;g.diffed=function(e){Et&&Et(e);var t=e.props,n=e.__e;n!=null&&e.type==="textarea"&&"value"in t&&t.value!==n.value&&(n.value=t.value==null?"":t.value)};function yn(e){return!!e&&e.$$typeof===gn}function Lr(e){return yn(e)?gr.apply(null,arguments):e}function Rr(e){return!!e.__k&&(dn(null,e),!0)}var Mr=0;function r(e,t,n,i,o,s){var a,l,u={};for(l in t)l=="ref"?a=t[l]:u[l]=t[l];var h={type:e,props:u,key:n,ref:a,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--Mr,__source:o,__self:s};if(typeof e=="function"&&(a=e.defaultProps))for(l in a)u[l]===void 0&&(u[l]=a[l]);return g.vnode&&g.vnode(h),h}function Or(e){return{render(t){Cr(t,e)},unmount(){Rr(e)}}}let vn="America/New_York";function $r(e){vn=e}function D(e){e=new Date(e||Date.now());const t={},n="2-digit";return Intl.DateTimeFormat("en-US",{timeZone:vn,hourCycle:"h23",year:"numeric",month:n,day:n,hour:n,minute:n,second:n}).formatToParts(e).forEach(i=>t[i.type]=i.value),{date:`${t.year}-${t.month}-${t.day}`,time:`${t.hour}:${t.minute}:${t.second}`}}function Gr(e){const t=new Date(e+"T00:00:00"),n=t.toLocaleString("en-US",{month:"long",day:"numeric"}),i=D().date;if(e===i)return`Today, ${n}`;const o=new Date(i);o.setDate(o.getDate()+1);const s=o.toISOString().split("T")[0];return e===s?`Tomorrow, ${n}`:`${t.toLocaleString("en-US",{weekday:"long"})}, ${n}`}function J(e){const t=e.split(":").slice(0,2).map(Number),n=t[0]>=12?"PM":"AM";return t[0]=t[0]%12||12,t.map(i=>String(i).padStart(2,"0")).join(":").replace(/^0/,"")+" "+n}function Tt(e){const[t,n]=e.slice(0,19).split("T");return{date:t,time:n}}function be(e){const[t,n]=e.split(":").map(Number);return(t+17)%24*60+n}class Br extends Error{constructor(n){super(`Auth data "${n}" missing or expired`);C(this,"name","ReauthNeeded")}}class Ur{constructor(t,n=localStorage){this.storageKey=t,this.storage=n}getData(){try{const t=this.storage.getItem(this.storageKey);if(t){const{swid:n,accessToken:i,expires:o}=JSON.parse(t),s=D(new Date(o)),a=D();if(s.date>a.date||s.date===a.date&&s.time>a.time&&s.time>="17")return{swid:n,accessToken:i}}}catch(t){console.error(t)}throw new Br(this.storageKey)}setData(t){this.storage.setItem(this.storageKey,JSON.stringify(t))}deleteData(){this.storage.removeItem(this.storageKey)}}const zr="modulepreload",Hr=function(e){return"/bg1/"+e},It={},Ct=function(t,n,i){if(!n||n.length===0)return t();const o=document.getElementsByTagName("link");return Promise.all(n.map(s=>{if(s=Hr(s),s in It)return;It[s]=!0;const a=s.endsWith(".css"),l=a?'[rel="stylesheet"]':"";if(!!i)for(let c=o.length-1;c>=0;c--){const p=o[c];if(p.href===s&&(!a||p.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${l}`))return;const h=document.createElement("link");if(h.rel=a?"stylesheet":zr,a||(h.as="script",h.crossOrigin=""),h.href=s,document.head.appendChild(h),a)return new Promise((c,p)=>{h.addEventListener("load",c),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>t())},Wr=(e,t)=>{const n=e[t];return n?typeof n=="function"?n():Promise.resolve(n):new Promise((i,o)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(o.bind(null,new Error("Unknown variable dynamic import: "+t)))})},Fr=8e3;async function xe(e,t={}){const{params:n,data:i,timeout:o=Fr,...s}=t;t=s,t.referrer||(t.referrer=""),t.credentials||(t.credentials="omit"),t.cache||(t.cache="no-store"),t.headers={...t.headers||{}},n&&Object.keys(n).length>0&&(e+=(e.includes("?")?"&":"?")+Object.entries(n).filter(([,h])=>h!=="").map(h=>h.map(encodeURIComponent).join("=")).join("&")),i&&(t.method||(t.method="POST"),t.headers={...t.headers,"Content-Type":"application/json"},t.body=JSON.stringify(i));const a=new AbortController;t.signal=a.signal;const l=setTimeout(()=>a.abort(),o);let u;try{u=await fetch(e,t)}catch(h){return console.error(h),{status:0,data:null}}finally{clearTimeout(l)}return{status:u.status,data:(u.headers.get("Content-Type")||"").startsWith("application/json")?await u.json():{}}}const jr={48199:"Mr-Incredible",48200:"Mrs-Incredible",261227:"Nemo",339625:"Russell",339626:"Carl",364907:"Jack-Skellington",431014:"Princess-Tiana",431065:"Darth_Vader",15549505:"Rapunzel",15655408:"Default_SignedIn",15675686:"Crush",15831168:"Wall-E",16453979:"Merida",16726412:"Stormtrooper",16818199:"Violet",16869301:"Jack-Jack",17345357:"R2-D2",17345359:"C-3PO",17532220:"Bruce",17532224:"Green-Alien",17532227:"Kermit",17532228:"Sorcerer-Mickey",17577168:"Elsa",17577169:"Anna",17813977:"Olaf",17888784:"Yoda",18101167:"Captain-Mickey",18368743:"-Nick",18368747:"-Judy",18393706:"-Flash",18403761:"kion",18405224:"-Moana",18405236:"-Elena",19633995:"50th_Mickey",19633996:"50th_Minnie",90003819:"Alice",90003846:"Ariel",90003898:"Belle",90003967:"Buzz",90003976:"Captain-Hook",90004004:"Chesire-Cat",90004017:"Cinderella",90004068:"Daisy",90004076:"Dash",90004104:"Donald",90004228:"Goofy",90004260:"Hamm",90004328:"Princess-Jasmine",90004340:"Jiminy",90004395:"Lady",90004482:"Mickey-Mouse",90004486:"Minnie",90004537:"Mulan",90004605:"Peter-Pan",90004625:"Pluto",90004626:"Pocahontas",90004642:"Princess-Aurora",90004682:"Rex",90004772:"Snow-White",90004778:"Sparky",90004846:"TinkerBell",90004860:"Tramp",90004939:"Zero"},Fe="https://cdn1.parksmedia.wdprapps.disney.com/resize/mwImage/1/90/90/75/dam/",Vr=Fe+"wdpro-assets/avatars/180x180/RetAvatar_180x180_",Yr=Fe+"wdpro-assets/avatars/180x180/RetAvatar-180x180",Qr=Fe+"disney-world/50th-anniversary/avatars/RetAvatar_180x180_",Jr={"-":Yr,5:Qr};function Ie(e){const t=jr[e||""];if(t)return(Jr[t[0]]||Vr)+t+".png"}const Oe={"https://disneyworld.disney.go.com":"WDW","https://disneyland.disney.go.com":"DLR"},Kr={WDW:"wdw-itinerary-api",DLR:"dlr-itinerary-web-api"};function qr(e){return e in Oe}let Zr=class extends Error{constructor(n,i="Request failed"){super(`${i}: ${JSON.stringify(n)}`);C(this,"name","RequestError");this.response=n}};const Xr=new Set(["ACTIVITY","DINING"]),Z=e=>e.split(";")[0];function bn(e){const{date:t,time:n}=D();return e.modifiable&&t===e.end.date&&n<=(e.end.time??"")}class ei extends Error{constructor(){super(...arguments);C(this,"name","ModifyNotAllowed")}}function Pt(e){if(e&&!bn(e))throw new ei}class je{constructor(t){C(this,"maxPartySize",12);C(this,"nextBookTime");C(this,"onUnauthorized",()=>{});C(this,"origin");C(this,"authStore");C(this,"expData");C(this,"parkMap");C(this,"drops",{});C(this,"partyIds",new Set);C(this,"guestCache",new Map);C(this,"tracker");C(this,"primaryGuestId","");C(this,"convertGuest",t=>{const{id:n,firstName:i,lastName:o,characterId:s,...a}=t,l=`${i} ${o}`.trim();if(!this.guestCache.has(n))switch(t.ineligibleReason){case"INVALID_PARK_ADMISSION":case"PARK_RESERVATION_NEEDED":case"GENIE_PLUS_NEEDED":t.primary&&this.cacheGuest(n,l,s);break;default:this.cacheGuest(n,l,s)}const u=Ie(s);return this.partyIds.size>0&&!this.partyIds.has(n)&&(a.ineligibleReason="NOT_IN_PARTY",delete a.eligibleAfter),{...a,id:n,name:l,avatarImageUrl:u}});var n,i;this.origin=t.origin,this.authStore=t.authStore,this.parkMap=new Map(t.data.parks.map(o=>[o.id,o])),this.tracker=t.tracker||new ti;for(const[o,s]of Object.entries(t.data.pdts??{}))this.drops[o]=s.map(a=>({time:new Date(new Date().setHours(a/60,a%60,0)).toTimeString().slice(0,5),expIds:[]}));this.expData={...t.data.experiences};for(const[o,s]of Object.entries(t.data.experiences)){if(!(s!=null&&s.pdtMask))continue;const{id:a}=s.land.park;for(const[l,u]of((i=(n=this.drops)==null?void 0:n[a])==null?void 0:i.entries())??[])s.pdtMask&1<<l&&u.expIds.push(o)}}static async load(t){const n=Oe[t.origin].toLowerCase(),i=(await Wr(Object.assign({"./data/dlr.ts":()=>Ct(()=>import("./dlr.js"),[]),"./data/wdw.ts":()=>Ct(()=>import("./wdw.js"),[])}),`./data/${n}.ts`)).default;return new je({...t,data:i})}get resort(){return Oe[this.origin]}get parks(){return[...this.parkMap.values()]}setPartyIds(t){this.partyIds=new Set(t)}async experiences(t){var o,s;await this.primeGuestCache();const n=await this.request({path:`/tipboard-vas/api/v1/parks/${encodeURIComponent(t.id)}/experiences`,params:{eligibilityGuestIds:[...this.guestCache.keys()].join(",")}});this.nextBookTime=(s=(((o=n.eligibility)==null?void 0:o.flexEligibilityWindows)||[]).sort((a,l)=>a.time.time.localeCompare(l.time.time))[0])==null?void 0:s.time.time;const{expIds:i=[]}=this.nextDrop(t)??{};return n.availableExperiences.filter(a=>!!this.expData[a.id]).map(a=>({...a,...this.expData[a.id],park:t,experienced:this.tracker.experienced(a),drop:i.includes(a.id)}))}async guests(t){t||(t={id:"0",park:{id:"0"}});const n=await this.request({path:"/ea-vas/api/v1/guests",params:{productType:"FLEX",experienceId:t.id,parkId:t.park.id}});this.primaryGuestId=n.primaryGuestId;const i=n.ineligibleGuests.map(this.convertGuest),o=n.guests.map(this.convertGuest).filter(s=>!("ineligibleReason"in s)||i.push(s)&&!1);return i.sort((s,a)=>{const l=+!s.primary-+!a.primary||s.name.localeCompare(a.name);return s.eligibleAfter||a.eligibleAfter?(s.eligibleAfter||"99").localeCompare(a.eligibleAfter||"99")||l:s.ineligibleReason===a.ineligibleReason?l:s.ineligibleReason==="NOT_IN_PARTY"?1:a.ineligibleReason==="NOT_IN_PARTY"||s.ineligibleReason==="EXPERIENCE_LIMIT_REACHED"?-1:a.ineligibleReason==="EXPERIENCE_LIMIT_REACHED"?1:l}),{eligible:o,ineligible:i}}async offer(t,n,i){Pt(i);const o=await this.request({path:i?"/ea-vas/api/v1/products/modifications/flex/offers":"/ea-vas/api/v2/products/flex/offers",method:"POST",data:{guestIds:((i==null?void 0:i.guests)??n).map(p=>p.id),ineligibleGuests:[],primaryGuestId:n.map(p=>p.id).sort((p,f)=>p.localeCompare(f))[0],parkId:t.park.id,experienceId:t.id,selectedTime:t.flex.nextAvailableTime,...i?{modificationType:t.id===i.id?"TIME":"EXPERIENCE"}:{}},userId:!1}),{id:s,date:a,startTime:l,endTime:u,status:h,changeStatus:c}=o.offer;return{id:s,start:{date:a,time:l},end:{date:a,time:u},active:h==="ACTIVE",changed:c!=="NONE",guests:{eligible:(o.eligibleGuests||[]).map(this.convertGuest),ineligible:(o.ineligibleGuests||[]).map(this.convertGuest)},experience:t}}async cancelOffer(t){await this.request({path:`/ea-vas/api/v1/offers/${encodeURIComponent(t.id)}`,method:"DELETE",params:{productType:"FLEX"},userId:!1})}async book(t,n,i){var c;Pt(n);const o=new Set((i??t.guests.eligible).map(p=>p.id)),{singleExperienceDetails:{experienceId:s,parkId:a},entitlements:l,startDateTime:u,endDateTime:h}=await this.request({path:n?"/ea-vas/api/v1/products/modifications/flex/bookings":"/ea-vas/api/v1/products/flex/bookings",method:"POST",userId:!1,data:{offerId:t.id,...n?{modificationType:n.id===t.experience.id?"TIME":"EXPERIENCE",existingEntitlements:n.guests.filter(p=>o.has(p.id)).map(p=>({entitlementId:p.entitlementId,entitlementBookingId:p.bookingId})),guestIdsToExclude:n.guests.filter(p=>!o.has(p.id)).map(p=>p.id)}:{}},key:"booking"});return{type:"LL",subtype:"G+",...this.getExperience(s,a),bookingId:(c=l[0])==null?void 0:c.id,start:Tt(u),end:Tt(h),cancellable:!0,modifiable:!0,guests:l.map(p=>{const f=this.guestCache.get(p.guestId);return{id:p.guestId,name:(f==null?void 0:f.name)||"",avatarImageUrl:Ie(f==null?void 0:f.characterId),entitlementId:p.id}})}}async cancelBooking(t){const i=t.map(o=>o.entitlementId).map(encodeURIComponent).join(",");await this.request({path:`/ea-vas/api/v1/entitlements/${i}`,method:"DELETE",userId:!1})}async bookings(){const{swid:t}=this.authStore.getData(),n=D().date,i=Kr[this.resort],{items:o=[],assets:s={},profiles:a={}}=await this.request({path:`/plan/${i}/api/v1/itinerary-items/${t}?item-types=FASTPASS&item-types=DINING&item-types=ACTIVITY&item-types=VIRTUAL_QUEUE_POSITION`,params:{destination:this.resort,fields:"items,profiles,assets","guest-locators":t+";type=swid","guest-locator-groups":"MY_FAMILY","start-date":n,"show-friends":"false"},userId:!1}),l=d=>{const{name:m,avatarId:k,type:y}=a[d.id];return{id:Z(d.id),name:`${m.firstName} ${m.lastName}`.trim(),avatarImageUrl:Ie(k),...y==="transactional"&&{transactional:!0}}},u=d=>{const m=s[d.asset],y=s[m.facility].location;if(!y)return;const S=this.parkMap.get(Z(y))||{id:y,name:s[y].name},b=new Date(d.startDateTime);return{type:"RES",subtype:d.type,id:Z(d.asset),park:S,name:m.name,start:D(b),guests:d.guests.map(l).sort((x,N)=>+(N.id===this.primaryGuestId)-+(x.id===this.primaryGuestId)||+!N.transactional-+!x.transactional||x.name.localeCompare(N.name)),bookingId:d.id}},h=d=>{var _;const m={FLEX:"G+",STANDARD:"ILL",DAS:"DAS",FDS:"DAS",OTHER:"OTHER"},k=d.multipleExperiences?"MEP":m[d.kind];if(!k)return;const y=k==="G+",S=s[d.facility];let b={type:"LL",subtype:k,...this.getExperience(d.facility,S.location,S.name),start:{date:d.displayStartDate??n,time:d.displayStartTime},end:{date:d.displayEndDate,time:d.displayEndTime},cancellable:d.cancellable&&y,modifiable:d.modifiable&&y,guests:d.guests.map(x=>({...l(x),entitlementId:x.entitlementId,bookingId:x.bookingId,...x.redemptionsRemaining!==void 0&&{redemptions:x.redemptionsRemaining}})),bookingId:(_=d.guests[0])==null?void 0:_.entitlementId};if(b.modifiable=bn(b),d.multipleExperiences){const x=d.assets.find(N=>N.original);x&&(b={...b,...this.getExperience(x.content,s[x.content].location)}),b.choices=d.assets.filter(N=>!N.excluded&&!N.original).map(({content:N})=>{const{name:I,location:v}=s[N];return this.getExperience(N,v,I)}).sort((N,I)=>N.name.localeCompare(I.name))}return b},c=d=>{const m=s[d.asset],k=s[m.facility];return{type:"BG",...this.getExperience(m.facility,k.location,m.name),boardingGroup:d.boardingGroup.id,status:d.status,start:D(new Date(d.startDateTime)),guests:d.guests.map(l),bookingId:d.id}},p=d=>{const m=this.parkMap.get(Z(s[d.facility].location));if(m)return{type:"APR",id:m.id,name:m.name,park:m,start:D(new Date(d.startDateTime)),guests:d.guests.map(l),bookingId:d.id}},f=o.map(d=>{try{if(d.type==="FASTPASS")return d.kind==="PARK_PASS"?p(d):h(d);if(d.type==="VIRTUAL_QUEUE_POSITION")return c(d);if(d.type&&Xr.has(d.type))return u(d)}catch(m){console.error(m)}}).filter(d=>!!d);return this.tracker.update(f,this),f}upcomingDrops(t){var i;const n=D().time.slice(0,5);return(((i=this.drops)==null?void 0:i[t.id])??[]).filter(({time:o})=>o>=n).map(({time:o,expIds:s})=>({time:o,experiences:s.map(a=>{var l;return{id:a,name:(l=this.expData[a])==null?void 0:l.name}}).filter(a=>a.name!==void 0).sort((a,l)=>a.name.localeCompare(l.name))}))}nextDropTime(t){var n;return(n=this.nextDrop(t))==null?void 0:n.time}logOut(){this.authStore.deleteData(),this.onUnauthorized()}nextDrop(t){var i,o;const n=D().time.slice(0,5);return(o=(i=this.drops)==null?void 0:i[t.id])==null?void 0:o.find(({time:s})=>s>=n)}getExperience(t,n,i){var o;return t=Z(t),{id:t,name:((o=this.expData[t])==null?void 0:o.name)||i,park:this.parkMap.get(Z(n))}}async primeGuestCache(){this.primaryGuestId===""&&(this.primaryGuestId=".",await this.guests())}cacheGuest(t,n,i){this.guestCache.set(t,{name:n,characterId:i})}async request(t){const{swid:n,accessToken:i}=this.authStore.getData(),o=this.origin+t.path,s={...t.params};(t.userId??!0)&&(s.userId=n);const{status:a,data:l}=await xe(o,{method:t.method||"GET",params:s,data:t.data,headers:{Authorization:`BEARER ${i}`,"x-user-id":n}});if(a===401)setTimeout(()=>this.logOut());else{const{key:u}=t;if(String(a)[0]==="2"&&(!u||l[u]))return u?l[u]:l}throw new Zr({status:a,data:l})}}const At="bg1.genie.bookings";class ti{constructor(){C(this,"date");C(this,"expIds",new Set);C(this,"experiencedExpIds",new Set);const{date:t=D().date,expIds:n=[],experiencedExpIds:i=[]}=JSON.parse(localStorage.getItem(At)||"{}");this.date=t,this.expIds=new Set(n),this.experiencedExpIds=new Set(i),this.checkDate()}experienced(t){return this.experiencedExpIds.has(t.id)}async update(t,n){this.checkDate();const i=t.filter(s=>s.type==="LL"&&!!s.cancellable);for(const s of i)this.experiencedExpIds[s.modifiable?"delete":"add"](s.id);const o=this.expIds;this.expIds=new Set(i.map(s=>s.id));for(const s of o){if(this.expIds.has(s))continue;const{ineligible:a}=await n.guests({id:s,park:{id:"0"}}),l=a.some(u=>u.ineligibleReason==="EXPERIENCE_LIMIT_REACHED");this.experiencedExpIds[l?"add":"delete"](s)}localStorage.setItem(At,JSON.stringify({date:this.date,expIds:[...this.expIds],experiencedExpIds:[...this.experiencedExpIds]}))}checkDate(){const t=D().date;this.date!==t&&(this.date=t,this.expIds=new Set,this.experiencedExpIds=new Set)}}const xn={"https://vqguest-svc-wdw.wdprapps.disney.com":"WDW","https://vqguest-svc.wdprapps.disney.com":"DLR"};function ni(e){return e in xn}const ri=e=>e.sort((t,n)=>+n.primary-+t.primary||+n.preselected-+t.preselected||t.name.localeCompare(n.name));class ue extends Error{constructor(n,i="Request failed"){super(`${i}: ${JSON.stringify(n)}`);C(this,"name","RequestError");this.response=n}}class ii{constructor(t){C(this,"onUnauthorized",()=>{});C(this,"origin");C(this,"authStore");this.origin=t.origin,this.authStore=t.authStore}get resort(){return xn[this.origin]}url(t){return`${this.origin}/application/v1/guest/${t}`}async getQueues(){var n;const t=await xe(this.url("getQueues"));if(!Array.isArray((n=t.data)==null?void 0:n.queues))throw new ue(t);return t.data.queues.filter(i=>!!i.categoryContentId).map(({queueId:i,...o})=>({...o,id:i}))}async getQueue(t){const n=(await this.getQueues()).find(i=>i.id===t.id);if(n)return n;throw new Error("Queue not Found")}async getLinkedGuests(t){const{data:n}=await this.post({resource:"getLinkedGuests",data:{queueId:t.id}});return ri(n.guests.map(({guestId:i,firstName:o,lastName:s,isPrimaryGuest:a,isPreselected:l,...u})=>({...u,id:i,name:`${o} ${s}`.trim(),primary:!!a,preselected:!!l})))}async joinQueue(t,n){const i=n.map(a=>a.id),{status:o,data:s}=await this.post({resource:"joinQueue",data:{queueId:t.id,guestIds:i}});if(s.responseStatus==="OK"){const a=s.positions.find(l=>l.queueId===t.id&&l.guestIds.length>0&&i.some(u=>l.guestIds.includes(u)));if(!a)throw new ue({status:o,data:s});return{boardingGroup:a.boardingGroup,conflicts:{},closed:!1}}else if(s.responseStatus==="INVALID_GUEST"||s.responseStatus==="CLOSED_QUEUE"){const a=s.responseStatus==="CLOSED_QUEUE",l=new Set,u={};for(const p of s.conflicts)for(const f of p.guestIds){const d=n.find(m=>m.id===f);d&&(u[d.id]=p.conflictType,l.add(f))}const h=n.filter(p=>!l.has(p.id));if(a||h.length===0)return{boardingGroup:null,conflicts:u,closed:a};const c=await this.joinQueue(t,h);return c.conflicts={...u,...c.conflicts},c}else throw new ue({status:o,data:s})}logOut(){this.authStore.deleteData(),this.onUnauthorized()}async post(t){const{status:n,data:i}=await xe(this.url(t.resource),{method:"POST",headers:{Authorization:`BEARER ${this.authStore.getData().accessToken}`},data:t.data});if(n===401&&setTimeout(()=>this.logOut()),!n||n===401||n>=500)throw new ue({status:n,data:i});return{status:n,data:i}}}const wn=W({resort:"WDW",onUnauthorized:()=>{},logOut:()=>null}),si=wn.Provider,Ve=()=>F(wn),kn=W({goTo:()=>{},goBack:()=>{}}),oi=kn.Provider,M=()=>F(kn),Nn=W({current:r("div",{})}),ai=Nn.Provider,Sn=()=>F(Nn);let li=0;const Dt=()=>++li,he=()=>Number(location.hash.slice(1))||0;function En({children:e}){const[t,n]=T({current:e}),i=H([{elem:e,key:0}]),o=H({goTo(a,l){let u=he(),h;l!=null&&l.replace?(h=i.current[u].key??Dt(),n({...t,current:a})):(i.current=i.current.slice(0,++u),location.hash=`#${u}`,h=Dt()),i.current[u]={elem:a,key:h}},goBack({screen:a,props:l}={}){if(a){const u=he();for(let h=u-1;h>=0;--h)if(i.current[h].elem.type===a){if(history.go(h-u),l){const c={...i.current[h].elem.props,...l};i.current[h].elem=r(a,{...c})}return}}else history.back()}});A(()=>{function a(){var h,c;const u=he();u>=i.current.length?history.back():n({current:((h=i.current[u])==null?void 0:h.elem)??r("div",{}),prev:(c=i.current[u-1])==null?void 0:c.elem})}function l(u){u.preventDefault()}return location.replace("#0"),addEventListener("hashchange",a),addEventListener("beforeunload",l),()=>{removeEventListener("hashchange",a),removeEventListener("beforeunload",l)}},[]);const s=Math.min(he(),i.current.length-1);return r(oi,{value:o.current,children:r(ai,{value:t,children:i.current.slice(0,s+1).map(({elem:a,key:l},u)=>r("article",{hidden:u!==s,children:a},l))})})}const Ye={bg:"bg-blue-500",text:"text-blue-500"},Tn=W(Ye),In=Tn.Provider,G=()=>F(Tn),ci={normal:"py-1",small:"py-1.5 text-xs uppercase tracking-wide",full:"w-full py-3"};function R(e){const{goBack:t}=M(),{type:n,back:i,onClick:o,className:s,...a}=e;let l=`${ci[n||"normal"]} ${s||""}`;const{bg:u}=G();return l.includes(" bg-")||(l+=` ${u} text-white`),r("button",{onClick:async()=>{o&&await o(),i&&(i===!0?t():t(i))},className:`${l} inline-flex items-center justify-center min-w-[36px] rounded-lg px-2 font-semibold disabled:opacity-50`,...a})}function z(e){return r("div",{className:"mb-20",children:r("div",{className:"fixed bottom-0 left-0 w-full px-5 pb-5 text-center",children:r(R,{...e,className:"max-w-2xl mx-auto shadow-[0px_4px_8px_-1px_#0005]",type:"full"})})})}function O({children:e,className:t,title:n}){return t||(t=""),t.match(/\bw-\S+\s*/)||(t+=" w-4"),t.match(/\bh-\S+\s*/)||(t+=" h-auto"),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 16 16",className:`mx-auto ${t}`,role:"img",children:[n&&r("title",{children:n}),e]})}/**
 * Modified arrow-left2 icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function di(e){return r(O,{...e,children:r("path",{d:"M0.293,7.337L7.333,0.297C7.723,-0.093 8.357,-0.093 8.747,0.297C9.137,0.687 9.137,1.321 8.747,1.711L3.414,7.044L15,7.044C15.552,7.044 16,7.492 16,8.044C16,8.596 15.552,9.044 15,9.044L3.414,9.044L8.747,14.377C9.137,14.767 9.137,15.401 8.747,15.791C8.357,16.181 7.723,16.181 7.333,15.791L0.293,8.751C0.102,8.561 0,8.307 0,8.044C0,7.781 0.102,7.527 0.293,7.337Z"})})}function ui({title:e,children:t}){const{prev:n}=Sn(),{bg:i,text:o}=G();function s(a){return!yn(a)||typeof a.type=="string"?a:a.type===w?wr.map(a.props.children,s):Lr(a,{className:`bg-white bg-opacity-90 ${o} ${a.props.className||""}`})}return r("div",{className:`flex justify-end gap-x-2 gap-y-1 min-h-[52px] px-3 py-2 text-lg text-white ${i}`,children:[!!n&&r(R,{back:!0,className:"-my-2 -ml-3",title:"Go Back",children:r(di,{})}),r("h1",{className:"flex-1 self-center py-0.5 text-xl font-semibold overflow-hidden whitespace-nowrap",children:e}),s(t)]})}function L({heading:e,buttons:t,footer:n,theme:i,children:o,contentRef:s}){const a=G();return i??(i=a),r(In,{value:i,children:r("div",{className:"fixed inset-0 flex flex-col",children:[r(ui,{title:e,children:t}),r("div",{ref:s,className:"relative flex-1 overflow-auto px-3 pb-3",children:o}),n&&r("div",{className:`relative ${i.bg} text-white font-semibold`,children:n})]})})}const Lt="bg1.disclaimer.accepted",hi={bg:"bg-red-600",text:"text-red-600"};function fi(){const[e,t]=T(!!localStorage.getItem(Lt));return e?null:r(pi,{onAccept:()=>{localStorage.setItem(Lt,"1"),t(!0)}})}function pi({onAccept:e}){return r(L,{heading:"Warning!",theme:hi,children:[r("p",{children:'Use at your own risk. BG1 is highly experimental, for demonstration purposes only, and provided "as is" without warranty of any kind. It is in no way endorsed by or associated with the Walt Disney Company and could stop working at any time for any reason. To ensure the intended experience, always use the official Disney app.'}),r(z,{onClick:e,children:"Accept"})]})}function Cn(){return r(L,{heading:"BG1 News",children:r("iframe",{src:"https://joelface.github.io/bg1/news.html",className:"absolute inset-0 w-full h-full"})})}const Rt="bg1.news.version";function mi(e){const[t,n]=T(()=>{const i=Number(localStorage.getItem(Rt));return Number.isInteger(i)?i:0});return t<e?r(w,{children:[r(Cn,{}),r(z,{onClick:()=>{localStorage.setItem(Rt,String(e)),n(e)},children:"Close"})]}):null}function Qe(e){const t=()=>{document.hidden||e()};return document.addEventListener("visibilitychange",t),()=>{document.removeEventListener("visibilitychange",t)}}const _i="181874e5af6";function gi(e){return"deferredUuid"in e&&e.deferredUuid!==void 0}class yi{constructor(t,n,i,o=!1){C(this,"handlers",{});C(this,"handshakeAcked",!1);C(this,"onMessage",t=>{if(t.source!==this.iframe.contentWindow||t.data==="inner.loaded")return;const n=JSON.parse(t.data);this.logging&&console.log("Message:",n);const i=n.type==="message"?n.eventName:n.type,o=this.handlers[i],s=o?o("data"in n?n.data:null):void 0;gi(n)&&this.send({type:"deferred",action:"resolve",deferredUuid:n.deferredUuid,data:s??{}})});this.iframe=t,this.resort=i,this.logging=o,this.on("handshake",()=>{this.handshakeAcked||(this.handshakeAcked=!0,this.send({type:"handshakeAck"}),this.logging&&this.sendMessage("setLogLevel",{level:"log"}),this.sendMessage("workflow.execute",{name:"login"}))}),this.on("lightbox.hide",()=>this.open()),this.on("session.dateOfBirth.read",()=>this.open()),this.on("session.loggedin",({token:s})=>{n({swid:s.swid,accessToken:s.access_token,expires:new Date(s.exp)})})}open(){addEventListener("message",this.onMessage),this.iframe.src=this.authPageUrl,this.handshakeAcked=!1}close(){removeEventListener("message",this.onMessage)}on(t,n){this.handlers[t]=n}sendMessage(t,n){this.send({type:"message",eventName:t,data:n})}send(t){var n;(n=this.iframe.contentWindow)==null||n.postMessage(JSON.stringify({...t,name:"lightbox-client-window"}),this.authPageUrl)}get authPageUrl(){return`https://cdn.registerdisney.go.com/v2/TPR-${this.resort}-LBSDK.IOS-PROD/en-US?include=l10n,config,html,js&buildId=${_i}`}}function vi({resort:e,onLogin:t}){const n=H(null);return A(()=>{if(!n.current)return;const i=new yi(n.current,t,e);return i.open(),()=>i.close()},[e,t,n]),r("iframe",{title:"Disney Login Form",ref:n,className:"fixed top-0 left-0 w-full h-full border-0"})}const bi=1;function xi({client:e,authStore:t,children:n}){const[i,o]=T("blank"),s=fi(),a=mi(bi);if(A(()=>{e.onUnauthorized=()=>o("login")},[e]),A(()=>{function u(){if(i!=="login")try{t.getData(),o("client")}catch{return o("login")}}return u(),Qe(u)},[t,i]),s)return s;if(a)return a;const l={blank:r("div",{}),login:r(vi,{resort:e.resort,onLogin:u=>{t.setData(u),o("client")}}),client:n};return r(si,{value:e,children:l[i]})}const $=Ve,wi="bg1.genie.park",Pn=W({park:{},setPark:()=>{}}),ki=({value:e,children:t})=>r(Pn.Provider,{value:e,children:t}),te=()=>F(Pn);function Ni(){const e=$(),{parks:t}=e,[n,i]=T(()=>{const{id:o=t[0].id,date:s=""}=JSON.parse(sessionStorage.getItem(wi)||"{}")||{};return s===D().date&&t.find(a=>a.id===o)||t[0]});return{park:n,setPark:i}}/**
 * Refresh icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function we({className:e}){return r(O,{className:e,children:r("path",{d:"M16 6h-6l2.243-2.243c-1.133-1.133-2.64-1.757-4.243-1.757s-3.109 0.624-4.243 1.757c-1.133 1.133-1.757 2.64-1.757 4.243s0.624 3.109 1.757 4.243c1.133 1.133 2.64 1.757 4.243 1.757s3.109-0.624 4.243-1.757c0.095-0.095 0.185-0.192 0.273-0.292l1.505 1.317c-1.466 1.674-3.62 2.732-6.020 2.732-4.418 0-8-3.582-8-8s3.582-8 8-8c2.209 0 4.209 0.896 5.656 2.344l2.343-2.344v6z"})})}function Je(e){const{children:t,color:n="bg-black",className:i="",...o}=e;return r("div",{className:`fixed inset-0 z-10 flex items-center justify-center p-2 ${n} bg-opacity-75 ${i}`,...o,children:t})}function Si(){const{bg:e}=G();return r(Je,{color:"bg-white",children:r("div",{className:"w-[50px] mx-auto",children:r("div",{"aria-label":"Loading\u2026",className:`rounded-full p-[20%] ${e}`,children:r(we,{className:"animate-spin w-full text-white"})})})})}const Ei=3e3,Ti={alert:"bg-yellow-200",error:"bg-red-200"};function An(){const[,e]=T(0),[t,n]=T(""),[i,o]=T("alert"),s=U((l,u)=>{n(l),o(u||"alert"),e(h=>(clearTimeout(h),l?self.setTimeout(()=>{n("")},Ei):h))},[]);return[t?r(Ii,{message:t,type:i}):null,s]}function Ii({message:e,type:t}){return e?r("div",{role:"alert",className:`fixed bottom-20 left-0 w-full p-2 font-semibold text-center ${Ti[t]} text-gray-800`,children:e}):null}async function Mt(e){return new Promise(t=>{setTimeout(t,e)})}const Ci=500;function K(){const[e,t]=T(0),[n,i]=An(),o=U(async(a,l={})=>{var k;const{messages:u={},minLoadTime:h=Ci}=l,c={error:"Unknown error occurred",request:"Network request failed",...u};i("");let p=()=>null;const f=new Promise(y=>{p=()=>y(null)});async function d(...y){await f,i(...y)}t(y=>y+1);const m=Mt(h);try{await a(d)}catch(y){const S=(k=y==null?void 0:y.response)==null?void 0:k.status;Number.isInteger(S)?d(S in c?c[S]:c.request,"error"):(console.error(y),d(c.error,"error"))}await m,await Mt(0),t(y=>y-1),p()},[i]),s=e>0||n?r(w,{children:[e>0&&r(Si,{}),n]}):null;return{loadData:o,loaderElem:s,flash:i}}function Dn(e){const[,t]=T(0);return U((n=0)=>{t(i=>Date.now()-i<n?i:(e(),Date.now()))},[e])}const Ln=W({plans:[],refreshPlans:()=>{},loaderElem:null}),Pi=Ln.Provider,ke=()=>F(Ln);function Ai(){const e=$(),{loadData:t,loaderElem:n}=K(),[i,o]=T([]),s=Dn(U(()=>{t(async()=>{o(await e.bookings())})},[e,t]));return A(s,[s]),{plans:i,refreshPlans:s,loaderElem:n}}const Rn=W({current:void 0,begin:()=>null,end:()=>null}),Di=Rn.Provider,ne=()=>F(Rn),Li=()=>{const[e,t]=T({current:void 0,begin:n=>{t({...e,current:n})},end:()=>{t(n=>n.current?{...n,current:void 0}:n)}});return e},Mn=W({tabs:[],active:{name:"",icon:r("div",{}),component:()=>null},changeTab:()=>{},scrollPos:{get:()=>0,set:()=>{}}}),On=()=>F(Mn);function Ri({name:e,icon:t}){const n=G(),{active:i,changeTab:o}=On();if(!o)return null;const a=(i==null?void 0:i.name)===e?`bg-white bg-opacity-90 ${n.text}`:`${n.bg} text-white`;return r("button",{className:"px-4 py-2",onClick:()=>o(e),children:[r("div",{className:`min-w-[3rem] rounded-full py-1.5 ${a}`,children:t}),r("div",{className:"mt-0.5 text-sm",children:e})]})}function Ke({heading:e,buttons:t,children:n,contentRef:i}){const{tabs:o,scrollPos:s,footer:a}=On();let l=H(null);return i&&(l=i),hn(()=>{const u=l.current;if(!u)return;u.scroll(0,s.get());const h=()=>s.set(u.scrollTop);return u.addEventListener("scroll",h),()=>u.removeEventListener("scroll",h)},[s]),r(L,{heading:e,buttons:t,footer:r(w,{children:[r("div",{className:"flex items-center justify-center",children:o.map(u=>ge(Ri,{...u,key:u.name}))}),a]}),contentRef:l,children:n})}function Mi({tabs:e,footer:t},n){return function i({tabName:o}){const{goTo:s}=M(),a=U(h=>{h!==o&&s(r(i,{tabName:h}),{replace:!0})},[o,s]),l=H(Object.fromEntries(e.map(h=>[h.name,0]))),u=e.find(({name:h})=>h===o);return u?r(Mn.Provider,{value:{tabs:e,active:u,changeTab:a,scrollPos:{get:()=>l.current[u.name],set:h=>{l.current[u.name]=h}},footer:t},children:r(n,{tab:u})}):null}}const $n=W({experiences:[],refreshExperiences:()=>{},loaderElem:null}),Oi=$n.Provider,qe=()=>F($n);function $i(){const e=$(),{park:t}=te(),{loadData:n,loaderElem:i}=K(),[o,s]=T([]),a=Dn(U(()=>{n(async()=>{s(await e.experiences(t))})},[t,e,n]));return A(a,[a]),A(()=>s([]),[t]),{experiences:o,refreshExperiences:a,loaderElem:i}}/**
 * Calendar icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function Gn({className:e}){return r(O,{className:e,children:r("path",{d:"M5 6h2v2h-2zM8 6h2v2h-2zM11 6h2v2h-2zM2 12h2v2h-2zM5 12h2v2h-2zM8 12h2v2h-2zM5 9h2v2h-2zM8 9h2v2h-2zM11 9h2v2h-2zM2 9h2v2h-2zM13 0v1h-2v-1h-7v1h-2v-1h-2v16h15v-16h-2zM14 15h-13v-11h13v11z"})})}/**
 * Clock icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function Gi(e){return r(O,{...e,children:r("path",{d:"M10.293 11.707l-3.293-3.293v-4.414h2v3.586l2.707 2.707zM8 0c-4.418 0-8 3.582-8 8s3.582 8 8 8 8-3.582 8-8-3.582-8-8-8zM8 14c-3.314 0-6-2.686-6-6s2.686-6 6-6c3.314 0 6 2.686 6 6s-2.686 6-6 6z"})})}/**
 * Power icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function $e(e){return r(O,{...e,children:r("path",{d:"M6 0l-6 8h6l-4 8 14-10h-8l6-6z"})})}/**
 * Checkmark icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function Ot({className:e}){return r(O,{className:e,children:r("path",{d:"M13.5 2l-7.5 7.5-3.5-3.5-2.5 2.5 6 6 10-10z"})})}/**
 * Arrow-down icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function $t(e){return r(O,{...e,children:r("path",{d:"M8 15.5l7.5-7.5h-4.5v-8h-6v8h-4.5z"})})}/**
 * Star icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function Bi(e){return r(O,{...e,children:r("path",{d:"M16 6.204l-5.528-0.803-2.472-5.009-2.472 5.009-5.528 0.803 4 3.899-0.944 5.505 4.944-2.599 4.944 2.599-0.944-5.505 4-3.899z"})})}function Bn({bg:e,experiences:t,heading:n}){return r("div",{className:`mt-4 rounded ${e}`,children:[r("h3",{className:"mt-0 p-1 text-white text-center",children:n}),r("ul",{className:"list-disc py-2 pl-8 bg-white bg-opacity-90",children:t.map(i=>r("li",{children:i.name},i.id))})]})}function X({date:e,time:t,...n}){return r("time",{...n,dateTime:e||t,children:e?Gr(e):t?J(t):""})}function Ne({start:e,end:t,timeOnly:n}){const i=Ui({start:e,end:t}),o=t?r(w,{children:[i.start?r(X,{time:i.start}):r("span",{children:"Park Open"})," \u2013"," ",i.end?r(X,{time:i.end}):r("span",{children:"Park Close"})]}):r(X,{time:e.time});if(n)return o;const s=D().date;return r("table",{className:"mt-4 text-lg",children:r("tbody",{children:[r(Gt,{label:t?"Arrive by":"Reservation at",data:o}),(t==null?void 0:t.date)&&t.date>(e.date??s)&&r(Gt,{label:"Valid until",data:r(X,{date:t.date})})]})})}function Gt({label:e,data:t}){return r("tr",{children:[r("th",{className:"text-right",children:[e,":"]}),r("td",{className:"pl-2 font-semibold",children:t})]})}function Ui({start:e,end:t}){const n=D().date;return{start:(e.date||"")<n?void 0:e.time,end:t==null?void 0:t.time}}const Bt=r("span",{"aria-hidden":!0,children:"\u2022"});function Un({booking:e,button:t}){const n=G();return r("div",{className:"flex items-center gap-x-3",children:[r("div",{className:"flex-1 min-w-0",children:[r("div",{className:"flex items-center gap-x-2 text-gray-500 text-sm font-semibold uppercase",children:[e.subtype==="DAS"&&r(w,{children:[r("span",{children:"DAS"}),Bt]}),e.type==="BG"?r(w,{children:[r("span",{children:["BG\u200A",e.boardingGroup]}),e.status==="SUMMONED"&&r(w,{children:[Bt,r("span",{className:`${n.text} font-bold`,children:"Board Now"})]})]}):r(Ne,{...e,timeOnly:!0})]}),r("div",{className:"text-lg font-semibold leading-snug truncate",children:e.choices?"Multiple Experiences":e.name})]}),t&&r("div",{children:t})]})}function zn(){const e=ne(),t=G();return e.current?r("div",{className:`sticky top-0 -mx-3 pb-1 ${t.bg}`,children:r("div",{className:"pb-3 bg-white",children:[r("div",{className:`pb-1 ${t.bg} text-white text-sm font-semibold uppercase text-center`,children:"Modifying Reservation"}),r("div",{className:"mt-2 px-3",children:r(Un,{booking:e.current,button:r(R,{type:"small",back:{screen:nt},onClick:e.end,children:"Keep"})})})]})}):null}function B({guests:e,selectable:t,conflicts:n}){return e.length===0?null:r("ul",{className:"mt-2",children:e.map(i=>{var o;return r("li",{className:"px-3 py-1",children:r("label",{className:"flex items-center",children:[t&&r("input",{type:"checkbox",checked:t.isSelected(i),onChange:()=>t.onToggle(i),className:"mr-3"}),r("span",{className:"w-[48px] h-[48px] leading-[48px] mr-3 rounded-full text-3xl font-bold text-center bg-gray-400 text-white",children:i.avatarImageUrl?r("img",{src:i.avatarImageUrl,alt:"",width:"48",height:"48",className:"rounded-full"}):r("span",{"aria-hidden":"true",children:i.name[0]})}),r("span",{className:"leading-tight",children:[i.name,r("br",{}),(n==null?void 0:n[i.id])&&r("span",{className:"text-xs font-semibold text-red-700 uppercase",children:(o=n[i.id])==null?void 0:o.replace(/_/g," ")})]})]})},i.id)})})}const Hn="bg1.genie.partyIds";function Wn(){const e=JSON.parse(localStorage.getItem(Hn)||"[]");return Array.isArray(e)?e:[]}function zi(){const e=$();A(()=>e.setPartyIds(Wn()),[e])}function Hi(){const e=$(),{loadData:t,loaderElem:n}=K(),[i,o]=T(!0),[s,a]=T(),[l,u]=T(()=>{const d=new Set(Wn());return o(d.size===0),d});function h(){const d=[...l];localStorage.setItem(Hn,JSON.stringify(d)),e.setPartyIds(d)}A(()=>{t(async()=>{const d=await e.guests();a([...d.eligible,...d.ineligible].sort((m,k)=>+!m.primary-+!k.primary||m.name.localeCompare(k.name)))})},[e,t]),A(()=>{i&&u(new Set)},[i]);const c=s==null?void 0:s.filter(d=>l.has(d.id)),p=s==null?void 0:s.filter(d=>!l.has(d.id)),f=d=>r("li",{children:r("label",{className:"flex items-center mt-2",children:[r("input",{type:"radio",name:"auto",onChange:()=>o(d.auto),checked:i===d.auto,className:"mr-2"})," ",d.children]})});return r(L,{heading:"Party Selection",children:[r("p",{children:"By default, all eligible guests (up to a maximum of 12) are automatically selected when you book a Lightning Lane. If you would like to limit who you book for, you can manually select your party here."}),r("ul",{children:[r(f,{auto:!0,children:"Book for all eligible guests"}),r(f,{auto:!1,children:"Only book for selected guests"})]}),i?null:(s==null?void 0:s.length)===0?r("p",{className:"text-red-700",children:"No guests to select"}):c&&p?r(w,{children:[c.length>0&&r(w,{children:[r("h3",{children:"Your Party"}),r(B,{guests:c,selectable:{isSelected:()=>!0,onToggle:d=>{const m=new Set(l);m.delete(d.id),u(m)}}})]}),p.length>0&&r(w,{children:[r("h3",{children:"Add to Your Party"}),r(B,{guests:p,selectable:{isSelected:()=>!1,onToggle:d=>{const m=new Set(l);m.add(d.id),u(m)}}})]})]}):null,n,r(z,{back:!0,disabled:!i&&l.size===0,onClick:h,children:"Save"})]})}function Ze({name:e,onClick:t,...n}){return r(R,{...n,title:`Refresh ${e}`,onClick:t,children:r(we,{})})}const Fn=W({eligible:[],ineligible:[],selected:[],setSelected:()=>null,experience:{name:"",park:{name:"",theme:{bg:"",text:""}}}}),jn=Fn.Provider,Vn=()=>F(Fn),Wi="https://bg1.joelface.com/ping",Ut="bg1.ping.date";async function Yn(){const{date:e}=D();if(localStorage.getItem(Ut)===e)return;const{status:n}=await xe(Wi,{method:"POST"});n===204&&localStorage.setItem(Ut,e)}function Fi(e){return r(O,{...e,children:r("path",{d:"M 5.5253906 0.9296875 L 3.4042969 3.0507812 L 8.3535156 8 L 3.4042969 12.949219 L 5.5253906 15.070312 L 10.474609 10.121094 L 12.595703 8 L 10.474609 5.8789062 L 5.5253906 0.9296875 z"})})}function Qn(e){return r("div",{className:`mt-4 border-2 rounded border-green-600 p-1 font-semibold text-center text-green-600 bg-green-100 ${e.className}`,children:e.children})}function ji({booking:e,onCancel:t}){const n=$(),{refreshPlans:i}=ke(),[o,s]=T(new Set),{loadData:a,loaderElem:l}=K(),{name:u,park:h,guests:c}=e,p=o.size===0,f=o.size===c.length;async function d(){p||(await a(async()=>{await n.cancelBooking([...o]),f&&i()}),t(c.filter(m=>!o.has(m))))}return r(L,{heading:"Cancel Guests",theme:h.theme,children:[r("h2",{children:u}),r("div",{children:h.name}),r(Ne,{...e}),r("div",{className:"ml-3",children:r("label",{className:"flex items-center py-4",children:[r("input",{type:"checkbox",checked:f,onChange:()=>s(new Set(f?[]:c))}),r("span",{className:"ml-3",children:"Select All"})]})}),!p&&r("div",{className:"mb-4",children:[r("h3",{children:"Cancel These Guests"}),r(B,{guests:c.filter(m=>o.has(m)),selectable:{isSelected:()=>!0,onToggle:m=>{const k=new Set(o);k.delete(m),s(k)}}})]}),!f&&r("div",{children:[r("h3",{children:"Select Guests to Cancel"}),r(B,{guests:c.filter(m=>!o.has(m)),selectable:{isSelected:()=>!1,onToggle:m=>s(new Set(o).add(m))}})]}),r(z,{back:!0,disabled:p,onClick:d,children:"Cancel "+(f?"Reservation":"Guests")}),l]})}function Jn({booking:e}){var b;const{goTo:t,goBack:n}=M(),{setPark:i}=te(),o=$(),{name:s,park:a,choices:l,type:u,start:h}=e,c=u==="LL",p=u==="BG",f=ne(),[d,m]=T(c?e.guests:void 0),k=new Map([[a,[]],...o.parks.map(_=>[_,[]])]);for(const _ of l||[])(b=k.get(_.park))==null||b.push(_);const y=[...k].filter(([,_])=>_.length>0).map(([_])=>_),S=(l?y.length===1?y[0]:{}:a).theme??Ye;return r(L,{heading:"Your "+(c?e.subtype==="DAS"?"DAS Return Time":"Lightning Lane":p?"Boarding Group":"Reservation"),theme:S,buttons:e.modifiable&&r(R,{onClick:()=>{f.begin(e),i(e.park),n({screen:nt,props:{tabName:"Genie+"}})},children:"Modify"}),children:[r("div",{className:`-mx-3 px-2 py-1 text-center ${S.bg} text-white text-sm font-semibold uppercase`,children:r(X,{date:h.date})}),l?r("h2",{children:"Multiple Experiences"}):r(w,{children:[r("h2",{children:s}),r("div",{children:a.name})]}),p?r(w,{children:[e.status==="SUMMONED"&&r(Qn,{children:"Your boarding group has been called"}),r("h3",{children:["Boarding Group:"," ",r("span",{className:"ml-1 font-semibold",children:e.boardingGroup})]}),r("p",{children:"Check the official Disney app for return time and other virtual queue information."})]}):r(Ne,{...e}),l&&r(w,{children:[r("p",{children:[r("b",{children:s})," was temporarily unavailable during your return time. You may redeem this Lightning Lane at one of these replacement experiences:"]}),[...k].filter(([,_])=>_.length>0).map(([_,x])=>r(Bn,{heading:_.name,experiences:x,bg:_.theme.bg},_.id))]}),r("div",{className:"flex mt-4",children:[r("h3",{className:"inline mt-0",children:"Your Party"}),e.cancellable&&d&&r(R,{type:"small",onClick:()=>{t(r(ji,{booking:{...e,guests:d},onCancel:_=>{_.length>0?m(_):n()}}))},className:"ml-3",children:"Cancel"})]}),r(B,{guests:d||e.guests,conflicts:d&&Object.fromEntries(d.filter(_=>(_.redemptions??1)!==1).map(_=>[_.id,`Redemptions left: ${_.redemptions}`]))})]})}function Kn({...e}){var c,p;const{plans:t,refreshPlans:n,loaderElem:i}=ke(),{goTo:o}=M(),s=G();function a(f){o(r(Jn,{booking:f}))}const l=D().date,u=new Map,h=new Map;for(const f of t){const d=f.start.date??l;u.has(d)||u.set(d,[]),f.type!=="APR"&&((c=u.get(d))==null||c.push(f)),h.has(d)||h.set(d,new Set),(f.type!=="LL"||f.subtype!=="MEP")&&f.park.icon&&((p=h.get(d))==null||p.add(f.park))}return r(Ke,{heading:"Your Plans",buttons:r(Ze,{name:"Plans",onClick:n}),theme:Ye,...e,children:[t.length>0?[...u].map(([f,d])=>r("div",{children:[r("div",{className:"sticky top-0 -mx-3 pt-1 bg-white",children:r("div",{className:"flex items-center",children:[r("h2",{className:`flex-1 mt-0 rounded-r-full px-3 py-1 ${s.bg} text-white text-sm uppercase`,children:r(X,{date:f})}),r("ul",{className:"px-3 pl-2 text-lg text-right",children:[...h.get(f)??[]].map(m=>r("li",{className:"inline ml-1 first:ml-0","aria-label":m.name,children:m.icon},m.id))})]})}),r("ul",{className:d.length===0?"mt-3":"",children:d.map(m=>r("li",{className:"py-2.5 first:border-0 border-t-4 border-gray-300",onClick:()=>a(m),children:r(Un,{booking:m,button:r("button",{className:s.text,title:"More Info",children:r(Fi,{})})})},m.bookingId))})]},f)):r("p",{className:"font-semibold text-center uppercase text-gray-500",children:"No existing plans"}),i]})}function Vi({...e}){const{goTo:t}=M();return r(w,{children:r(R,{...e,onClick:()=>t(r(Kn,{})),title:"Plans",children:r(Gn,{})})})}function Xe(){const{ineligible:e}=Vn();return r(B,{guests:e,conflicts:Object.fromEntries(e.map(t=>[t.id,t.eligibleAfter?`TOO EARLY (${J(t.eligibleAfter)})`:t.ineligibleReason||"ELIGIBLE FOR NEW BOOKING"]))})}function Yi(){const e=$(),t=ne();return r(w,{children:[e.nextBookTime&&r(Qn,{children:["Eligible at ",J(e.nextBookTime)]}),t.current?r(w,{children:[r("h3",{children:"Unable to Modify"}),r("p",{children:"Your current reservation cannot be modified to this experience due to the following conflicts:"})]}):r(w,{children:[r("h3",{children:"No Eligible Guests"}),r("p",{children:"No one in your party is currently eligible for this Lightning Lane."})]}),r(Xe,{})]})}function Qi({onRefresh:e}){return r(w,{children:[r("h3",{children:"No Guests Found"}),r("p",{children:"Your party could not be loaded. This is probably just a temporary network error. Wait a few seconds and try again."}),r(z,{onClick:e,children:"Try Again"})]})}function Ji(e){return r("div",{className:`mt-4 border-2 rounded border-red-600 p-1 font-semibold text-center text-red-600 bg-red-100 ${e.className}`,children:e.children})}function Ki({party:e}){const{eligible:t,ineligible:n,selected:i,setSelected:o,experience:s}=e,[a,l]=T(new Set(i)),[u,h]=An(),{maxPartySize:c}=$();function p(f){l(d=>{h(""),d=new Set(d);const m=d.has(f)?"delete":"add";return m==="add"&&d.size>=c?h(`Maximum party size: ${c}`):d[m](f),d})}return r(jn,{value:e,children:r(L,{heading:"Modify Party",theme:s.park.theme,children:[r("h2",{children:s.name}),r("div",{children:s.park.name}),r("h3",{children:"Your Party"}),r(B,{guests:t,selectable:{isSelected:f=>a.has(f),onToggle:p}}),n.length>0&&r(w,{children:[r("h3",{children:"Ineligible Guests"}),r(Xe,{})]}),r(z,{back:!0,disabled:a.size===0,onClick:()=>{o(t.filter(f=>a.has(f)))},children:"Confirm Party"}),u]})})}function et({button:e}){const{goTo:t}=M(),n=Vn(),{eligible:i,selected:o}=n,{maxPartySize:s}=$();return r(w,{children:[i.length>s&&o.length===s&&r(Ji,{children:"Party size restricted"}),o.length>0?r(w,{children:[r("div",{className:"mt-4",children:[r("h3",{className:"inline mt-0",children:"Your Party"}),r(R,{type:"small",onClick:()=>t(r(Ki,{party:n})),className:"ml-3",children:"Modify"})]}),r(B,{guests:o})]}):r(w,{children:[r("h3",{children:"Ineligible Guests"}),r(Xe,{})]}),e]})}function qi(){return r(w,{children:[r("h3",{children:"No Reservations Available"}),r("p",{children:"There aren't enough reservation slots available for your entire party. If only part of your group wishes to go on this attraction, edit your party to check again. Otherwise, go back to the tip board and select another attraction."}),r(et,{})]})}function Zi({offer:e,onBook:t}){const n=ne();return r(w,{children:[r(Ne,{...e}),e.changed&&r("div",{className:"text-sm",children:[r("strong",{children:"Note:"})," Return time has been changed"]}),r(et,{button:r(z,{onClick:t,children:`${n.current?"Modify":"Book"} Lightning Lane`})})]})}const zt="https://widget.time.is/t.js";function Xi(){if([...document.scripts].some(t=>t.src===zt))return;const e=document.createElement("script");e.src=zt,e.onload=qn,document.head.appendChild(e)}const me={};function qn(){"time_is_widget"in self&&self.time_is_widget.init(me)}function es(e){Xi(),me[e]||(me[e]={}),qn()}function Zn(e,t){const n=document.getElementById(e);if(!n||n.firstElementChild)return t();n.textContent=D().time,setTimeout(()=>Zn(e,t),100)}function ts({id:e,onSync:t}){return A(()=>{es(e),Zn(e,t)},[e,t]),r("time",{id:e})}const ns={WDW:"Orlando_z161",DLR:"Anaheim_z14e"},rs=5e3;function Xn({resort:e,time:t,label:n}){const i=ns[e],[o,s]=T(null);A(()=>{setTimeout(()=>s(l=>l||!1),rs)},[]);const a=U(()=>s(!0),[]);return r("table",{className:"mt-4 mx-auto text-gray-500",children:r("tbody",{children:[r(Ht,{heading:n,time:r("time",{children:t||"--:--:--"})}),r(Ht,{heading:r("a",{href:`https://time.is/${i.split("_")[0]}`,id:"time_is_link",target:"_blank",rel:"noreferrer",children:"Current time"}),time:r(w,{children:[r(ts,{id:i,onSync:a}),o===!1&&r("span",{className:"text-sm font-sans font-semibold text-red-600",children:[" ","(unsynced)"]})]})})]})})}function Ht({heading:e,time:t}){return r("tr",{children:[r("th",{scope:"row",className:"pr-3 text-right text-xs font-semibold uppercase",children:[e,":"]}),r("td",{className:"text-xl font-mono leading-tight",children:["\uFEFF",t]})]})}function is({startTime:e,onRefresh:t}){return r(w,{children:[e?r(w,{children:[r(Xn,{resort:"WDW",time:e,label:"Booking start"}),r("p",{children:["At"," ",r("time",{dateTime:e,className:"font-semibold",children:J(e)}),", tap the ",r("span",{className:"font-semibold",children:"Check Availability"})," ","button below to start booking this Lightning Lane."]})]}):r("p",{children:"Sorry, but you can't make a Lightning Lane reservation for this attraction yet."}),r(et,{button:r(z,{onClick:t,children:"Check Availability"})})]})}function ss({experience:e}){const{goTo:t}=M(),n=$(),{refreshPlans:i}=ke(),o=ne(),[s,a]=T(),[l,u]=T(!e.flex.available&&e.flex.enrollmentStartTime!==void 0),[h,c]=T(l?null:void 0),{loadData:p,loaderElem:f}=K();async function d(){!h||!s||p(async()=>{let _=null;try{_=await n.book(h,o.current,s.selected)}finally{o.end()}const x=new Set(s.selected.map(I=>I.id)),N=_.guests.filter(I=>!x.has(I.id));N.length>0&&(await n.cancelBooking(N),_.guests=_.guests.filter(I=>x.has(I.id))),_&&t(r(Jn,{booking:_}),{replace:!0}),i(),Yn()},{messages:{410:"Offer expired"}})}function m(){p(async _=>{var I;const N=(await n.experiences(e.park)).find(v=>v.id===e.id);(I=N==null?void 0:N.flex)!=null&&I.available?(u(!1),c(void 0)):_("Reservations not open yet")})}const k=U(()=>{p(async()=>{const _=o.current?{eligible:o.current.guests,ineligible:[]}:await n.guests(e);a({..._,selected:_.eligible.slice(0,n.maxPartySize),setSelected:x=>a(N=>{if(!N)return N;const I=new Set(N.selected);return u(v=>(v||c(E=>E===null||x.some(j=>!I.has(j))?void 0:E),v)),{...N,selected:x}}),experience:e})})},[n,e,o,p]);A(()=>{s||k()},[s,k]);const y=U(_=>{!s||s.selected.length===0||p(async()=>{try{const x=await n.offer(e,s.selected,o.current),{ineligible:N}=x.guests;if(N.length>0){const I=new Set(N.map(E=>E.id)),v=E=>!I.has(E.id);a({...s,eligible:s.eligible.filter(v),ineligible:[...N,...s.ineligible],selected:s.selected.filter(v)})}x.active?(h&&(x.changed=!1),c(x)):c(I=>I??null)}catch(x){throw _||c(null),x}},{messages:{410:h?"No reservations available":""}})},[n,e,s,h,o,p]);A(()=>{h===void 0&&y()},[h,y]),A(()=>()=>{h&&n.cancelOffer(h)},[h,n]);const S=(s==null?void 0:s.eligible.length)===0,b=S&&(s==null?void 0:s.ineligible.length)===0;return r(L,{heading:"Lightning Lane",theme:e.park.theme,buttons:r(w,{children:[r(Vi,{}),!l&&r(R,{onClick:()=>{!s||s.selected.length===0?k():y()},title:"Refresh",children:r(we,{})})]}),children:[r(zn,{}),r("h2",{children:e.name}),r("div",{children:e.park.name}),s&&r(jn,{value:s,children:l&&s?r(is,{startTime:e.flex.enrollmentStartTime,onRefresh:m}):b?r(Qi,{onRefresh:k}):S?r(Yi,{}):!s||h===void 0?r("div",{}):h===null?r(qi,{}):r(Zi,{offer:h,onBook:d})}),f]})}function tt({label:e,children:t}){return r("div",{className:"flex items-center flex-1 whitespace-nowrap",children:[r("span",{className:"mr-2 text-xs font-semibold uppercase text-gray-500",children:e})," ",t]})}function os({experience:e}){const{goTo:t}=M(),{flex:n}=e;return r(tt,{label:"Genie+",children:r("span",{children:r(R,{onClick:()=>t(r(ss,{experience:e})),children:n.nextAvailableTime?J(n.nextAvailableTime):"none"})})})}function er({children:e}){return r("div",{className:"mt-8 flex justify-center",children:r("div",{children:[r("h2",{className:"mt-0 pl-1 text-gray-500 text-sm leading-tight uppercase",children:"Symbols"}),r("div",{className:"border-2 border-gray-500 rounded px-2 py-0.5 bg-gray-100",children:r("table",{children:r("tbody",{children:e})})})]})})}function se({sym:e,def:t,onInfo:n}){return r("tr",{children:[r("th",{className:"py-0.5 text-center font-bold",children:e}),r("td",{className:"pl-3 py-0.5",children:t}),n&&r("td",{className:"pl-3 py-0.5",children:r(R,{type:"small",onClick:n,children:"Info"})})]})}const as="_SELECT_RADIO_BUTTON_";function tr(e){const{options:t,selected:n,title:i,onChange:o,...s}=e,[a,l]=T(!1),[u,h]=T(0),c=H(null),p=H(null);hn(()=>{var I;if((I=t.values().next().value)!=null&&I.icon)return;const b=c.current,_=b==null?void 0:b.firstChild;if(!_)return;const x=_.nodeValue;if(!x)return;let N=0;for(const v of t.values())_.nodeValue=v.text,N=Math.max(b.offsetWidth,N);_.nodeValue=x,h(N)},[t]);const f=()=>{var b;return(b=p.current)==null?void 0:b.querySelector("input:checked")};A(()=>{var _;if(!a)return;(_=f())==null||_.focus();const b=x=>{var N;(N=p.current)!=null&&N.contains(x.target)||l(!1)};return addEventListener("focusin",b),()=>removeEventListener("focusin",b)},[a]);const d=()=>{const b=f();if(b){const _=b.value,x=t.get(_);x&&o(x.value??_)}l(!1)},m=t.get(n);if(!m)return null;const{icon:k,text:y}=m;let S=!1;return r(w,{children:[r(R,{...s,title:k?`${i}: ${m.text}`:i,onClick:()=>l(!0),children:[k||r("span",{style:{minWidth:`${u}px`},ref:c,children:y}),r(O,{className:"w-2.5 ml-2",children:r("path",{d:"m6.8273 12.401-5.6333-7.7812a1.0212 1.0212 117.05 0 1 0.82716-1.62l11.958-2e-7a1.0212 1.0212 62.952 0 1 0.82714 1.62l-1.6438 2.2705a79984 79984 125.9 0 0-2.3456 3.2401l-1.6437 2.2706a1.4479 1.4479 180 0 1-2.3456 4.4e-5z"})})]}),a&&r(Je,{onChange:()=>{S||d(),S=!1},onClick:b=>{var _;(_=p.current)!=null&&_.contains(b.target)||l(!1)},onKeyDown:({key:b})=>{["Enter"," "].includes(b)?d():b.startsWith("Arrow")&&(S=!0)},"data-testid":"shade",children:r("ul",{className:"overflow-auto min-w-[50%] max-h-[90%] rounded-lg bg-white text-black",ref:p,children:[...t].map(([b,_])=>r("li",{className:"border-t-2 first:border-0 border-gray-300",children:r("label",{className:"flex flex-row items-center gap-x-2.5 px-4 py-3",children:[r("input",{type:"radio",name:as,value:b,defaultChecked:b===n,className:"w-4 h-4"})," ",_.icon&&r("span",{"aria-hidden":"true",children:_.icon})," ",_.text]})},_.text))})})]})}function nr(e){const{parks:t}=$(),{park:n,setPark:i}=te(),o=He(()=>new Map(t.map(s=>[s.id,{value:s,icon:s.icon,text:s.name}])),[t]);return r(tr,{...e,options:o,selected:n.id,onChange:i,title:"Park","data-testid":"park-select"})}function ls({experience:{type:e,standby:t}}){return t.displayNextShowTime||e==="ENTERTAINMENT"&&!t.waitTime?r(ds,{standby:t}):r(cs,{standby:t})}const cs=({standby:e})=>r(tt,{label:"Standby",children:e.available?r(ir,{time:e.waitTime!==void 0?e.waitTime+" min":"now"}):r(sr,{text:"down"})}),ds=({standby:e})=>r(tt,{label:r(w,{children:["Next ",r("span",{className:"hidden xs:inline",children:"Show"})]}),children:e.displayNextShowTime?r(ir,{time:e.displayNextShowTime}):r(sr,{text:"none"})}),rr="inline-block border-2 rounded px-1.5 py-0.5 font-semibold",ir=({time:e})=>r("span",{className:`${rr} border-gray-500 text-gray-500 bg-gray-100`,children:e}),sr=({text:e})=>r("span",{className:`${rr} border-red-600 text-red-600 bg-red-100`,children:e});function us({bookTime:e,dropTime:t}){const n=G();return!e&&!t?null:r("div",{className:`flex justify-center gap-x-10 -mx-3 px-3 pb-1 ${n.bg} text-white text-sm font-semibold uppercase text-center`,children:[r(Wt,{label:"Book",time:e}),r(Wt,{label:"Drop",time:t})]})}function Wt({label:e,time:t}){if(!t)return null;t=t.slice(0,5);const n=D().time.slice(0,5);return r("div",{children:[e,":"," ",r("time",{dateTime:t,className:"whitespace-nowrap",children:t>n?J(t):"now"})]})}async function hs(e={}){return new Promise((t,n)=>{navigator.geolocation.getCurrentPosition(i=>{t(i)},i=>{n(i)},e)})}const fs={maximumAge:15e3,timeout:2e3};function ps(){const[e,t]=T(),n=U(()=>{(async()=>{try{const{coords:i}=await hs(fs);t(o=>o&&i.latitude===o[0]&&i.longitude===o[1]?o:[i.latitude,i.longitude])}catch{t(void 0)}})()},[]);return[e,n]}const ms=(e,t)=>(e.priority||1/0)-(t.priority||1/0),Ce=(e,t)=>(t.standby.waitTime||-1)-(e.standby.waitTime||-1),Pe=(e,t)=>{var n,i;return be(((n=e==null?void 0:e.flex)==null?void 0:n.nextAvailableTime)||"00:00")-be(((i=t==null?void 0:t.flex)==null?void 0:i.nextAvailableTime)||"00:00")},_s=(e,t)=>e.name.toLowerCase().localeCompare(t.name.toLowerCase()),Ft=(e,t)=>Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)),gs=(e,t,n)=>e.geo===t.geo?0:e.geo?t.geo?n?Ft(e.geo,n)-Ft(t.geo,n):0:-1:1,ys={priority:(e,t)=>ms(e,t)||Ce(e,t)||Pe(e,t),standby:(e,t)=>Ce(e,t)||Pe(e,t),soonest:(e,t)=>Pe(e,t)||Ce(e,t),nearby:(e,t,n)=>gs(e,t,n),aToZ:()=>0},vs=new Map([["priority",{text:"Priority"}],["nearby",{text:"Nearby"}],["standby",{text:"Standby"}],["soonest",{text:"Soonest"}],["aToZ",{text:"A to Z"}]]);function bs(e,t){const{n,s:i,e:o,w:s}=e.geo,[a,l]=t;return a<n&&a>i&&l<o&&l>s}function xs(){const{park:e}=te(),{experiences:t}=qe(),[n,i]=ps(),[o,s]=T("priority");A(()=>{o==="nearby"&&i()},[t,o,i]);const a=(u,h)=>{var c,p;return Number((c=h==null?void 0:h.flex)==null?void 0:c.available)-Number((p=u==null?void 0:u.flex)==null?void 0:p.available)||ys[o==="nearby"&&!(n&&bs(e,n))?"priority":o](u,h,n)||_s(u,h)},l=U(u=>r(tr,{...u,options:vs,selected:o,onChange:s,title:"Sort By"}),[o]);return{sorter:a,SortSelect:l}}const ws=30,ks=60,jt="bg1.genie.tipBoard.starred",Ge="Lightning Pick",Be="Upcoming Drop",Ue="Booked",Vt=e=>e.experienced&&!e.starred;function Ns({contentRef:e}){zi();const{goTo:t}=M(),n=$(),{park:i}=te(),{experiences:o,refreshExperiences:s,loaderElem:a}=qe(),{sorter:l,SortSelect:u}=xs(),h=G(),[c,p]=T(()=>{const v=JSON.parse(localStorage.getItem(jt)||"[]");return new Set(Array.isArray(v)?v:[])}),f=H(!0);A(()=>{var v;f.current?f.current=!1:(v=e.current)==null||v.scroll(0,0)},[u,e]);function d({id:v}){p(E=>(E=new Set(E),E.has(v)?E.delete(v):E.add(v),localStorage.setItem(jt,JSON.stringify([...E])),E))}const m=n.nextDropTime(i),k=()=>t(r(Es,{})),y=()=>t(r(Ts,{dropTime:m,park:i})),S=()=>t(r(Is,{})),b=v=>r("li",{className:"pb-3 first:border-0 border-t-4 border-gray-300",children:[r("div",{className:"flex items-center gap-x-2 mt-2",children:[r(Ss,{experience:v,toggleStar:d}),r("h3",{className:"flex-1 mt-0 text-lg font-semibold leading-tight truncate",children:v.name}),v.lp?r(Ae,{name:Ge,icon:$e,onClick:k}):m&&v.drop?r(Ae,{name:Be,icon:$t,onClick:y}):null,v.flex.preexistingPlan&&r(Ae,{name:Ue,icon:Ot,onClick:S})]}),r("div",{className:"flex flex-wrap gap-1.5 mt-2",children:[r(ls,{experience:v}),r(os,{experience:v})]})]},v.id+(v.starred?"*":"")),_=be(D().time),x=o.filter(v=>!!v.flex).map(v=>{var it;const E=v.standby.waitTime||0,j=(it=v==null?void 0:v.flex)==null?void 0:it.nextAvailableTime;return{...v,lp:!!j&&E>=ws&&be(j)-_<=Math.min(ks,(4-Math.trunc(v.priority||4))/3*E),starred:c.has(v.id)}}).sort((v,E)=>+!v.starred-+!E.starred||+!v.lp-+!E.lp||l(v,E)),N=x.filter(v=>!Vt(v)),I=x.filter(Vt).sort((v,E)=>v.name.localeCompare(E.name));return r(Ke,{heading:"Genie+",buttons:r(w,{children:[r(u,{}),r(nr,{}),r(Ze,{name:"Experiences",onClick:s})]}),contentRef:e,children:[r(zn,{}),r(us,{bookTime:n.nextBookTime,dropTime:m}),r("ul",{"data-testid":"unexperienced",children:N.map(b)}),I.length>0&&r(w,{children:[r("h2",{className:`-mx-3 px-3 py-1 text-sm uppercase text-center ${h.bg} text-white`,children:"Previously Experienced"}),r("ul",{"data-testid":"experienced",children:I.map(b)})]}),x.length>0&&r(er,{children:[r(se,{sym:r($e,{className:h.text}),def:Ge,onInfo:k}),r(se,{sym:r($t,{className:h.text}),def:Be,onInfo:y}),r(se,{sym:r(Ot,{className:h.text}),def:Ue,onInfo:S})]}),a]})}function Ae({name:e,icon:t,onClick:n}){const i=G();return r("button",{title:`${e} (more info)`,className:`-mx-2 px-2 ${i.text}`,onClick:n,children:r(t,{})})}function Ss({experience:e,toggleStar:t}){const n=G();return r("button",{title:`${e.starred?"Remove from":"Add to"} Favorites`,className:"-m-2 p-2",onClick:()=>t(e),children:r(Bi,{className:e.starred?n.text:"text-gray-300"})})}function Es(){return r(L,{heading:Ge,children:r("p",{children:"When an attraction with a long standby wait has a Lightning Lane return time in the near future, it's highlighted as a Lightning Pick. Book these quick before they're gone!"})})}function Ts({dropTime:e,park:t}){const n=$(),{bg:i}=G();return r(L,{heading:Be,children:[r("p",{children:["This attraction may be part of the"," ",e?r("time",{dateTime:e,className:"font-semibold",children:J(e)}):"next"," ","drop of additional Lightning Lane inventory, with earlier return times than what's currently being offered. Availability varies but is always limited, so be sure you're ready to book when the drop time arrives!"]}),n.upcomingDrops(t).map(o=>r(Bn,{heading:J(o.time),experiences:o.experiences,bg:i},o.time))]})}function Is(){return r(L,{heading:Ue,children:r("p",{children:"You currently have a Lightning Lane reservation for this attraction."})})}/**
 * Exit icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function Cs(e){return r(O,{...e,children:r("path",{d:"M12 10v-2h-5v-2h5v-2l3 3zM11 9v4h-5v3l-6-3v-13h11v5h-1v-4h-8l4 2v9h4v-3z"})})}/**
 * Heart icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function Ps(e){return r(O,{...e,children:r("path",{d:"M11.8 1c-1.682 0-3.129 1.368-3.799 2.797-0.671-1.429-2.118-2.797-3.8-2.797-2.318 0-4.2 1.882-4.2 4.2 0 4.716 4.758 5.953 8 10.616 3.065-4.634 8-6.050 8-10.616 0-2.319-1.882-4.2-4.2-4.2z"})})}/**
 * News icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function As(e){return r(O,{...e,children:r("path",{d:"M14 4v-2h-14v11c0 0.552 0.448 1 1 1h13.5c0.828 0 1.5-0.672 1.5-1.5v-8.5h-2zM13 13h-12v-10h12v10zM2 5h10v1h-10zM8 7h4v1h-4zM8 9h4v1h-4zM8 11h3v1h-3zM2 7h5v5h-5z"})})}/**
 * Cog icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function Ds(e){return r(O,{...e,children:r("path",{d:"M14.59 9.535c-0.839-1.454-0.335-3.317 1.127-4.164l-1.572-2.723c-0.449 0.263-0.972 0.414-1.529 0.414-1.68 0-3.042-1.371-3.042-3.062h-3.145c0.004 0.522-0.126 1.051-0.406 1.535-0.839 1.454-2.706 1.948-4.17 1.106l-1.572 2.723c0.453 0.257 0.845 0.634 1.123 1.117 0.838 1.452 0.336 3.311-1.12 4.16l1.572 2.723c0.448-0.261 0.967-0.41 1.522-0.41 1.675 0 3.033 1.362 3.042 3.046h3.145c-0.001-0.517 0.129-1.040 0.406-1.519 0.838-1.452 2.7-1.947 4.163-1.11l1.572-2.723c-0.45-0.257-0.839-0.633-1.116-1.113zM8 11.24c-1.789 0-3.24-1.45-3.24-3.24s1.45-3.24 3.24-3.24c1.789 0 3.24 1.45 3.24 3.24s-1.45 3.24-3.24 3.24z"})})}/**
 * User icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function Ls(e){return r(O,{...e,children:r("path",{d:"M9 11.041v-0.825c1.102-0.621 2-2.168 2-3.716 0-2.485 0-4.5-3-4.5s-3 2.015-3 4.5c0 1.548 0.898 3.095 2 3.716v0.825c-3.392 0.277-6 1.944-6 3.959h14c0-2.015-2.608-3.682-6-3.959z"})})}function Rs(){const{goTo:e}=M(),t=$(),[n]=T([{text:"Party Selection",icon:r(Ls,{}),action:()=>e(r(Hi,{}))},{text:"Log Out",icon:r(Cs,{}),action:()=>t.logOut()},{text:"BG1 News",icon:r(As,{}),action:()=>e(r(Cn,{}))},{text:"Support BG1",icon:r(Ps,{className:"text-red-600"}),action:()=>open("https://joelface.github.io/bg1/contact.html#donate")}]),[i,o]=T(!1),s=H(null);return r(w,{children:[r("button",{className:"absolute top-0 right-0 h-full px-4",onClick:()=>o(!0),title:"Settings Menu",children:r(Ds,{})}),i&&r(Je,{onClick:a=>{var l;(l=s.current)!=null&&l.contains(a.target)||o(!1)},"data-testid":"shade",children:r("ul",{className:"overflow-auto min-w-[50%] max-h-[90%] rounded-lg bg-white text-black text-lg font-normal",ref:s,children:n.map(a=>r("li",{className:"border-t-2 first:border-0 border-gray-300",children:r("button",{className:"flex flex-row items-center w-full px-4 py-3",onClick:()=>{o(!1),setTimeout(a.action,50)},children:[r("span",{className:"mr-2.5 text-gray-700","aria-hidden":!0,children:a.icon}),a.text]})},a.text))})})]})}function Ms({contentRef:e}){const{goTo:t}=M(),{experiences:n,refreshExperiences:i,loaderElem:o}=qe(),s=l=>t(r(Os,{exp:l})),a=new Map;return n.filter(l=>l.standby.available||l.standby.unavailableReason==="TEMPORARILY_DOWN").sort((l,u)=>l.land.sort-u.land.sort||(l.sort||1/0)-(u.sort||1/0)||l.name.localeCompare(u.name)).forEach(l=>{var u,h;a.has(l.land)||a.set(l.land,{ATTRACTION:[],ENTERTAINMENT:[],CHARACTER:[]}),(h=(u=a.get(l.land))==null?void 0:u[l.type])==null||h.push(l)}),r(Ke,{heading:"Times Guide",buttons:r(w,{children:[r(nr,{}),r(Ze,{name:"Times",onClick:i})]}),contentRef:e,children:[[...a].map(([l,u])=>r("div",{children:[r("h2",{className:`pr-1 ${l.theme.text} text-sm font-semibold text-right uppercase`,children:l.name}),r("div",{className:"rounded overflow-hidden",children:[r(De,{title:"Attractions",land:l,experiences:u.ATTRACTION,onInfoClick:s}),r(De,{title:"Entertainment",land:l,experiences:u.ENTERTAINMENT,onInfoClick:s}),r(De,{title:"Characters",land:l,experiences:u.CHARACTER,onInfoClick:s})]})]},l.name)),n.length>0&&r(er,{children:[r(se,{sym:"*",def:"No listed wait/show time"}),r(se,{sym:"\u274C",def:"Temporarily down"})]}),o]})}function De({title:e,land:t,experiences:n,onInfoClick:i}){return n.length===0?null:r("div",{className:`${t.theme.bg}`,"data-testid":`${t.name}-${e}`,children:[r("h3",{className:"mt-0 py-1 text-white text-xs font-semibold text-center uppercase",children:e}),r("table",{className:"w-full bg-white bg-opacity-90 leading-snug",children:r("tbody",{children:n.map(o=>{var s;return r("tr",{className:"group",children:[r("td",{className:`${o.standby.displayNextShowTime?"min-w-[5.625rem]":"min-w-[2.75rem]"} px-2 py-0.5 group-first:pt-1 group-last:pb-1 ${t.theme.bg} bg-opacity-10 ${t.theme.text} font-bold text-center uppercase whitespace-nowrap`,children:o.standby.displayNextShowTime?(((s=o.displayAdditionalShowTimes)==null?void 0:s.length)??0)>0?r("button",{onClick:()=>i(o),className:"underline",children:o.standby.displayNextShowTime}):o.standby.displayNextShowTime:o.standby.available?o.standby.waitTime??"*":"\u274C"}),r("td",{className:"w-full px-1 pl-2 py-0.5 group-first:pt-1 group-last:pb-1",children:o.name})]},o.id)})})})]})}const Os=({exp:e})=>{var t;return r(L,{heading:"Experience Info",children:[r("h2",{children:e.name}),r("div",{children:e.park.name}),r("h3",{children:["Upcoming ",e.type==="CHARACTER"?"Appearances":"Shows"]}),r("ul",{className:"list-disc mt-2 pl-6",children:[!!e.standby.displayNextShowTime&&r("li",{children:e.standby.displayNextShowTime}),(t=e.displayAdditionalShowTimes)==null?void 0:t.map(n=>r("li",{children:n},n))]})]})},Yt=6e4,or="bg1.genie.merlock.tab",$s=()=>localStorage.getItem(or)??"Genie+",Gs=[{name:"Genie+",icon:r($e,{}),component:Ns},{name:"Times",icon:r(Gi,{}),component:Ms},{name:"Plans",icon:r(Gn,{}),component:Kn}],Bs=r(Rs,{}),nt=Mi({tabs:Gs,footer:Bs},({tab:e})=>{const t=ne(),{park:n}=te(),i=$i(),{refreshExperiences:o}=i,{refreshPlans:s}=ke(),a=H(null);return A(()=>{localStorage.setItem(or,e.name)},[e]),A(()=>Qe(()=>{o(Yt),s(Yt)}),[o,s]),A(()=>{var l;t.current&&((l=a.current)==null||l.scroll(0,0))},[t]),r(In,{value:n.theme,children:r(Oi,{value:i,children:r(e.component,{contentRef:a})})})});function Us(){const e=Ni();return r(Pi,{value:Ai(),children:r(Di,{value:Li(),children:r(ki,{value:e,children:r(En,{children:r(nt,{tabName:$s()})})})})})}function zs(e){const t=Ve();return r(R,{...e,onClick:()=>t.logOut(),children:"Log Out"})}const Se=Ve;function ar({queue:e,screen:t}){const{current:n}=Sn(),{resort:i}=Se();return e.isAcceptingJoins||n.type!==t?null:r(Xn,{resort:i,time:e.nextScheduledOpenTime,label:"Next queue opening"})}const Hs=5e3;function Ws({queue:e,guests:t,result:n}){const{boardingGroup:i,conflicts:o}=n,s=i!==null,a=t.filter(p=>!(p.id in o)),l=t.filter(p=>p.id in o),{goBack:u}=M(),[h,c]=T(!1);return A(()=>{s&&setTimeout(()=>c(!0),Hs)},[s]),r(L,{heading:"Boarding Group",children:[r("h2",{children:e.name}),s?r(w,{children:[r("h3",{children:"Congratulations! \u{1F389}"}),r("p",{children:"You joined the virtual queue!"}),r("p",{className:"text-lg font-semibold",children:["Boarding Group: ",i]}),r(B,{guests:a}),Object.keys(o).length>0&&r(w,{children:[r("p",{className:"font-semibold",children:"These guests could not join:"}),r(B,{guests:l,conflicts:o})]}),r("p",{children:"Refer to the My Disney Experience app for return time and other information."}),h&&r(z,{onClick:()=>u({screen:rt}),children:"Done"})]}):r(w,{children:[r("h3",{children:"Sorry!"}),r("p",{children:"A boarding group could not be obtained. Go back and try again."}),r(B,{guests:l,conflicts:o})]})]})}function lr({queue:e,guests:t}){const{goTo:n}=M(),i=Se(),{loadData:o,loaderElem:s}=K();async function a(){await o(async l=>{if(!e||!(await i.getQueue(e)).isAcceptingJoins){l("Queue not open yet");return}const u=await i.joinQueue(e,t);n(r(Ws,{queue:e,guests:t,result:u}),{replace:!0}),u.boardingGroup!==null&&Yn()},{minLoadTime:999})}return r(L,{heading:"Join Virtual Queue",children:[r("h2",{children:e.name}),r(ar,{queue:e,screen:lr}),r("h3",{children:"Your Party"}),r(B,{guests:t}),r(z,{onClick:a,children:"Join Virtual Queue"}),s]})}function cr({queue:e}){const{goTo:t}=M(),n=Se(),{loadData:i,loaderElem:o,flash:s}=K(),[a,l]=T([]),[u,h]=T(new Set);A(()=>{i(async()=>{const p=await n.getLinkedGuests(e);l(p),h(new Set(p.filter(f=>f.preselected)))})},[e,n,i]);function c(p){const f=new Set(u);f[f.has(p)?"delete":"add"](p);const d=Number(e==null?void 0:e.maxPartySize);d>0&&f.size>d?s(`Maximum party size: ${d}`):(h(f),s(""))}return r(L,{heading:"Choose Your Party",children:[r("h2",{children:e.name}),e.howToEnterMessage.split(`

`).map((p,f)=>r("p",{children:p},f)),r(ar,{queue:e,screen:cr}),r("h3",{children:"Choose Your Party"}),a.length>0?r(B,{guests:a,selectable:{isSelected:p=>u.has(p),onToggle:c}}):r("p",{children:"No guests available"}),r(z,{disabled:u.size===0,onClick:()=>t(r(lr,{queue:e,guests:[...u]})),children:"Confirm Party"}),o]})}const Qt=e=>e.categoryContentId==="attraction",re=e=>e.isAcceptingPartyCreation||e.isAcceptingJoins;function rt(){const e=Se(),{goTo:t,goBack:n}=M(),i=G(),{loadData:o,loaderElem:s}=K(),[a,l]=T([]),[u,h]=T(!1),[,c]=T(),p=U(()=>{o(async()=>{const f=await e.getQueues();f.sort((d,m)=>+re(m)-+re(d)||+Qt(m)-+Qt(d)),l(f),c(d=>{if(!d)return d;const m=f.find(k=>k.id===d.id);if(m&&re(m))return d;c(void 0),n({screen:rt})}),h(!0)})},[e,n,o]);return A(()=>(p(),Qe(p)),[p]),r(L,{heading:"Virtual Queues",buttons:r(R,{title:"Refresh Queues",onClick:p,children:r(we,{})}),footer:r("div",{className:"p-2 text-right",children:r(zs,{className:`bg-opacity-90 bg-white ${i.text}`})}),children:[a.length>0?r("ul",{className:"mt-1",children:a.map(f=>r("li",{className:"py-3 first:border-0 border-t-4 border-gray-300",children:[r("h2",{className:"mt-0",children:f.name}),r("div",{className:"flex items-center mt-2",children:[r("div",{className:"flex-1",children:f.isAcceptingJoins?r("span",{children:"Available now"}):f.nextScheduledOpenTime?r(w,{children:["Next opening:"," ",r("time",{dateTime:f.nextScheduledOpenTime,className:"font-semibold",children:J(f.nextScheduledOpenTime)})]}):"No more openings today"}),r("div",{className:"pl-3",children:r(R,{disabled:!re(f),onClick:()=>{c(f),t(r(cr,{queue:f}))},children:re(f)?"Join Queue":"Closed"})})]})]},f.id))}):u&&!s?r("p",{className:"text-gray-500 font-semibold text-center uppercase",children:"No virtual queues found"}):null,s]})}function Fs(){return r(En,{children:r(rt,{})})}dr();function dr(){if(!document.body){setTimeout(dr,100);return}const e=new Ur("bg1.auth");ni(origin)?Jt(new ii({origin,authStore:e}),Fs,e):qr(origin)?je.load({origin,authStore:e}).then(t=>Jt(t,Us,e)):location.href="https://joelface.github.io/bg1/start.html"}async function Jt(e,t,n){$r({WDW:"America/New_York",DLR:"America/Los_Angeles"}[e.resort]),document.title="BG1",Vs(),js(),Ys().render(r(xi,{client:e,authStore:n,children:r(t,{})}))}function js(){document.body.addEventListener("click",()=>null)}function Vs(){const e=document.createElement("meta");e.name="viewport",e.content="width=device-width, initial-scale=1, maximum-scale=1",document.head.appendChild(e)}function Ys(){const e=document.createElement("div");return e.id="app",document.body.appendChild(e),Or(e)}
