var Ai=Object.defineProperty;var Di=(e,t,n)=>t in e?Ai(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var P=(e,t,n)=>(Di(e,typeof t!="symbol"?t+"":t,n),n);var _t=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)};var pe,b,un,X,gt,hn,Ue,pn,we={},fn=[],Li=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Ee=Array.isArray;function K(e,t){for(var n in t)e[n]=t[n];return e}function mn(e){var t=e.parentNode;t&&t.removeChild(e)}function ke(e,t,n){var r,o,s,a={};for(s in t)s=="key"?r=t[s]:s=="ref"?o=t[s]:a[s]=t[s];if(arguments.length>2&&(a.children=arguments.length>3?pe.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(s in e.defaultProps)a[s]===void 0&&(a[s]=e.defaultProps[s]);return ce(e,a,r,o,null)}function ce(e,t,n,r,o){var s={type:e,props:t,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:o??++un};return o==null&&b.vnode!=null&&b.vnode(s),s}function S(e){return e.children}function Q(e,t){this.props=e,this.context=t}function de(e,t){if(t==null)return e.__?de(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?de(e):null}function _n(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return _n(e)}}function Be(e){(!e.__d&&(e.__d=!0)&&X.push(e)&&!Ne.__r++||gt!==b.debounceRendering)&&((gt=b.debounceRendering)||hn)(Ne)}function Ne(){var e,t,n,r,o,s,a,c;for(X.sort(Ue);e=X.shift();)e.__d&&(t=X.length,r=void 0,o=void 0,a=(s=(n=e).__v).__e,(c=n.__P)&&(r=[],(o=K({},s)).__v=s.__v+1,qe(c,s,o,n.__n,c.ownerSVGElement!==void 0,s.__h!=null?[a]:null,r,a??de(s),s.__h),xn(r,s),s.__e!=a&&_n(s)),X.length>t&&X.sort(Ue));Ne.__r=0}function gn(e,t,n,r,o,s,a,c,d,u){var l,f,p,h,_,k,x,m=r&&r.__k||fn,I=m.length;for(n.__k=[],l=0;l<t.length;l++)if((h=n.__k[l]=(h=t[l])==null||typeof h=="boolean"||typeof h=="function"?null:typeof h=="string"||typeof h=="number"||typeof h=="bigint"?ce(null,h,null,null,h):Ee(h)?ce(S,{children:h},null,null,null):h.__b>0?ce(h.type,h.props,h.key,h.ref?h.ref:null,h.__v):h)!=null){if(h.__=n,h.__b=n.__b+1,(p=m[l])===null||p&&h.key==p.key&&h.type===p.type)m[l]=void 0;else for(f=0;f<I;f++){if((p=m[f])&&h.key==p.key&&h.type===p.type){m[f]=void 0;break}p=null}qe(e,h,p=p||we,o,s,a,c,d,u),_=h.__e,(f=h.ref)&&p.ref!=f&&(x||(x=[]),p.ref&&x.push(p.ref,null,h),x.push(f,h.__c||_,h)),_!=null?(k==null&&(k=_),typeof h.type=="function"&&h.__k===p.__k?h.__d=d=yn(h,d,e):d=vn(e,h,p,m,_,d),typeof n.type=="function"&&(n.__d=d)):d&&p.__e==d&&d.parentNode!=e&&(d=de(p))}for(n.__e=k,l=I;l--;)m[l]!=null&&(typeof n.type=="function"&&m[l].__e!=null&&m[l].__e==n.__d&&(n.__d=bn(r).nextSibling),kn(m[l],m[l]));if(x)for(l=0;l<x.length;l++)wn(x[l],x[++l],x[++l])}function yn(e,t,n){for(var r,o=e.__k,s=0;o&&s<o.length;s++)(r=o[s])&&(r.__=e,t=typeof r.type=="function"?yn(r,t,n):vn(n,r,r,o,r.__e,t));return t}function J(e,t){return t=t||[],e==null||typeof e=="boolean"||(Ee(e)?e.some(function(n){J(n,t)}):t.push(e)),t}function vn(e,t,n,r,o,s){var a,c,d;if(t.__d!==void 0)a=t.__d,t.__d=void 0;else if(n==null||o!=s||o.parentNode==null)e:if(s==null||s.parentNode!==e)e.appendChild(o),a=null;else{for(c=s,d=0;(c=c.nextSibling)&&d<r.length;d+=1)if(c==o)break e;e.insertBefore(o,s),a=s}return a!==void 0?a:o.nextSibling}function bn(e){var t,n,r;if(e.type==null||typeof e.type=="string")return e.__e;if(e.__k){for(t=e.__k.length-1;t>=0;t--)if((n=e.__k[t])&&(r=bn(n)))return r}return null}function Ri(e,t,n,r,o){var s;for(s in n)s==="children"||s==="key"||s in t||Se(e,s,null,n[s],r);for(s in t)o&&typeof t[s]!="function"||s==="children"||s==="key"||s==="value"||s==="checked"||n[s]===t[s]||Se(e,s,t[s],n[s],r)}function yt(e,t,n){t[0]==="-"?e.setProperty(t,n??""):e[t]=n==null?"":typeof n!="number"||Li.test(t)?n:n+"px"}function Se(e,t,n,r,o){var s;e:if(t==="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof r=="string"&&(e.style.cssText=r=""),r)for(t in r)n&&t in n||yt(e.style,t,"");if(n)for(t in n)r&&n[t]===r[t]||yt(e.style,t,n[t])}else if(t[0]==="o"&&t[1]==="n")s=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+s]=n,n?r||e.addEventListener(t,s?bt:vt,s):e.removeEventListener(t,s?bt:vt,s);else if(t!=="dangerouslySetInnerHTML"){if(o)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!=="width"&&t!=="height"&&t!=="href"&&t!=="list"&&t!=="form"&&t!=="tabIndex"&&t!=="download"&&t!=="rowSpan"&&t!=="colSpan"&&t in e)try{e[t]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&t[4]!=="-"?e.removeAttribute(t):e.setAttribute(t,n))}}function vt(e){return this.l[e.type+!1](b.event?b.event(e):e)}function bt(e){return this.l[e.type+!0](b.event?b.event(e):e)}function qe(e,t,n,r,o,s,a,c,d){var u,l,f,p,h,_,k,x,m,I,E,y,w,v,g,N=t.type;if(t.constructor!==void 0)return null;n.__h!=null&&(d=n.__h,c=t.__e=n.__e,t.__h=null,s=[c]),(u=b.__b)&&u(t);try{e:if(typeof N=="function"){if(x=t.props,m=(u=N.contextType)&&r[u.__c],I=u?m?m.props.value:u.__:r,n.__c?k=(l=t.__c=n.__c).__=l.__E:("prototype"in N&&N.prototype.render?t.__c=l=new N(x,I):(t.__c=l=new Q(x,I),l.constructor=N,l.render=Mi),m&&m.sub(l),l.props=x,l.state||(l.state={}),l.context=I,l.__n=r,f=l.__d=!0,l.__h=[],l._sb=[]),l.__s==null&&(l.__s=l.state),N.getDerivedStateFromProps!=null&&(l.__s==l.state&&(l.__s=K({},l.__s)),K(l.__s,N.getDerivedStateFromProps(x,l.__s))),p=l.props,h=l.state,l.__v=t,f)N.getDerivedStateFromProps==null&&l.componentWillMount!=null&&l.componentWillMount(),l.componentDidMount!=null&&l.__h.push(l.componentDidMount);else{if(N.getDerivedStateFromProps==null&&x!==p&&l.componentWillReceiveProps!=null&&l.componentWillReceiveProps(x,I),!l.__e&&l.shouldComponentUpdate!=null&&l.shouldComponentUpdate(x,l.__s,I)===!1||t.__v===n.__v){for(t.__v!==n.__v&&(l.props=x,l.state=l.__s,l.__d=!1),l.__e=!1,t.__e=n.__e,t.__k=n.__k,t.__k.forEach(function(R){R&&(R.__=t)}),E=0;E<l._sb.length;E++)l.__h.push(l._sb[E]);l._sb=[],l.__h.length&&a.push(l);break e}l.componentWillUpdate!=null&&l.componentWillUpdate(x,l.__s,I),l.componentDidUpdate!=null&&l.__h.push(function(){l.componentDidUpdate(p,h,_)})}if(l.context=I,l.props=x,l.__P=e,y=b.__r,w=0,"prototype"in N&&N.prototype.render){for(l.state=l.__s,l.__d=!1,y&&y(t),u=l.render(l.props,l.state,l.context),v=0;v<l._sb.length;v++)l.__h.push(l._sb[v]);l._sb=[]}else do l.__d=!1,y&&y(t),u=l.render(l.props,l.state,l.context),l.state=l.__s;while(l.__d&&++w<25);l.state=l.__s,l.getChildContext!=null&&(r=K(K({},r),l.getChildContext())),f||l.getSnapshotBeforeUpdate==null||(_=l.getSnapshotBeforeUpdate(p,h)),gn(e,Ee(g=u!=null&&u.type===S&&u.key==null?u.props.children:u)?g:[g],t,n,r,o,s,a,c,d),l.base=t.__e,t.__h=null,l.__h.length&&a.push(l),k&&(l.__E=l.__=null),l.__e=!1}else s==null&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=$i(n.__e,t,n,r,o,s,a,d);(u=b.diffed)&&u(t)}catch(R){t.__v=null,(d||s!=null)&&(t.__e=c,t.__h=!!d,s[s.indexOf(c)]=null),b.__e(R,t,n)}}function xn(e,t){b.__c&&b.__c(t,e),e.some(function(n){try{e=n.__h,n.__h=[],e.some(function(r){r.call(n)})}catch(r){b.__e(r,n.__v)}})}function $i(e,t,n,r,o,s,a,c){var d,u,l,f=n.props,p=t.props,h=t.type,_=0;if(h==="svg"&&(o=!0),s!=null){for(;_<s.length;_++)if((d=s[_])&&"setAttribute"in d==!!h&&(h?d.localName===h:d.nodeType===3)){e=d,s[_]=null;break}}if(e==null){if(h===null)return document.createTextNode(p);e=o?document.createElementNS("http://www.w3.org/2000/svg",h):document.createElement(h,p.is&&p),s=null,c=!1}if(h===null)f===p||c&&e.data===p||(e.data=p);else{if(s=s&&pe.call(e.childNodes),u=(f=n.props||we).dangerouslySetInnerHTML,l=p.dangerouslySetInnerHTML,!c){if(s!=null)for(f={},_=0;_<e.attributes.length;_++)f[e.attributes[_].name]=e.attributes[_].value;(l||u)&&(l&&(u&&l.__html==u.__html||l.__html===e.innerHTML)||(e.innerHTML=l&&l.__html||""))}if(Ri(e,p,f,o,c),l)t.__k=[];else if(gn(e,Ee(_=t.props.children)?_:[_],t,n,r,o&&h!=="foreignObject",s,a,s?s[0]:n.__k&&de(n,0),c),s!=null)for(_=s.length;_--;)s[_]!=null&&mn(s[_]);c||("value"in p&&(_=p.value)!==void 0&&(_!==e.value||h==="progress"&&!_||h==="option"&&_!==f.value)&&Se(e,"value",_,f.value,!1),"checked"in p&&(_=p.checked)!==void 0&&_!==e.checked&&Se(e,"checked",_,f.checked,!1))}return e}function wn(e,t,n){try{typeof e=="function"?e(t):e.current=t}catch(r){b.__e(r,n)}}function kn(e,t,n){var r,o;if(b.unmount&&b.unmount(e),(r=e.ref)&&(r.current&&r.current!==e.__e||wn(r,null,t)),(r=e.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(s){b.__e(s,t)}r.base=r.__P=null,e.__c=void 0}if(r=e.__k)for(o=0;o<r.length;o++)r[o]&&kn(r[o],t,n||typeof e.type!="function");n||e.__e==null||mn(e.__e),e.__=e.__e=e.__d=void 0}function Mi(e,t,n){return this.constructor(e,n)}function Nn(e,t,n){var r,o,s;b.__&&b.__(e,t),o=(r=typeof n=="function")?null:n&&n.__k||t.__k,s=[],qe(t,e=(!r&&n||t).__k=ke(S,null,[e]),o||we,we,t.ownerSVGElement!==void 0,!r&&n?[n]:o?null:t.firstChild?pe.call(t.childNodes):null,s,!r&&n?n:o?o.__e:t.firstChild,r),xn(s,e)}function Oi(e,t,n){var r,o,s,a,c=K({},e.props);for(s in e.type&&e.type.defaultProps&&(a=e.type.defaultProps),t)s=="key"?r=t[s]:s=="ref"?o=t[s]:c[s]=t[s]===void 0&&a!==void 0?a[s]:t[s];return arguments.length>2&&(c.children=arguments.length>3?pe.call(arguments,2):n),ce(e.type,c,r||e.key,o||e.ref,null)}function B(e,t){var n={__c:t="__cC"+pn++,__:e,Consumer:function(r,o){return r.children(o)},Provider:function(r){var o,s;return this.getChildContext||(o=[],(s={})[t]=this,this.getChildContext=function(){return s},this.shouldComponentUpdate=function(a){this.props.value!==a.value&&o.some(function(c){c.__e=!0,Be(c)})},this.sub=function(a){o.push(a);var c=a.componentWillUnmount;a.componentWillUnmount=function(){o.splice(o.indexOf(a),1),c&&c.call(a)}}),r.children}};return n.Provider.__=n.Consumer.contextType=n}pe=fn.slice,b={__e:function(e,t,n,r){for(var o,s,a;t=t.__;)if((o=t.__c)&&!o.__)try{if((s=o.constructor)&&s.getDerivedStateFromError!=null&&(o.setState(s.getDerivedStateFromError(e)),a=o.__d),o.componentDidCatch!=null&&(o.componentDidCatch(e,r||{}),a=o.__d),a)return o.__E=o}catch(c){e=c}throw e}},un=0,Q.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=K({},this.state),typeof e=="function"&&(e=e(K({},n),this.props)),e&&K(n,e),e!=null&&this.__v&&(t&&this._sb.push(t),Be(this))},Q.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),Be(this))},Q.prototype.render=S,X=[],hn=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Ue=function(e,t){return e.__v.__b-t.__v.__b},Ne.__r=0,pn=0;var ee,A,De,xt,ue=0,Sn=[],ye=[],wt=b.__b,kt=b.__r,Nt=b.diffed,St=b.__c,It=b.unmount;function fe(e,t){b.__h&&b.__h(A,e,ue||t),ue=0;var n=A.__H||(A.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({__V:ye}),n.__[e]}function T(e){return ue=1,Gi(En,e)}function Gi(e,t,n){var r=fe(ee++,2);if(r.t=e,!r.__c&&(r.__=[n?n(t):En(void 0,t),function(c){var d=r.__N?r.__N[0]:r.__[0],u=r.t(d,c);d!==u&&(r.__N=[u,r.__[1]],r.__c.setState({}))}],r.__c=A,!A.u)){var o=function(c,d,u){if(!r.__c.__H)return!0;var l=r.__c.__H.__.filter(function(p){return p.__c});if(l.every(function(p){return!p.__N}))return!s||s.call(this,c,d,u);var f=!1;return l.forEach(function(p){if(p.__N){var h=p.__[0];p.__=p.__N,p.__N=void 0,h!==p.__[0]&&(f=!0)}}),!(!f&&r.__c.props===c)&&(!s||s.call(this,c,d,u))};A.u=!0;var s=A.shouldComponentUpdate,a=A.componentWillUpdate;A.componentWillUpdate=function(c,d,u){if(this.__e){var l=s;s=void 0,o(c,d,u),s=l}a&&a.call(this,c,d,u)},A.shouldComponentUpdate=o}return r.__N||r.__}function C(e,t){var n=fe(ee++,3);!b.__s&&Xe(n.__H,t)&&(n.__=e,n.i=t,A.__H.__h.push(n))}function In(e,t){var n=fe(ee++,4);!b.__s&&Xe(n.__H,t)&&(n.__=e,n.i=t,A.__h.push(n))}function j(e){return ue=5,Ze(function(){return{current:e}},[])}function Ze(e,t){var n=fe(ee++,7);return Xe(n.__H,t)?(n.__V=e(),n.i=t,n.__h=e,n.__V):n.__}function W(e,t){return ue=8,Ze(function(){return e},t)}function z(e){var t=A.context[e.__c],n=fe(ee++,9);return n.c=e,t?(n.__==null&&(n.__=!0,t.sub(A)),t.props.value):e.__}function Ui(){for(var e;e=Sn.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(ve),e.__H.__h.forEach(ze),e.__H.__h=[]}catch(t){e.__H.__h=[],b.__e(t,e.__v)}}b.__b=function(e){A=null,wt&&wt(e)},b.__r=function(e){kt&&kt(e),ee=0;var t=(A=e.__c).__H;t&&(De===A?(t.__h=[],A.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.__V=ye,n.__N=n.i=void 0})):(t.__h.forEach(ve),t.__h.forEach(ze),t.__h=[],ee=0)),De=A},b.diffed=function(e){Nt&&Nt(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(Sn.push(t)!==1&&xt===b.requestAnimationFrame||((xt=b.requestAnimationFrame)||Bi)(Ui)),t.__H.__.forEach(function(n){n.i&&(n.__H=n.i),n.__V!==ye&&(n.__=n.__V),n.i=void 0,n.__V=ye})),De=A=null},b.__c=function(e,t){t.some(function(n){try{n.__h.forEach(ve),n.__h=n.__h.filter(function(r){return!r.__||ze(r)})}catch(r){t.some(function(o){o.__h&&(o.__h=[])}),t=[],b.__e(r,n.__v)}}),St&&St(e,t)},b.unmount=function(e){It&&It(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(r){try{ve(r)}catch(o){t=o}}),n.__H=void 0,t&&b.__e(t,n.__v))};var Et=typeof requestAnimationFrame=="function";function Bi(e){var t,n=function(){clearTimeout(r),Et&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);Et&&(t=requestAnimationFrame(n))}function ve(e){var t=A,n=e.__c;typeof n=="function"&&(e.__c=void 0,n()),A=t}function ze(e){var t=A;e.__c=e.__(),A=t}function Xe(e,t){return!e||e.length!==t.length||t.some(function(n,r){return n!==e[r]})}function En(e,t){return typeof t=="function"?t(e):t}function zi(e,t){for(var n in t)e[n]=t[n];return e}function Tt(e,t){for(var n in e)if(n!=="__source"&&!(n in t))return!0;for(var r in t)if(r!=="__source"&&e[r]!==t[r])return!0;return!1}function Ct(e){this.props=e}(Ct.prototype=new Q).isPureReactComponent=!0,Ct.prototype.shouldComponentUpdate=function(e,t){return Tt(this.props,e)||Tt(this.state,t)};var Pt=b.__b;b.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),Pt&&Pt(e)};var At=function(e,t){return e==null?null:J(J(e).map(t))},Hi={map:At,forEach:At,count:function(e){return e?J(e).length:0},only:function(e){var t=J(e);if(t.length!==1)throw"Children.only";return t[0]},toArray:J},Wi=b.__e;b.__e=function(e,t,n,r){if(e.then){for(var o,s=t;s=s.__;)if((o=s.__c)&&o.__c)return t.__e==null&&(t.__e=n.__e,t.__k=n.__k),o.__c(e,t)}Wi(e,t,n,r)};var Dt=b.unmount;function Tn(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach(function(r){typeof r.__c=="function"&&r.__c()}),e.__c.__H=null),(e=zi({},e)).__c!=null&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map(function(r){return Tn(r,t,n)})),e}function Cn(e,t,n){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map(function(r){return Cn(r,t,n)}),e.__c&&e.__c.__P===t&&(e.__e&&n.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=n)),e}function Le(){this.__u=0,this.t=null,this.__b=null}function Pn(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function _e(){this.u=null,this.o=null}b.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&e.__h===!0&&(e.type=null),Dt&&Dt(e)},(Le.prototype=new Q).__c=function(e,t){var n=t.__c,r=this;r.t==null&&(r.t=[]),r.t.push(n);var o=Pn(r.__v),s=!1,a=function(){s||(s=!0,n.__R=null,o?o(c):c())};n.__R=a;var c=function(){if(!--r.__u){if(r.state.__a){var u=r.state.__a;r.__v.__k[0]=Cn(u,u.__c.__P,u.__c.__O)}var l;for(r.setState({__a:r.__b=null});l=r.t.pop();)l.forceUpdate()}},d=t.__h===!0;r.__u++||d||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(a,a)},Le.prototype.componentWillUnmount=function(){this.t=[]},Le.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=Tn(this.__b,n,r.__O=r.__P)}this.__b=null}var o=t.__a&&ke(S,null,e.fallback);return o&&(o.__h=null),[ke(S,null,t.__a?null:e.children),o]};var Lt=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&(e.props.revealOrder[0]!=="t"||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};(_e.prototype=new Q).__a=function(e){var t=this,n=Pn(t.__v),r=t.o.get(e);return r[0]++,function(o){var s=function(){t.props.revealOrder?(r.push(o),Lt(t,e,r)):o()};n?n(s):s()}},_e.prototype.render=function(e){this.u=null,this.o=new Map;var t=J(e.children);e.revealOrder&&e.revealOrder[0]==="b"&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},_e.prototype.componentDidUpdate=_e.prototype.componentDidMount=function(){var e=this;this.o.forEach(function(t,n){Lt(e,n,t)})};var An=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,Fi=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,ji=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,Vi=/[A-Z0-9]/g,Yi=typeof document<"u",Ki=function(e){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(e)};function Qi(e,t,n){return t.__k==null&&(t.textContent=""),Nn(e,t),typeof n=="function"&&n(),e?e.__c:null}Q.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(e){Object.defineProperty(Q.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})});var Rt=b.event;function Ji(){}function qi(){return this.cancelBubble}function Zi(){return this.defaultPrevented}b.event=function(e){return Rt&&(e=Rt(e)),e.persist=Ji,e.isPropagationStopped=qi,e.isDefaultPrevented=Zi,e.nativeEvent=e};var Xi={enumerable:!1,configurable:!0,get:function(){return this.class}},$t=b.vnode;b.vnode=function(e){typeof e.type=="string"&&function(t){var n=t.props,r=t.type,o={};for(var s in n){var a=n[s];if(!(s==="value"&&"defaultValue"in n&&a==null||Yi&&s==="children"&&r==="noscript"||s==="class"||s==="className")){var c=s.toLowerCase();s==="defaultValue"&&"value"in n&&n.value==null?s="value":s==="download"&&a===!0?a="":c==="ondoubleclick"?s="ondblclick":c!=="onchange"||r!=="input"&&r!=="textarea"||Ki(n.type)?c==="onfocus"?s="onfocusin":c==="onblur"?s="onfocusout":ji.test(s)?s=c:r.indexOf("-")===-1&&Fi.test(s)?s=s.replace(Vi,"-$&").toLowerCase():a===null&&(a=void 0):c=s="oninput",c==="oninput"&&o[s=c]&&(s="oninputCapture"),o[s]=a}}r=="select"&&o.multiple&&Array.isArray(o.value)&&(o.value=J(n.children).forEach(function(d){d.props.selected=o.value.indexOf(d.props.value)!=-1})),r=="select"&&o.defaultValue!=null&&(o.value=J(n.children).forEach(function(d){d.props.selected=o.multiple?o.defaultValue.indexOf(d.props.value)!=-1:o.defaultValue==d.props.value})),n.class&&!n.className?(o.class=n.class,Object.defineProperty(o,"className",Xi)):(n.className&&!n.class||n.class&&n.className)&&(o.class=o.className=n.className),t.props=o}(e),e.$$typeof=An,$t&&$t(e)};var Mt=b.__r;b.__r=function(e){Mt&&Mt(e),e.__c};var Ot=b.diffed;b.diffed=function(e){Ot&&Ot(e);var t=e.props,n=e.__e;n!=null&&e.type==="textarea"&&"value"in t&&t.value!==n.value&&(n.value=t.value==null?"":t.value)};function Dn(e){return!!e&&e.$$typeof===An}function er(e){return Dn(e)?Oi.apply(null,arguments):e}function tr(e){return!!e.__k&&(Nn(null,e),!0)}var nr=0;function i(e,t,n,r,o,s){var a,c,d={};for(c in t)c=="ref"?a=t[c]:d[c]=t[c];var u={type:e,props:d,key:n,ref:a,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--nr,__source:o,__self:s};if(typeof e=="function"&&(a=e.defaultProps))for(c in a)d[c]===void 0&&(d[c]=a[c]);return b.vnode&&b.vnode(u),u}function ir(e){return{render(t){Qi(t,e)},unmount(){tr(e)}}}let Ln="America/New_York";function rr(e){Ln=e}function D(e){e=new Date(e||Date.now());const t={},n="2-digit";return Intl.DateTimeFormat("en-US",{timeZone:Ln,hourCycle:"h23",year:"numeric",month:n,day:n,hour:n,minute:n,second:n}).formatToParts(e).forEach(r=>t[r.type]=r.value),{date:`${t.year}-${t.month}-${t.day}`,time:`${t.hour}:${t.minute}:${t.second}`}}function sr(e){const t=new Date(e+"T00:00:00"),n=t.toLocaleString("en-US",{month:"long",day:"numeric"}),r=D().date;if(e===r)return`Today, ${n}`;const o=new Date(r);o.setDate(o.getDate()+1);const s=o.toISOString().split("T")[0];return e===s?`Tomorrow, ${n}`:`${t.toLocaleString("en-US",{weekday:"long"})}, ${n}`}function Z(e){const t=e.split(":").slice(0,2).map(Number),n=t[0]>=12?"PM":"AM";return t[0]=t[0]%12||12,t.map(r=>String(r).padStart(2,"0")).join(":").replace(/^0/,"")+" "+n}function He(e){const[t,n]=e.slice(0,19).split("T");return{date:t,time:n}}function Ie(e){const[t,n]=e.split(":").map(Number);return(t+17)%24*60+n}class Rn extends Error{constructor(n){super(`Auth data "${n}" missing or expired`);P(this,"name","ReauthNeeded")}}class or{constructor(t,n=localStorage){P(this,"onUnauthorized",()=>{});this.storageKey=t,this.storage=n}getData(){try{const t=this.storage.getItem(this.storageKey);if(t){const{swid:n,accessToken:r,expires:o}=JSON.parse(t),s=D(new Date(o)),a=D();if(s.date>a.date||s.date===a.date&&s.time>a.time&&s.time>="17")return{swid:n,accessToken:r}}}catch(t){console.error(t)}throw this.deleteData(),new Rn(this.storageKey)}setData(t){this.storage.setItem(this.storageKey,JSON.stringify(t))}deleteData(){this.storage.removeItem(this.storageKey),setTimeout(this.onUnauthorized)}}const ar=8e3;async function et(e,t={}){const{params:n,data:r,timeout:o=ar,...s}=t;t=s,t.referrer||(t.referrer=""),t.credentials||(t.credentials="omit"),t.cache||(t.cache="no-store"),t.headers={...t.headers||{}},n&&Object.keys(n).length>0&&(e+=(e.includes("?")?"&":"?")+Object.entries(n).filter(([,u])=>u!=="").map(u=>u.map(encodeURIComponent).join("=")).join("&")),r&&(t.method||(t.method="POST"),t.headers={...t.headers,"Content-Type":"application/json"},t.body=JSON.stringify(r)),t.method||(t.method="GET");const a=new AbortController;t.signal=a.signal;const c=setTimeout(()=>a.abort(),o);let d;try{d=await fetch(e,t)}catch(u){return console.error(u),{ok:!1,status:0,data:null}}finally{clearTimeout(c)}return{ok:d.ok,status:d.status,data:(d.headers.get("Content-Type")||"").startsWith("application/json")?await d.json():{}}}class $n extends Error{constructor(){super(...arguments);P(this,"name","InvalidOrigin")}}class ae extends Error{constructor(n,r="Request failed"){super(`${r}: ${JSON.stringify(n)}`);P(this,"name","RequestError");this.response=n}}class Te{constructor(t,n){P(this,"data");P(this,"authStore");P(this,"origin");this.data=t,this.origin=this.constructor.origins[this.data.resort],this.authStore=n}static originToResort(t){var o;const r=(o=Object.entries(this.origins).find(([,s])=>s===t))==null?void 0:o[0];if(r)return r;throw new $n(t)}logOut(){this.authStore.deleteData()}async request(t){const{swid:n,accessToken:r}=this.authStore.getData(),o=this.origin+t.path,s=await et(o,{method:t.method,params:t.params,data:t.data,headers:{"Accept-Language":"en-US",Authorization:`BEARER ${r}`,"x-user-id":n}});if(s.status===401)setTimeout(()=>this.authStore.deleteData());else{const{key:a}=t;if(s.ok&&(!a||s.data[a]))return{...s,data:a?s.data[a]:s.data}}throw new ae(s)}}P(Te,"origins",{WDW:"https://disneyworld.disney.go.com",DLR:"https://disneyland.disney.go.com"});const cr={48199:"Mr-Incredible",48200:"Mrs-Incredible",261227:"Nemo",339625:"Russell",339626:"Carl",364907:"Jack-Skellington",431014:"Princess-Tiana",431065:"Darth_Vader",15549505:"Rapunzel",15655408:"Default_SignedIn",15675686:"Crush",15831168:"Wall-E",16453979:"Merida",16726412:"Stormtrooper",16818199:"Violet",16869301:"Jack-Jack",17345357:"R2-D2",17345359:"C-3PO",17532220:"Bruce",17532224:"Green-Alien",17532227:"Kermit",17532228:"Sorcerer-Mickey",17577168:"Elsa",17577169:"Anna",17813977:"Olaf",17888784:"Yoda",18101167:"Captain-Mickey",18368743:"-Nick",18368747:"-Judy",18393706:"-Flash",18403761:"kion",18405224:"-Moana",18405236:"-Elena",19633995:"50th_Mickey",19633996:"50th_Minnie",90003819:"Alice",90003846:"Ariel",90003898:"Belle",90003967:"Buzz",90003976:"Captain-Hook",90004004:"Chesire-Cat",90004017:"Cinderella",90004068:"Daisy",90004076:"Dash",90004104:"Donald",90004228:"Goofy",90004260:"Hamm",90004328:"Princess-Jasmine",90004340:"Jiminy",90004395:"Lady",90004482:"Mickey-Mouse",90004486:"Minnie",90004537:"Mulan",90004605:"Peter-Pan",90004625:"Pluto",90004626:"Pocahontas",90004642:"Princess-Aurora",90004682:"Rex",90004772:"Snow-White",90004778:"Sparky",90004846:"TinkerBell",90004860:"Tramp",90004939:"Zero"},tt="https://cdn1.parksmedia.wdprapps.disney.com/resize/mwImage/1/90/90/75/dam/",lr=tt+"wdpro-assets/avatars/180x180/RetAvatar_180x180_",dr=tt+"wdpro-assets/avatars/180x180/RetAvatar-180x180",ur=tt+"disney-world/50th-anniversary/avatars/RetAvatar_180x180_",hr={"-":dr,5:ur};function be(e){const t=cr[e||""];if(t)return(hr[t[0]]||lr)+t+".png"}const se=e=>`/das-vas/api/v1/${e}`;function pr(e){return{id:e.id,name:e.name.replace(/ \(Me\)$/,""),avatarImageUrl:be(e.characterId),primary:e.primary}}class We extends Error{constructor(n){super();P(this,"name","ConflictsError");this.conflicts=n}}var Je;class fr extends Te{constructor(){super(...arguments);P(this,"bookingGuestId");_t(this,Je,void 0)}async experiences(n){const r=encodeURIComponent(n.id),{data:o}=await this.request({path:se(`availability/parks/${r}/experiences`),key:"experiences"});return o.map(s=>({...s,...this.data.experiences[s.id]})).filter(s=>!!s.nextAvailableTime).sort((s,a)=>s.name.localeCompare(a.name))}async parties(){const{swid:n}=this.authStore.getData(),{data:{bookingGuestId:r,parties:o}}=await this.request({path:se(`users/${encodeURIComponent(n)}/parties`)});return this.bookingGuestId=r,o.map(s=>[{...s.primaryGuest,primary:!0},...s.linkedGuests].map(pr))}async book({park:n,experience:r,guests:o}){var f,p;const s=await this.eligibility({park:n,experience:r,guests:o}),a=new Set((f=s.find(({type:h})=>h==="ELIGIBLE"))==null?void 0:f.guestIds);if(!o.every(h=>a.has(h.id)))throw new We(Object.fromEntries(s.filter(h=>h.type!=="ELIGIBLE").flatMap(h=>h.guestIds.map(_=>[_,h.type]))));const c=await this.availability({park:n,experience:r}),d=(p=o.find(h=>h.primary))==null?void 0:p.id,u=new Map(o.map(h=>[h.id,h])),{data:l}=await this.request({path:se("bookings"),key:"booking",data:{bookingGuestId:this.bookingGuestId,primaryGuestId:d,guestIds:o.map(h=>h.id),experienceId:r.id,startTime:c}});return{type:"DAS",subtype:"IN_PARK",id:r.id,name:r.name,park:n,guests:l.entitlements.map(h=>{const _=u.get(h.guestId);return{id:h.guestId,name:(_==null?void 0:_.name)??"",avatarImageUrl:_==null?void 0:_.avatarImageUrl,entitlementId:h.id}}),start:He(l.startDateTime),end:{},bookingId:l.id}}async cancelGuests(n){const o=n.map(s=>s.entitlementId).map(encodeURIComponent).join(",");await this.request({path:`/das-vas/api/v1/entitlements/${o}`,method:"DELETE"})}async eligibility({park:n,experience:r,guests:o}={}){const s=o.find(c=>!!c.primary);if(!s)throw new Error("Missing primary guest");const{data:a}=await this.request({path:se("eligibility"),params:{experienceId:r.id,parkId:n.id,primaryGuestId:s.id,guestIds:o.map(c=>c.id).join(",")},key:"eligibility"});return a}async availability({park:n,experience:r}){const o=encodeURIComponent(r.id),s=encodeURIComponent(n.id),{data:{available:a,nextAvailableTime:c}}=await this.request({path:se(`availability/parks/${s}/experiences/${o}`),key:"experience"});if(!a||!c)throw new Error("Experience not available");return c}}Je=new WeakMap;const mr="modulepreload",_r=function(e){return"/bg1/"+e},Gt={},Ut=function(t,n,r){if(!n||n.length===0)return t();const o=document.getElementsByTagName("link");return Promise.all(n.map(s=>{if(s=_r(s),s in Gt)return;Gt[s]=!0;const a=s.endsWith(".css"),c=a?'[rel="stylesheet"]':"";if(!!r)for(let l=o.length-1;l>=0;l--){const f=o[l];if(f.href===s&&(!a||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${c}`))return;const u=document.createElement("link");if(u.rel=a?"stylesheet":mr,a||(u.as="script",u.crossOrigin=""),u.href=s,document.head.appendChild(u),a)return new Promise((l,f)=>{u.addEventListener("load",l),u.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>t())},gr=(e,t)=>{const n=e[t];return n?typeof n=="function"?n():Promise.resolve(n):new Promise((r,o)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(o.bind(null,new Error("Unknown variable dynamic import: "+t)))})};async function yr(e){return{resort:e,...await gr(Object.assign({"./data/dlr.ts":()=>Ut(()=>import("./dlr.js"),[]),"./data/wdw.ts":()=>Ut(()=>import("./wdw.js"),[])}),`./data/${e.toLowerCase()}.ts`)}}const vr={WDW:"wdw-itinerary-api",DLR:"dlr-itinerary-web-api"},br=new Set(["ACTIVITY","DINING"]),ne=e=>e.split(";")[0];function Mn(e){const{date:t,time:n}=D();return e.modifiable&&t===e.end.date&&n<=(e.end.time??"")}class xr extends Error{constructor(){super(...arguments);P(this,"name","ModifyNotAllowed")}}function Bt(e){if(e&&!Mn(e))throw new xr}class zt extends Te{constructor(n,r,o){super(n,r);P(this,"maxPartySize",12);P(this,"nextBookTime");P(this,"onUnauthorized",()=>{});P(this,"partyIds",new Set);P(this,"guestCache",new Map);P(this,"tracker");P(this,"primaryGuestId","");P(this,"convertGuest",n=>{const{id:r,firstName:o,lastName:s,characterId:a,...c}=n,d=`${o} ${s}`.trim();if(!this.guestCache.has(r))switch(n.ineligibleReason){case"INVALID_PARK_ADMISSION":case"PARK_RESERVATION_NEEDED":case"GENIE_PLUS_NEEDED":n.primary&&this.cacheGuest(r,d,a);break;default:this.cacheGuest(r,d,a)}const u=be(a);return this.partyIds.size>0&&!this.partyIds.has(r)&&(c.ineligibleReason="NOT_IN_PARTY",delete c.eligibleAfter),{...c,id:r,name:d,avatarImageUrl:u}});this.tracker=o??new wr}setPartyIds(n){this.partyIds=new Set(n)}async experiences(n){var s,a;await this.primeGuestCache();const{data:r}=await this.request({path:`/tipboard-vas/api/v1/parks/${encodeURIComponent(n.id)}/experiences`,params:{eligibilityGuestIds:[...this.guestCache.keys()].join(",")}});this.nextBookTime=(a=(((s=r.eligibility)==null?void 0:s.flexEligibilityWindows)||[]).sort((c,d)=>c.time.time.localeCompare(d.time.time))[0])==null?void 0:a.time.time;const{experiences:o=[]}=this.upcomingDrops(n)[0]??{};return r.availableExperiences.filter(c=>{const d=this.data.experiences[c.id];return d?!0:(d!==null&&console.warn(`Missing experience: ${c.id}`),!1)}).map(c=>({...c,...this.data.experiences[c.id],park:n,experienced:this.tracker.experienced(c),drop:!!o.find(({id:d})=>d===c.id)}))}async guests(n){n||(n={id:"0",park:{id:"0"}});const{data:r}=await this.request({path:"/ea-vas/api/v1/guests",params:{productType:"FLEX",experienceId:n.id,parkId:n.park.id}});this.primaryGuestId=r.primaryGuestId;const o=r.ineligibleGuests.map(this.convertGuest),s=r.guests.map(this.convertGuest).filter(a=>!("ineligibleReason"in a)||o.push(a)&&!1);return o.sort((a,c)=>{const d=+!a.primary-+!c.primary||a.name.localeCompare(c.name);return a.eligibleAfter||c.eligibleAfter?(a.eligibleAfter||"99").localeCompare(c.eligibleAfter||"99")||d:a.ineligibleReason===c.ineligibleReason?d:a.ineligibleReason==="NOT_IN_PARTY"?1:c.ineligibleReason==="NOT_IN_PARTY"||a.ineligibleReason==="EXPERIENCE_LIMIT_REACHED"?-1:c.ineligibleReason==="EXPERIENCE_LIMIT_REACHED"?1:d}),{eligible:s,ineligible:o}}async offer(n,r,o){Bt(o);const{data:{offer:{id:s,date:a,startTime:c,endTime:d,status:u,changeStatus:l},eligibleGuests:f,ineligibleGuests:p}}=await this.request({path:o?"/ea-vas/api/v1/products/modifications/flex/offers":"/ea-vas/api/v2/products/flex/offers",method:"POST",data:{guestIds:((o==null?void 0:o.guests)??r).map(h=>h.id),ineligibleGuests:[],primaryGuestId:r.map(h=>h.id).sort((h,_)=>h.localeCompare(_))[0],parkId:n.park.id,experienceId:n.id,selectedTime:n.flex.nextAvailableTime,...o?{date:D().date,modificationType:n.id===o.id?"TIME":"EXPERIENCE"}:{}},userId:!1});return{id:s,start:{date:a,time:c},end:{date:a,time:d},active:u==="ACTIVE",changed:l!=="NONE",guests:{eligible:(f||[]).map(this.convertGuest),ineligible:(p||[]).map(this.convertGuest)},experience:n}}async book(n,r,o){var p;Bt(r);const s=new Set((o??n.guests.eligible).map(h=>h.id)),{data:a}=await this.request({path:r?"/ea-vas/api/v1/products/modifications/flex/bookings":"/ea-vas/api/v1/products/flex/bookings",method:"POST",userId:!1,data:{offerId:n.id,...r?{date:D().date,modificationType:r.id===n.experience.id?"TIME":"EXPERIENCE",existingEntitlements:r.guests.filter(h=>s.has(h.id)).map(h=>({entitlementId:h.entitlementId,entitlementBookingId:h.bookingId})),guestIdsToExclude:r.guests.filter(h=>!s.has(h.id)).map(h=>h.id)}:{}},key:"booking"}),{singleExperienceDetails:{experienceId:c,parkId:d},entitlements:u,startDateTime:l,endDateTime:f}=a;return{type:"LL",subtype:"G+",...this.getExperience(c,d),bookingId:(p=u[0])==null?void 0:p.id,start:He(l),end:He(f),cancellable:!0,modifiable:!1,guests:u.map(h=>{const _=this.guestCache.get(h.guestId);return{id:h.guestId,name:(_==null?void 0:_.name)||"",avatarImageUrl:be(_==null?void 0:_.characterId),entitlementId:h.id}})}}async cancelGuests(n){const o=n.map(s=>s.entitlementId).map(encodeURIComponent).join(",");await this.request({path:`/ea-vas/api/v1/entitlements/${o}`,method:"DELETE",userId:!1})}async bookings(){const{swid:n}=this.authStore.getData(),r=D().date,o=vr[this.data.resort],{data:{items:s=[],assets:a={},profiles:c={}}}=await this.request({path:`/plan/${o}/api/v1/itinerary-items/${n}?item-types=FASTPASS&item-types=DINING&item-types=ACTIVITY&item-types=VIRTUAL_QUEUE_POSITION`,params:{destination:this.data.resort,fields:"items,profiles,assets","guest-locators":n+";type=swid","guest-locator-groups":"MY_FAMILY","start-date":r,"show-friends":"false"},userId:!1}),d=m=>{const{name:I,avatarId:E,type:y}=c[m.id];return{id:ne(m.id),name:`${I.firstName} ${I.lastName}`.trim(),avatarImageUrl:be(E),...y==="transactional"&&{transactional:!0}}},u=m=>{const I=a[m.asset],y=a[I.facility].location;if(!y)return;const w=this.data.parks.get(ne(y))||{id:y,name:a[y].name},v=new Date(m.startDateTime);return{type:"RES",subtype:m.type,id:ne(m.asset),park:w,name:I.name,start:D(v),guests:m.guests.map(d).sort((N,R)=>+(R.id===this.primaryGuestId)-+(N.id===this.primaryGuestId)||+!R.transactional-+!N.transactional||N.name.localeCompare(R.name)),bookingId:m.id}},l=m=>{const I=a[m.facility];return{...this.getExperience(m.facility,I.location,I.name),start:{date:m.displayStartDate??r,time:m.displayStartTime},end:{date:m.displayEndDate,time:m.displayEndTime},guests:m.guests.map(E=>({...d(E),entitlementId:E.entitlementId,bookingId:E.bookingId,...E.redemptionsRemaining!==void 0&&{redemptions:E.redemptionsRemaining}})),bookingId:m.id}},f=m=>{const I={FLEX:"G+",STANDARD:"ILL",OTHER:"OTHER"},E=m.multipleExperiences?"MEP":I[m.kind];if(!E)return;const y=E==="G+";let w={type:"LL",subtype:E,...l(m),cancellable:m.cancellable&&y,modifiable:m.modifiable&&y,bookingId:m.id};if(w.modifiable=Mn(w),m.multipleExperiences){const v=m.assets.find(g=>g.original);v&&(w={...w,...this.getExperience(v.content,a[v.content].location)}),w.choices=m.assets.filter(g=>!g.excluded&&!g.original).map(({content:g})=>{const{name:N,location:R}=a[g];return this.getExperience(g,R,N)}).sort((g,N)=>g.name.localeCompare(N.name))}return w},p=m=>{const E={DAS:"IN_PARK",FDS:"ADVANCE"}[m.kind],y=E==="IN_PARK";return{type:"DAS",subtype:E,cancellable:m.cancellable&&y,...l(m)}},h=m=>{const I=a[m.asset],E=a[I.facility];return{type:"BG",...this.getExperience(I.facility,E.location,I.name),boardingGroup:m.boardingGroup.id,status:m.status,start:D(new Date(m.startDateTime)),guests:m.guests.map(d),bookingId:m.id}},k={PARK_PASS:m=>{const I=this.data.parks.get(ne(a[m.facility].location));if(I)return{type:"APR",id:I.id,name:I.name,park:I,start:D(new Date(m.startDateTime)),guests:m.guests.map(d),bookingId:m.id}},DAS:p,FDS:p},x=s.map(m=>{try{if(m.type==="FASTPASS")return(k[m.kind]??f)(m);if(m.type==="VIRTUAL_QUEUE_POSITION")return h(m);if(m.type&&br.has(m.type))return u(m)}catch(I){console.error(I)}}).filter(m=>!!m);return this.tracker.update(x,this),x}upcomingDrops(n){const r=D().time.slice(0,5),o=this.data.drops[n.id]??[],s=o.findIndex(({time:a})=>a>=r);return s>=0?o.slice(s):[]}nextDropTime(n){var r;return(r=this.upcomingDrops(n)[0])==null?void 0:r.time}getExperience(n,r,o){var s;return n=ne(n),{id:n,name:((s=this.data.experiences[n])==null?void 0:s.name)||o,park:this.data.parks.get(ne(r))}}async primeGuestCache(){this.primaryGuestId===""&&(this.primaryGuestId=".",await this.guests())}cacheGuest(n,r,o){this.guestCache.set(n,{name:r,characterId:o})}async request(n){if(n.userId??!0){const{swid:r}=this.authStore.getData();n={...n},n.params={...n.params,userId:r}}return super.request(n)}}const Ht="bg1.genie.bookings";class wr{constructor(){P(this,"date");P(this,"expIds",new Set);P(this,"experiencedExpIds",new Set);const{date:t=D().date,expIds:n=[],experiencedExpIds:r=[]}=JSON.parse(localStorage.getItem(Ht)||"{}");this.date=t,this.expIds=new Set(n),this.experiencedExpIds=new Set(r),this.checkDate()}experienced(t){return this.experiencedExpIds.has(t.id)}async update(t,n){this.checkDate();const r=t.filter(s=>s.type==="LL"&&!!s.cancellable);for(const s of r)this.experiencedExpIds[s.modifiable?"delete":"add"](s.id);const o=this.expIds;this.expIds=new Set(r.map(s=>s.id));for(const s of o){if(this.expIds.has(s))continue;const{ineligible:a}=await n.guests({id:s,park:{id:"0"}}),c=a.some(d=>d.ineligibleReason==="EXPERIENCE_LIMIT_REACHED");this.experiencedExpIds[c?"add":"delete"](s)}localStorage.setItem(Ht,JSON.stringify({date:this.date,expIds:[...this.expIds],experiencedExpIds:[...this.experiencedExpIds]}))}checkDate(){const t=D().date;this.date!==t&&(this.date=t,this.expIds=new Set,this.experiencedExpIds=new Set)}}const kr=e=>e.sort((t,n)=>+n.primary-+t.primary||+n.preselected-+t.preselected||t.name.localeCompare(n.name)),Wt=e=>`/application/v1/guest/${e}`;class Fe extends Te{async getQueues(){var n;const t=await et(this.origin+Wt("getQueues"));if(!Array.isArray((n=t.data)==null?void 0:n.queues))throw new ae(t);return t.data.queues.filter(r=>!!r.categoryContentId).map(({queueId:r,tabContentId:o="",...s})=>({...s,id:r,park:this.data.parks.get(o.split(";")[0])}))}async getQueue(t){const n=(await this.getQueues()).find(r=>r.id===t.id);if(n)return n;throw new Error("Queue not Found")}async getLinkedGuests(t){const{data:n}=await this.post({resource:"getLinkedGuests",data:{queueId:t.id}});return kr(n.guests.map(({guestId:r,firstName:o,lastName:s,isPrimaryGuest:a,isPreselected:c,...d})=>({...d,id:r,name:`${o} ${s}`.trim(),primary:!!a,preselected:!!c})))}async joinQueue(t,n){const r=n.map(a=>a.id),o=await this.post({resource:"joinQueue",data:{queueId:t.id,guestIds:r}}),{data:s}=o;if(s.responseStatus==="OK"){const a=s.positions.find(c=>c.queueId===t.id&&c.guestIds.length>0&&r.some(d=>c.guestIds.includes(d)));if(!a)throw new ae(o);return{boardingGroup:a.boardingGroup,conflicts:{},closed:!1}}else if(s.responseStatus==="INVALID_GUEST"||s.responseStatus==="CLOSED_QUEUE"){const a=s.responseStatus==="CLOSED_QUEUE",c=new Set,d={};for(const f of s.conflicts)for(const p of f.guestIds){const h=n.find(_=>_.id===p);h&&(d[h.id]=f.conflictType,c.add(p))}const u=n.filter(f=>!c.has(f.id));if(a||u.length===0)return{boardingGroup:null,conflicts:d,closed:a};const l=await this.joinQueue(t,u);return l.conflicts={...d,...l.conflicts},l}else throw new ae(o)}async post(t){try{return await this.request({...t,method:"POST",path:Wt(t.resource)})}catch(n){if(n instanceof ae){const r=n.response,{ok:o,status:s}=r;if(!o&&s<500&&s!==401)return r}throw n}}}P(Fe,"origins",{WDW:"https://vqguest-svc-wdw.wdprapps.disney.com",DLR:"https://vqguest-svc.wdprapps.disney.com"});const On=B({}),Nr=On.Provider,Ce=()=>z(On),Gn=B({}),Sr=Gn.Provider,F=()=>z(Gn),Un=B({resort:"WDW",parks:new Map,experiences:{},drops:{}}),Ir=Un.Provider,me=()=>z(Un),Bn=B({}),Er=Bn.Provider,nt=()=>z(Bn),zn=B({goTo:()=>{},goBack:async()=>{}}),Tr=zn.Provider,$=()=>z(zn),Hn=B({current:i("div",{})}),Cr=Hn.Provider,it=()=>z(Hn);let Pr=0;const Ft=()=>++Pr,ge=()=>Number(location.hash.slice(1))||0;let je=()=>{};const Ar=()=>new Promise(e=>{je=()=>{e(),je=()=>{}}});function Wn({children:e}){const[t,n]=T({current:e}),r=j([{elem:e,key:0}]),o=j({goTo(a,c){let d=ge(),u;c!=null&&c.replace?(u=r.current[d].key??Ft(),n(l=>({...l,current:a}))):(r.current=r.current.slice(0,++d),location.hash=`#${d}`,u=Ft()),r.current[d]={elem:a,key:u}},goBack({screen:a,props:c}={}){if(a){const d=ge();for(let u=d-1;u>=0;--u)if(r.current[u].elem.type===a){if(history.go(u-d),c){const l={...r.current[u].elem.props,...c};r.current[u].elem=i(a,{...l})}break}}else history.back();return Ar()}});C(()=>{function a(){var u,l;je();const d=ge();d>=r.current.length?history.back():n({current:((u=r.current[d])==null?void 0:u.elem)??i("div",{}),prev:(l=r.current[d-1])==null?void 0:l.elem})}function c(d){d.preventDefault()}return location.replace("#0"),addEventListener("hashchange",a),addEventListener("beforeunload",c),()=>{removeEventListener("hashchange",a),removeEventListener("beforeunload",c)}},[]);const s=Math.min(ge(),r.current.length-1);return i(Tr,{value:o.current,children:i(Cr,{value:t,children:r.current.slice(0,s+1).map(({elem:a,key:c},d)=>i("article",{hidden:d!==s,children:a},c))})})}const rt={bg:"bg-blue-500",text:"text-blue-500"},Fn=B(rt),jn=Fn.Provider,G=()=>z(Fn),Dr={normal:"py-1",small:"py-1.5 text-xs uppercase tracking-wide",full:"w-full py-3"};function L(e){const{goBack:t}=$(),{type:n,back:r,onClick:o,className:s,...a}=e;let c=`${Dr[n||"normal"]} ${s||""}`;const{bg:d}=G();return c.includes(" bg-")||(c+=` ${d} text-white`),i("button",{onClick:async()=>{o&&await o(),r&&(r===!0?t():t(r))},className:`${c} inline-flex items-center justify-center min-w-[36px] rounded-lg px-2 font-semibold disabled:opacity-50`,...a})}function H(e){return i("div",{className:"mb-20",children:i("div",{className:"fixed bottom-0 left-0 w-full px-5 pb-5 text-center",children:i(L,{...e,className:"max-w-2xl mx-auto shadow-[0px_4px_8px_-1px_#0005]",type:"full"})})})}function U({children:e,className:t,title:n}){return t||(t=""),t.match(/\bw-\S+\s*/)||(t+=" w-4"),t.match(/\bh-\S+\s*/)||(t+=" h-auto"),i("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 16 16",className:`mx-auto ${t}`,role:"img",children:[n&&i("title",{children:n}),e]})}/**
 * Modified arrow-left2 icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function Lr(e){return i(U,{...e,children:i("path",{d:"M0.293,7.337L7.333,0.297C7.723,-0.093 8.357,-0.093 8.747,0.297C9.137,0.687 9.137,1.321 8.747,1.711L3.414,7.044L15,7.044C15.552,7.044 16,7.492 16,8.044C16,8.596 15.552,9.044 15,9.044L3.414,9.044L8.747,14.377C9.137,14.767 9.137,15.401 8.747,15.791C8.357,16.181 7.723,16.181 7.333,15.791L0.293,8.751C0.102,8.561 0,8.307 0,8.044C0,7.781 0.102,7.527 0.293,7.337Z"})})}function Rr({title:e,children:t}){const{prev:n}=it(),{bg:r,text:o}=G();function s(a){return!Dn(a)||typeof a.type=="string"?a:a.type===S?Hi.map(a.props.children,s):er(a,{className:`bg-white bg-opacity-90 ${o} ${a.props.className||""}`})}return i("div",{className:`flex justify-end gap-x-2 gap-y-1 min-h-[52px] px-3 py-2 text-lg text-white ${r}`,children:[!!n&&i(L,{back:!0,className:"-my-2 -ml-3",title:"Go Back",children:i(Lr,{})}),i("h1",{className:"flex-1 self-center py-0.5 text-xl font-semibold overflow-hidden whitespace-nowrap",children:e}),s(t)]})}function M({heading:e,buttons:t,footer:n,theme:r,children:o,contentRef:s}){const a=G();return r??(r=a),i(jn,{value:r,children:i("div",{className:"fixed inset-0 flex flex-col",children:[i(Rr,{title:e,children:t}),i("div",{ref:s,className:"relative flex-1 overflow-auto px-3 pb-3",children:o}),n&&i("div",{className:`relative ${r.bg} text-white font-semibold`,children:n})]})})}const jt="bg1.disclaimer.accepted",$r={bg:"bg-red-600",text:"text-red-600"};function Mr(){const[e,t]=T(!!localStorage.getItem(jt));return e?null:i(Or,{onAccept:()=>{localStorage.setItem(jt,"1"),t(!0)}})}function Or({onAccept:e}){return i(M,{heading:"Warning!",theme:$r,children:[i("p",{children:'Use at your own risk. BG1 is highly experimental, for demonstration purposes only, and provided "as is" without warranty of any kind. It is in no way endorsed by or associated with the Walt Disney Company and could stop working at any time for any reason. To ensure the intended experience, always use the official Disney app.'}),i(H,{onClick:e,children:"Accept"})]})}function Vn(){return i(M,{heading:"BG1 News",children:i("iframe",{src:"https://joelface.github.io/bg1/news.html",className:"absolute inset-0 w-full h-full"})})}const Vt="bg1.news.version";function Gr(e){const[t,n]=T(()=>{const r=Number(localStorage.getItem(Vt));return Number.isInteger(r)?r:0});return t<e?i(S,{children:[i(Vn,{}),i(H,{onClick:()=>{localStorage.setItem(Vt,String(e)),n(e)},children:"Close"})]}):null}function st(e){const t=()=>{document.hidden||e()};return document.addEventListener("visibilitychange",t),()=>{document.removeEventListener("visibilitychange",t)}}const Ur="181874e5af6";function Br(e){return"deferredUuid"in e&&e.deferredUuid!==void 0}class zr{constructor(t,n,r,o=!1){P(this,"handlers",{});P(this,"handshakeAcked",!1);P(this,"onMessage",t=>{if(t.source!==this.iframe.contentWindow||t.data==="inner.loaded")return;const n=JSON.parse(t.data);this.logging&&console.log("Message:",n);const r=n.type==="message"?n.eventName:n.type,o=this.handlers[r],s=o?o("data"in n?n.data:null):void 0;Br(n)&&this.send({type:"deferred",action:"resolve",deferredUuid:n.deferredUuid,data:s??{}})});this.iframe=t,this.resort=r,this.logging=o,this.on("handshake",()=>{this.handshakeAcked||(this.handshakeAcked=!0,this.send({type:"handshakeAck"}),this.logging&&this.sendMessage("setLogLevel",{level:"log"}),this.sendMessage("workflow.execute",{name:"login"}))}),this.on("lightbox.hide",()=>this.open()),this.on("session.dateOfBirth.read",()=>this.open()),this.on("session.loggedin",({token:s})=>{n({swid:s.swid,accessToken:s.access_token,expires:new Date(s.exp)})})}open(){addEventListener("message",this.onMessage),this.iframe.src=this.authPageUrl,this.handshakeAcked=!1}close(){removeEventListener("message",this.onMessage)}on(t,n){this.handlers[t]=n}sendMessage(t,n){this.send({type:"message",eventName:t,data:n})}send(t){var n;(n=this.iframe.contentWindow)==null||n.postMessage(JSON.stringify({...t,name:"lightbox-client-window"}),this.authPageUrl)}get authPageUrl(){return`https://cdn.registerdisney.go.com/v2/TPR-${this.resort}-LBSDK.IOS-PROD/en-US?include=l10n,config,html,js&buildId=${Ur}`}}function Hr({resort:e,onLogin:t}){const n=j(null);return C(()=>{if(!n.current)return;const r=new zr(n.current,t,e);return r.open(),()=>r.close()},[e,t,n]),i("iframe",{title:"Disney Login Form",ref:n,className:"fixed top-0 left-0 w-full h-full border-0"})}const Yn=B([]),Wr=Yn.Provider,Kn=()=>z(Yn);function Fr(){const e=Ce(),[t,n]=T([]);return C(()=>{e.parties().then(n)},[e]),t}const Yt="bg1.genie.park",Qn=B({park:{},setPark:()=>{}}),jr=({value:e,children:t})=>i(Qn.Provider,{value:e,children:t}),V=()=>z(Qn);function Vr(){const{parks:e}=me(),[t,n]=T(()=>{const r=[...e.values()][0],{id:o=r.id,date:s=""}=JSON.parse(sessionStorage.getItem(Yt)||"{}")||{};return s===D().date&&e.get(o)||r});return C(()=>{sessionStorage.setItem(Yt,JSON.stringify({id:t.id,date:D().date}))},[t]),{park:t,setPark:n}}/**
 * Refresh icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function ot({className:e}){return i(U,{className:e,children:i("path",{d:"M16 6h-6l2.243-2.243c-1.133-1.133-2.64-1.757-4.243-1.757s-3.109 0.624-4.243 1.757c-1.133 1.133-1.757 2.64-1.757 4.243s0.624 3.109 1.757 4.243c1.133 1.133 2.64 1.757 4.243 1.757s3.109-0.624 4.243-1.757c0.095-0.095 0.185-0.192 0.273-0.292l1.505 1.317c-1.466 1.674-3.62 2.732-6.020 2.732-4.418 0-8-3.582-8-8s3.582-8 8-8c2.209 0 4.209 0.896 5.656 2.344l2.343-2.344v6z"})})}function at(e){const{children:t,color:n="bg-black",className:r="",...o}=e;return i("div",{className:`fixed inset-0 z-10 flex items-center justify-center p-2 ${n} bg-opacity-75 ${r}`,...o,children:t})}function Jn(){const{bg:e}=G();return i(at,{color:"bg-white",children:i("div",{className:"w-[50px] mx-auto",children:i("div",{"aria-label":"Loading\u2026",className:`rounded-full p-[20%] ${e}`,children:i(ot,{className:"animate-spin w-full text-white"})})})})}const Yr=3e3,Kr={alert:"bg-yellow-200",error:"bg-red-200"};function qn(){const[,e]=T(0),[t,n]=T(""),[r,o]=T("alert"),s=W((c,d)=>{n(c),o(d||"alert"),e(u=>(clearTimeout(u),c?self.setTimeout(()=>{n("")},Yr):u))},[]);return[t?i(Qr,{message:t,type:r}):null,s]}function Qr({message:e,type:t}){return e?i("div",{role:"alert",className:`fixed bottom-20 left-0 w-full p-2 font-semibold text-center ${Kr[t]} text-gray-800`,children:e}):null}async function Kt(e){return new Promise(t=>{setTimeout(t,e)})}const Jr=500;function Y(){const[e,t]=T(0),[n,r]=qn(),o=W(async(a,c={})=>{var k;const{messages:d={},minLoadTime:u=Jr}=c,l={error:"Unknown error occurred",request:"Network request failed",...d};r("");let f=()=>null;const p=new Promise(x=>{f=()=>x(null)});async function h(...x){await p,r(...x)}t(x=>x+1);const _=Kt(u);try{await a(h)}catch(x){const m=(k=x==null?void 0:x.response)==null?void 0:k.status;l[x.name]!==void 0?h(l[x.name],"error"):Number.isInteger(m)?h(m in l?l[m]:l.request,"error"):(console.error(x),h(l.error,"error"))}await _,await Kt(0),t(x=>x-1),f()},[r]),s=e>0||n?i(S,{children:[e>0&&i(Jn,{}),n]}):null;return{loadData:o,loaderElem:s,flash:r}}function Zn(e){const[,t]=T(0);return W((n=0)=>{t(r=>Date.now()-r<n?r:(e(),Date.now()))},[e])}const Xn=B({plans:[],refreshPlans:()=>{},loaderElem:null}),qr=Xn.Provider,re=()=>z(Xn);function Zr(){const e=F(),{loadData:t,loaderElem:n}=Y(),[r,o]=T([]),s=Zn(W(()=>{t(async()=>{o(await e.bookings())})},[e,t]));return C(s,[s]),{plans:r,refreshPlans:s,loaderElem:n}}const ei=B({current:void 0,begin:()=>{},end:()=>{}}),Xr=ei.Provider,te=()=>z(ei),es=()=>{const[e,t]=T({current:void 0,begin:n=>{t({...e,current:n})},end:()=>{t(n=>n.current?{...n,current:void 0}:n)}});return e},ti=B({tabs:[],active:{name:"",icon:i("div",{}),component:()=>null},changeTab:()=>{},scrollPos:{get:()=>0,set:()=>{}}}),ni=()=>z(ti);function ts({name:e,icon:t}){const n=G(),{active:r,changeTab:o}=ni();if(!o)return null;const a=(r==null?void 0:r.name)===e?`bg-white bg-opacity-90 ${n.text}`:`${n.bg} text-white`;return i("button",{className:"px-4 py-2",onClick:()=>o(e),children:[i("div",{className:`min-w-[3rem] rounded-full py-1.5 ${a}`,children:t}),i("div",{className:"mt-0.5 text-sm",children:e})]})}function ct({heading:e,buttons:t,children:n,contentRef:r}){const{tabs:o,scrollPos:s,footer:a}=ni();let c=j(null);return r&&(c=r),In(()=>{const d=c.current;if(!d)return;d.scroll(0,s.get());const u=()=>s.set(d.scrollTop);return d.addEventListener("scroll",u),()=>d.removeEventListener("scroll",u)},[s]),i(M,{heading:e,buttons:t,footer:i(S,{children:[i("div",{className:"flex items-center justify-center",children:o.map(d=>ke(ts,{...d,key:d.name}))}),a]}),contentRef:c,children:n})}function ns({tabs:e,footer:t},n){return function r({tabName:o}){const{goTo:s}=$(),a=W(u=>{u!==o&&s(i(r,{tabName:u}),{replace:!0})},[o,s]),c=j(Object.fromEntries(e.map(u=>[u.name,0]))),d=e.find(({name:u})=>u===o);return d?i(ti.Provider,{value:{tabs:e,active:d,changeTab:a,scrollPos:{get:()=>c.current[d.name],set:u=>{c.current[d.name]=u}},footer:t},children:i(n,{tab:d})}):null}}const ii=B({experiences:[],refreshExperiences:()=>{},loaderElem:null}),is=ii.Provider,lt=()=>z(ii);function rs(){const e=F(),{park:t}=V(),{loadData:n,loaderElem:r}=Y(),[o,s]=T([]),a=Zn(W(()=>{n(async()=>{s(await e.experiences(t))})},[t,e,n]));return C(a,[a]),C(()=>s([]),[t]),{experiences:o,refreshExperiences:a,loaderElem:r}}/**
 * Calendar icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function ri({className:e}){return i(U,{className:e,children:i("path",{d:"M5 6h2v2h-2zM8 6h2v2h-2zM11 6h2v2h-2zM2 12h2v2h-2zM5 12h2v2h-2zM8 12h2v2h-2zM5 9h2v2h-2zM8 9h2v2h-2zM11 9h2v2h-2zM2 9h2v2h-2zM13 0v1h-2v-1h-7v1h-2v-1h-2v16h15v-16h-2zM14 15h-13v-11h13v11z"})})}/**
 * Clock icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function ss(e){return i(U,{...e,children:i("path",{d:"M10.293 11.707l-3.293-3.293v-4.414h2v3.586l2.707 2.707zM8 0c-4.418 0-8 3.582-8 8s3.582 8 8 8 8-3.582 8-8-3.582-8-8-8zM8 14c-3.314 0-6-2.686-6-6s2.686-6 6-6c3.314 0 6 2.686 6 6s-2.686 6-6 6z"})})}/**
 * Power icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function Ve(e){return i(U,{...e,children:i("path",{d:"M6 0l-6 8h6l-4 8 14-10h-8l6-6z"})})}/**
 * Checkmark icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function Qt({className:e}){return i(U,{className:e,children:i("path",{d:"M13.5 2l-7.5 7.5-3.5-3.5-2.5 2.5 6 6 10-10z"})})}/**
 * Arrow-down icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function Jt(e){return i(U,{...e,children:i("path",{d:"M8 15.5l7.5-7.5h-4.5v-8h-6v8h-4.5z"})})}/**
 * Star icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function os(e){return i(U,{...e,children:i("path",{d:"M16 6.204l-5.528-0.803-2.472-5.009-2.472 5.009-5.528 0.803 4 3.899-0.944 5.505 4.944-2.599 4.944 2.599-0.944-5.505 4-3.899z"})})}function si({bg:e,experiences:t,heading:n}){return i("div",{className:`mt-4 rounded ${e}`,children:[i("h3",{className:"mt-0 p-1 text-white text-center",children:n}),i("ul",{className:"list-disc py-2 pl-8 bg-white bg-opacity-90",children:t.map(r=>i("li",{children:r.name},r.id))})]})}function q({date:e,time:t,...n}){return i("time",{...n,dateTime:e||t,children:e?sr(e):t?Z(t):""})}function Pe({start:e,end:t,timeOnly:n}){const r=as({start:e,end:t}),o=t?i(S,{children:[r.start?i(q,{time:r.start}):i("span",{children:"Park Open"})," \u2013"," ",r.end?i(q,{time:r.end}):i("span",{children:"Park Close"})]}):i(q,{time:e.time});if(n)return o;const s=D().date;return i("table",{className:"mt-4 text-lg",children:i("tbody",{children:[i(qt,{label:t?"Arrive by":"Reservation at",data:o}),(t==null?void 0:t.date)&&t.date>(e.date??s)&&i(qt,{label:"Valid until",data:i(q,{date:t.date})})]})})}function qt({label:e,data:t}){return i("tr",{children:[i("th",{className:"text-right",children:[e,":"]}),i("td",{className:"pl-2 font-semibold",children:t})]})}function as({start:e,end:t}){const n=D().date;return{start:(e.date||"")<n?void 0:e.time,end:t==null?void 0:t.time}}const Zt=i("span",{"aria-hidden":!0,children:"\u2022"});function oi({booking:e,button:t}){const n=G();return i("div",{className:"flex items-center gap-x-3",children:[i("div",{className:"flex-1 min-w-0",children:[i("div",{className:"flex items-center gap-x-2 text-gray-500 text-sm font-semibold uppercase whitespace-nowrap",children:[e.type==="DAS"&&i(S,{children:[i("span",{children:"DAS"}),Zt]}),e.type==="BG"?i(S,{children:[i("span",{children:["BG\u200A",e.boardingGroup]}),e.status==="SUMMONED"&&i(S,{children:[Zt,i("span",{className:`${n.text} font-bold`,children:"Board Now"})]})]}):i(Pe,{...e,timeOnly:!0})]}),i("div",{className:"text-lg font-semibold leading-snug truncate",children:e.choices?"Multiple Experiences":e.name})]}),t&&i("div",{children:t})]})}function ai(){const e=te(),t=G();return e.current?i("div",{className:`sticky top-0 -mx-3 pb-1 ${t.bg}`,children:i("div",{className:"pb-3 bg-white",children:[i("div",{className:`pb-1 ${t.bg} text-white text-sm font-semibold uppercase text-center`,children:"Modifying Reservation"}),i("div",{className:"mt-2 px-3",children:i(oi,{booking:e.current,button:i(L,{type:"small",back:{screen:ie},onClick:e.end,children:"Keep"})})})]})}):null}function O({guests:e,selectable:t,conflicts:n}){return e.length===0?null:i("ul",{className:"mt-2",children:e.map(r=>{var o;return i("li",{className:"px-3 py-1",children:i("label",{className:"flex items-center",children:[t&&i("input",{type:"checkbox",checked:t.isSelected(r),onChange:()=>t.onToggle(r),className:"mr-3"}),i("span",{className:"w-[48px] h-[48px] leading-[48px] mr-3 rounded-full text-3xl font-bold text-center bg-gray-400 text-white",children:r.avatarImageUrl?i("img",{src:r.avatarImageUrl,alt:"",width:"48",height:"48",className:"rounded-full"}):i("span",{"aria-hidden":"true",children:r.name[0]})}),i("span",{className:"leading-tight",children:[r.name,(n==null?void 0:n[r.id])&&i("span",{className:"block text-xs font-semibold text-red-700 uppercase",children:(o=n[r.id])==null?void 0:o.replace(/_/g," ")})]})]})},r.id)})})}const ci="bg1.genie.partyIds";function li(){const e=JSON.parse(localStorage.getItem(ci)||"[]");return Array.isArray(e)?e:[]}function cs(){const e=F();C(()=>e.setPartyIds(li()),[e])}function ls(){const e=F(),{loadData:t,loaderElem:n}=Y(),[r,o]=T(!0),[s,a]=T(),[c,d]=T(()=>{const h=new Set(li());return o(h.size===0),h});function u(){const h=[...c];localStorage.setItem(ci,JSON.stringify(h)),e.setPartyIds(h)}C(()=>{t(async()=>{const h=await e.guests();a([...h.eligible,...h.ineligible].sort((_,k)=>+!_.primary-+!k.primary||_.name.localeCompare(k.name)))})},[e,t]),C(()=>{r&&d(new Set)},[r]);const l=s==null?void 0:s.filter(h=>c.has(h.id)),f=s==null?void 0:s.filter(h=>!c.has(h.id)),p=h=>i("li",{children:i("label",{className:"flex items-center mt-2",children:[i("input",{type:"radio",name:"auto",onChange:()=>o(h.auto),checked:r===h.auto,className:"mr-2"})," ",h.children]})});return i(M,{heading:"Party Selection",children:[i("p",{children:"By default, all eligible guests (up to a maximum of 12) are automatically selected when you book a Lightning Lane. If you would like to limit who you book for, you can manually select your party here."}),i("ul",{children:[i(p,{auto:!0,children:"Book for all eligible guests"}),i(p,{auto:!1,children:"Only book for selected guests"})]}),r?null:(s==null?void 0:s.length)===0?i("p",{className:"text-red-700",children:"No guests to select"}):l&&f?i(S,{children:[l.length>0&&i(S,{children:[i("h3",{children:"Your Party"}),i(O,{guests:l,selectable:{isSelected:()=>!0,onToggle:h=>{const _=new Set(c);_.delete(h.id),d(_)}}})]}),f.length>0&&i(S,{children:[i("h3",{children:"Add to Your Party"}),i(O,{guests:f,selectable:{isSelected:()=>!1,onToggle:h=>{const _=new Set(c);_.add(h.id),d(_)}}})]})]}):null,n,i(H,{back:!0,disabled:!r&&c.size===0,onClick:u,children:"Save"})]})}function Ae({name:e,onClick:t,...n}){return i(L,{...n,title:`Refresh ${e}`,onClick:t,children:i(ot,{})})}const di=B({eligible:[],ineligible:[],selected:[],setSelected:()=>null,experience:{name:"",park:{name:"",theme:{bg:"",text:""}}}}),ui=di.Provider,hi=()=>z(di),ds="https://bg1.joelface.com/ping",Xt="bg1.ping.date";async function pi(){const{date:e}=D();if(localStorage.getItem(Xt)===e)return;const{ok:n}=await et(ds,{method:"POST"});n&&localStorage.setItem(Xt,e)}function us(e){return i(U,{...e,children:i("path",{d:"M 5.5253906 0.9296875 L 3.4042969 3.0507812 L 8.3535156 8 L 3.4042969 12.949219 L 5.5253906 15.070312 L 10.474609 10.121094 L 12.595703 8 L 10.474609 5.8789062 L 5.5253906 0.9296875 z"})})}function fi(e){return i("div",{className:`mt-4 border-2 rounded border-green-600 p-1 font-semibold text-center text-green-600 bg-green-100 ${e.className}`,children:e.children})}function hs({booking:e,onCancel:t,dasGuest:n}){const r=F(),o=Ce(),s=e.type==="DAS"?o:r,{refreshPlans:a}=re(),[c,d]=T(new Set),{loadData:u,loaderElem:l}=Y(),{name:f,park:p,guests:h}=e,_=c.size===0,k=c.size===h.length;async function x(){_||(await u(async()=>{await s.cancelGuests([...c]),a()}),t(h.filter(m=>!c.has(m))))}return i(M,{heading:"Cancel Guests",theme:p.theme,children:[i("h2",{children:f}),i("div",{children:p.name}),i(Pe,{...e}),i("div",{className:"ml-3",children:i("label",{className:"flex items-center py-4",children:[i("input",{type:"checkbox",checked:k,onChange:()=>d(new Set(k?[]:h))}),i("span",{className:"ml-3",children:"Select All"})]})}),!_&&i("div",{className:"mb-4",children:[i("h3",{children:"Cancel These Guests"}),i(O,{guests:h.filter(m=>c.has(m)),selectable:{isSelected:()=>!0,onToggle:m=>{if(n&&m!==n&&c.has(n))d(new Set);else{const I=new Set(c);I.delete(m),d(I)}}}})]}),!k&&i("div",{children:[i("h3",{children:"Select Guests to Cancel"}),i(O,{guests:h.filter(m=>!c.has(m)),selectable:{isSelected:()=>!1,onToggle:m=>{d(new Set(m===n?h:c).add(m))}}})]}),i(H,{back:!0,disabled:_,onClick:x,children:"Cancel "+(k?"Reservation":"Guests")}),l]})}function he({booking:e,isNew:t}){var w;const{goTo:n,goBack:r}=$(),{setPark:o}=V(),{parks:s}=me(),a=Kn(),{name:c,park:d,choices:u,type:l,subtype:f,start:p}=e,h=l==="DAS"&&f==="IN_PARK"?e.guests.find(v=>a.find(g=>g[0].id===v.id)):void 0,_=te(),[k,x]=T(e.cancellable&&(l!=="DAS"||h)?e.guests:void 0),m=new Map([[d,[]],...[...s.values()].map(v=>[v,[]])]);for(const v of u||[])(w=m.get(v.park))==null||w.push(v);const I=[...m].filter(([,v])=>v.length>0).map(([v])=>v),E=(u?I.length===1?I[0]:{}:d).theme??rt;return i(M,{heading:"Your "+{LL:"Lightning Lane",DAS:"DAS Selection",BG:"Boarding Group",APR:"Park Pass",RES:"Reservation"}[l],theme:E,buttons:e.modifiable&&i(L,{onClick:()=>{_.begin(e),o(e.park),r({screen:ie,props:{tabName:"Genie+"}})},children:"Modify"}),children:[i("div",{className:`-mx-3 px-2 py-1 text-center ${E.bg} text-white text-sm font-semibold uppercase`,children:i(q,{date:p.date})}),u?i("h2",{children:"Multiple Experiences"}):i(S,{children:[i("h2",{children:c}),i("div",{children:d.name})]}),l==="BG"?i(S,{children:[e.status==="SUMMONED"&&i(fi,{children:"Your boarding group has been called"}),i("h3",{children:["Boarding Group:"," ",i("span",{className:"ml-1 font-semibold",children:e.boardingGroup})]}),i("p",{children:"Check the official Disney app for return time and other virtual queue information."})]}):i(Pe,{...e}),u&&i(S,{children:[i("p",{children:[i("b",{children:c})," was temporarily unavailable during your return time. You may redeem this Lightning Lane at one of these replacement experiences:"]}),[...m].filter(([,v])=>v.length>0).map(([v,g])=>i(si,{heading:v.name,experiences:g,bg:v.theme.bg},v.id))]}),i("div",{className:"flex mt-4",children:[i("h3",{className:"inline mt-0",children:"Your Party"}),e.cancellable&&k&&i(L,{type:"small",onClick:()=>{n(i(hs,{booking:{...e,guests:k},dasGuest:h,onCancel:v=>{v.length>0?x(v):r()}}))},className:"ml-3",children:"Cancel"})]}),i(O,{guests:k||e.guests,conflicts:Object.fromEntries(e.type==="LL"?e.guests.filter(v=>(v.redemptions??1)!==1).map(v=>[v.id,`Redemptions left: ${v.redemptions}`]):[])}),t&&i(H,{onClick:()=>r({screen:ie,props:{tabName:"Plans"}}),children:"Show Plans"})]})}function mi({...e}){var l,f;const{plans:t,refreshPlans:n,loaderElem:r}=re(),{goTo:o}=$(),s=G();function a(p){o(i(he,{booking:p}))}const c=D().date,d=new Map,u=new Map;for(const p of t){const h=p.start.date??c;d.has(h)||d.set(h,[]),p.type!=="APR"&&((l=d.get(h))==null||l.push(p)),u.has(h)||u.set(h,new Set),(p.type!=="LL"||p.subtype!=="MEP")&&p.park.icon&&((f=u.get(h))==null||f.add(p.park))}return i(ct,{heading:"Your Plans",buttons:i(Ae,{name:"Plans",onClick:n}),theme:rt,...e,children:[t.length>0?[...d].map(([p,h])=>i("div",{children:[i("div",{className:"sticky top-0 -mx-3 pt-1 bg-white",children:i("div",{className:"flex items-center",children:[i("h2",{className:`flex-1 mt-0 rounded-r-full px-3 py-1 ${s.bg} text-white text-sm uppercase`,children:i(q,{date:p})}),i("ul",{className:"px-3 pl-2 text-lg text-right",children:[...u.get(p)??[]].map(_=>i("li",{className:"inline ml-1 first:ml-0","aria-label":_.name,children:_.icon},_.id))})]})}),i("ul",{className:h.length===0?"mt-3":"",children:h.map(_=>i("li",{className:"py-2.5 first:border-0 border-t-4 border-gray-300",onClick:()=>a(_),children:i(oi,{booking:_,button:i("button",{className:s.text,title:"More Info",children:i(us,{})})})},_.bookingId))})]},p)):i("p",{className:"font-semibold text-center uppercase text-gray-500",children:"No existing plans"}),r]})}function ps({...e}){const{goTo:t}=$();return i(S,{children:i(L,{...e,onClick:()=>t(i(mi,{})),title:"Plans",children:i(ri,{})})})}function dt(){const{ineligible:e}=hi();return i(O,{guests:e,conflicts:Object.fromEntries(e.map(t=>[t.id,t.eligibleAfter?`TOO EARLY (${Z(t.eligibleAfter)})`:t.ineligibleReason||"ELIGIBLE FOR NEW BOOKING"]))})}function fs(){const e=F(),t=te();return i(S,{children:[t.current?i(S,{children:[i("h3",{children:"Unable to Modify"}),i("p",{children:"Your current reservation cannot be modified to this experience due to the following conflicts:"})]}):i(S,{children:[e.nextBookTime&&e.nextBookTime.slice(0,5)>D().time.slice(0,5)&&i(fi,{children:["Eligible at ",i(q,{time:e.nextBookTime})]}),i("h3",{children:"No Eligible Guests"}),i("p",{children:"No one in your party is currently eligible for this Lightning Lane."})]}),i(dt,{})]})}function ms({onRefresh:e}){return i(S,{children:[i("h3",{children:"No Guests Found"}),i("p",{children:"Your party could not be loaded. This is probably just a temporary network error. Wait a few seconds and try again."}),i(H,{onClick:e,children:"Try Again"})]})}function _s(e){return i("div",{className:`mt-4 border-2 rounded border-red-600 p-1 font-semibold text-center text-red-600 bg-red-100 ${e.className}`,children:e.children})}function gs({party:e}){const{eligible:t,ineligible:n,selected:r,setSelected:o,experience:s}=e,[a,c]=T(new Set(r)),[d,u]=qn(),{maxPartySize:l}=F();function f(p){c(h=>{u(""),h=new Set(h);const _=h.has(p)?"delete":"add";return _==="add"&&h.size>=l?u(`Maximum party size: ${l}`):h[_](p),h})}return i(ui,{value:e,children:i(M,{heading:"Modify Party",theme:s.park.theme,children:[i("h2",{children:s.name}),i("div",{children:s.park.name}),i("h3",{children:"Your Party"}),i(O,{guests:t,selectable:{isSelected:p=>a.has(p),onToggle:f}}),n.length>0&&i(S,{children:[i("h3",{children:"Ineligible Guests"}),i(dt,{})]}),i(H,{back:!0,disabled:a.size===0,onClick:()=>{o(t.filter(p=>a.has(p)))},children:"Confirm Party"}),d]})})}function ut({button:e}){const{goTo:t}=$(),n=hi(),{eligible:r,selected:o}=n,{maxPartySize:s}=F();return i(S,{children:[r.length>s&&o.length===s&&i(_s,{children:"Party size restricted"}),o.length>0?i(S,{children:[i("div",{className:"mt-4",children:[i("h3",{className:"inline mt-0",children:"Your Party"}),i(L,{type:"small",onClick:()=>t(i(gs,{party:n})),className:"ml-3",children:"Modify"})]}),i(O,{guests:o})]}):i(S,{children:[i("h3",{children:"Ineligible Guests"}),i(dt,{})]}),e]})}function ys(){return i(S,{children:[i("h3",{children:"No Reservations Available"}),i("p",{children:"There aren't enough reservation slots available for your entire party. If only part of your group wishes to go on this attraction, edit your party to check again. Otherwise, go back to the tip board and select another attraction."}),i(ut,{})]})}function vs({offer:e,onBook:t}){const n=te();return i(S,{children:[i(Pe,{...e}),e.changed&&i("div",{className:"text-sm",children:[i("strong",{children:"Note:"})," Return time has been changed"]}),i(ut,{button:i(H,{onClick:t,children:`${n.current?"Modify":"Book"} Lightning Lane`})})]})}const en="https://widget.time.is/t.js";function bs(){if([...document.scripts].some(t=>t.src===en))return;const e=document.createElement("script");e.src=en,e.onload=_i,document.head.appendChild(e)}const xe={};function _i(){"time_is_widget"in self&&self.time_is_widget.init(xe)}function xs(e){bs(),xe[e]||(xe[e]={}),_i()}function gi(e,t){const n=document.getElementById(e);if(!n||n.firstElementChild)return t();n.textContent=D().time,setTimeout(()=>gi(e,t),100)}function ws({id:e,onSync:t}){return C(()=>{xs(e),gi(e,t)},[e,t]),i("time",{id:e})}const ks={WDW:"Orlando_z161",DLR:"Anaheim_z14e"},Ns=5e3;function yi({resort:e,time:t,label:n}){const r=ks[e],[o,s]=T(null);C(()=>{setTimeout(()=>s(c=>c||!1),Ns)},[]);const a=W(()=>s(!0),[]);return i("table",{className:"mt-4 mx-auto text-gray-500",children:i("tbody",{children:[i(tn,{heading:n,time:i("time",{children:t||"--:--:--"})}),i(tn,{heading:i("a",{href:`https://time.is/${r.split("_")[0]}`,id:"time_is_link",target:"_blank",rel:"noreferrer",children:"Current time"}),time:i(S,{children:[i(ws,{id:r,onSync:a}),o===!1&&i("span",{className:"text-sm font-sans font-semibold text-red-600",children:[" ","(unsynced)"]})]})})]})})}function tn({heading:e,time:t}){return i("tr",{children:[i("th",{scope:"row",className:"pr-3 text-right text-xs font-semibold uppercase",children:[e,":"]}),i("td",{className:"text-xl font-mono leading-tight",children:["\uFEFF",t]})]})}function Ss({startTime:e,onRefresh:t}){return i(S,{children:[e?i(S,{children:[i(yi,{resort:"WDW",time:e,label:"Booking start"}),i("p",{children:["At"," ",i("time",{dateTime:e,className:"font-semibold",children:Z(e)}),", tap the ",i("span",{className:"font-semibold",children:"Check Availability"})," ","button below to start booking this Lightning Lane."]})]}):i("p",{children:"Sorry, but you can't make a Lightning Lane reservation for this attraction yet."}),i(ut,{button:i(H,{onClick:t,children:"Check Availability"})})]})}function Is({experience:e}){const{goTo:t}=$(),n=F(),{refreshPlans:r}=re(),o=te(),[s,a]=T(),[c,d]=T(!e.flex.available&&e.flex.enrollmentStartTime!==void 0),[u,l]=T(c?null:void 0),{loadData:f,loaderElem:p}=Y();async function h(){!u||!s||f(async()=>{let E=null;E=await n.book(u,o.current,s.selected),o.end();const y=new Set(s.selected.map(v=>v.id)),w=E.guests.filter(v=>!y.has(v.id));w.length>0&&(await n.cancelGuests(w),E.guests=E.guests.filter(v=>y.has(v.id))),E&&t(i(he,{booking:E,isNew:!0}),{replace:!0}),r(),pi()},{messages:{410:"Offer expired"}})}function _(){f(async E=>{var v;const w=(await n.experiences(e.park)).find(g=>g.id===e.id);(v=w==null?void 0:w.flex)!=null&&v.available?(d(!1),l(void 0)):E("Reservations not open yet")})}const k=W(()=>{f(async()=>{const E=o.current?{eligible:o.current.guests,ineligible:[]}:await n.guests(e);a({...E,selected:E.eligible.slice(0,n.maxPartySize),setSelected:y=>a(w=>{if(!w)return w;const v=new Set(w.selected);return d(g=>(g||l(N=>N===null||y.some(R=>!v.has(R))?void 0:N),g)),{...w,selected:y}}),experience:e})})},[n,e,o,f]);C(()=>{s||k()},[s,k]);const x=W(E=>{!s||s.selected.length===0||f(async()=>{try{const y=await n.offer(e,s.selected,o.current),{ineligible:w}=y.guests;if(w.length>0){const v=new Set(w.map(N=>N.id)),g=N=>!v.has(N.id);a({...s,eligible:s.eligible.filter(g),ineligible:[...w,...s.ineligible],selected:s.selected.filter(g)})}y.active?(u&&(y.changed=!1),l(y)):l(v=>v??null)}catch(y){throw E||l(null),y}},{messages:{410:u?"No reservations available":""}})},[n,e,s,u,o,f]);C(()=>{u===void 0&&x()},[u,x]);const m=(s==null?void 0:s.eligible.length)===0,I=m&&(s==null?void 0:s.ineligible.length)===0;return i(M,{heading:"Lightning Lane",theme:e.park.theme,buttons:i(S,{children:[i(ps,{}),!c&&i(Ae,{onClick:()=>{m?k():x()},name:m?"Party":"Offer"})]}),children:[i(ai,{}),i("h2",{children:e.name}),i("div",{children:e.park.name}),s&&i(ui,{value:s,children:c&&s?i(Ss,{startTime:e.flex.enrollmentStartTime,onRefresh:_}):I?i(ms,{onRefresh:k}):m?i(fs,{}):!s||u===void 0?i("div",{}):u===null?i(ys,{}):i(vs,{offer:u,onBook:h})}),p]})}function ht({label:e,children:t}){return i("div",{className:"flex items-center flex-1 whitespace-nowrap",children:[i("span",{className:"mr-2 text-xs font-semibold uppercase text-gray-500",children:e})," ",t]})}function Es({experience:e}){const{goTo:t}=$(),{flex:n}=e;return i(ht,{label:"Genie+",children:i("span",{children:i(L,{onClick:()=>t(i(Is,{experience:e})),children:n.nextAvailableTime?Z(n.nextAvailableTime):"none"})})})}function vi({children:e}){return i("div",{className:"mt-8 flex justify-center",children:i("div",{children:[i("h2",{className:"mt-0 pl-1 text-gray-500 text-sm leading-tight uppercase",children:"Symbols"}),i("div",{className:"border-2 border-gray-500 rounded px-2 py-0.5 bg-gray-100",children:i("table",{children:i("tbody",{children:e})})})]})})}function le({sym:e,def:t,onInfo:n}){return i("tr",{children:[i("th",{className:"py-0.5 text-center font-bold",children:e}),i("td",{className:"pl-3 py-0.5",children:t}),n&&i("td",{className:"pl-3 py-0.5",children:i(L,{type:"small",onClick:n,children:"Info"})})]})}const Ts="_SELECT_RADIO_BUTTON_";function bi(e){const{options:t,selected:n,title:r,onChange:o,disabled:s,...a}=e,{bg:c}=G(),[d,u]=T(!1),[l,f]=T(0),p=j(null),h=j(null);In(()=>{var N;if((N=t.values().next().value)!=null&&N.icon)return;const y=p.current,w=y==null?void 0:y.firstChild;if(!w)return;const v=w.nodeValue;if(!v)return;let g=0;for(const R of t.values())w.nodeValue=R.text,g=Math.max(y.offsetWidth,g);w.nodeValue=v,f(g)},[t]);const _=()=>{var y;return(y=h.current)==null?void 0:y.querySelector("input:checked")};C(()=>{var v;if(!d)return;const y=_();(v=y==null?void 0:y.closest("li"))==null||v.scrollIntoView(),y==null||y.focus();const w=g=>{var N;(N=h.current)!=null&&N.contains(g.target)||u(!1)};return addEventListener("focusin",w),()=>removeEventListener("focusin",w)},[d]);const k=()=>{const y=_();if(y){const w=y.value,v=t.get(w);v&&o(v.value??w)}u(!1)},x=n?t.get(n):r!==void 0?{text:r}:void 0;if(!x)return null;const{icon:m,text:I}=x;let E=!1;return i(S,{children:[i(L,{...a,title:m?`${r}: ${I}`:r,disabled:s||t.size===0,onClick:()=>u(!0),children:[m||i("span",{className:"flex-1 truncate",style:{minWidth:`${l}px`},ref:p,children:I}),i(U,{className:"w-2.5 ml-2 shrink-0",children:i("path",{d:"m6.8273 12.401-5.6333-7.7812a1.0212 1.0212 117.05 0 1 0.82716-1.62l11.958-2e-7a1.0212 1.0212 62.952 0 1 0.82714 1.62l-1.6438 2.2705a79984 79984 125.9 0 0-2.3456 3.2401l-1.6437 2.2706a1.4479 1.4479 180 0 1-2.3456 4.4e-5z"})})]}),d&&i(at,{onChange:()=>{E||k(),E=!1},onClick:y=>{var w;E||(!((w=h.current)!=null&&w.contains(y.target))||n&&y.target.value===n)&&(u(!1),y.preventDefault())},onKeyDown:({key:y})=>{["Enter"," "].includes(y)?k():y.startsWith("Arrow")&&(E=!0)},"data-testid":"shade",children:i("div",{className:"flex flex-col min-w-[50%] max-h-[90%] rounded-lg bg-white text-black",children:[r&&i("h3",{className:`mt-0 rounded-t-lg px-2 py-1 ${c} text-white font-semibold text-center`,children:r}),i("ul",{className:"overflow-auto",ref:h,children:[...t].map(([y,w])=>i("li",{className:"border-t-2 first:border-0 border-gray-300",children:i("label",{className:"flex flex-row items-center gap-x-2.5 px-4 py-3",children:[i("input",{type:"radio",name:Ts,value:y,defaultChecked:y===n,className:"w-4 h-4 shrink-0"})," ",w.icon&&i("span",{"aria-hidden":"true",children:w.icon})," ",w.text]})},w.text))})]})})]})}function xi(e){const{parks:t}=me(),{park:n,setPark:r}=V(),o=te(),s=Ze(()=>new Map([...t.values()].map(a=>[a.id,{value:a,icon:a.icon,text:a.name}])),[t]);return i(bi,{...e,options:s,selected:n.id,onChange:r,disabled:!!o.current,title:"Park","data-testid":"park-select"})}function Cs({experience:{type:e,standby:t}}){return t.displayNextShowTime||e==="ENTERTAINMENT"&&!t.waitTime?i(As,{standby:t}):i(Ps,{standby:t})}const Ps=({standby:e})=>i(ht,{label:"Standby",children:e.available?i(ki,{time:e.waitTime!==void 0?e.waitTime+" min":"now"}):i(Ni,{text:"down"})}),As=({standby:e})=>i(ht,{label:i(S,{children:["Next ",i("span",{className:"hidden xs:inline",children:"Show"})]}),children:e.displayNextShowTime?i(ki,{time:e.displayNextShowTime}):i(Ni,{text:"none"})}),wi="inline-block border-2 rounded px-1.5 py-0.5 font-semibold",ki=({time:e})=>i("span",{className:`${wi} border-gray-500 text-gray-500 bg-gray-100`,children:e}),Ni=({text:e})=>i("span",{className:`${wi} border-red-600 text-red-600 bg-red-100`,children:e});function Ds({bookTime:e,dropTime:t}){const n=G();return!e&&!t?null:i("div",{className:`flex justify-center gap-x-10 -mx-3 px-3 pb-1 ${n.bg} text-white text-sm font-semibold uppercase text-center`,children:[i(nn,{label:"Book",time:e}),i(nn,{label:"Drop",time:t})]})}function nn({label:e,time:t}){if(!t)return null;t=t.slice(0,5);const n=D().time.slice(0,5);return i("div",{children:[e,":"," ",i("time",{dateTime:t,className:"whitespace-nowrap",children:t>n?Z(t):"now"})]})}async function Ls(e={}){return new Promise((t,n)=>{navigator.geolocation.getCurrentPosition(r=>{t(r)},r=>{n(r)},e)})}const Rs={maximumAge:15e3,timeout:2e3};function $s(){const[e,t]=T(),n=W(()=>{(async()=>{try{const{coords:r}=await Ls(Rs);t(o=>o&&r.latitude===o[0]&&r.longitude===o[1]?o:[r.latitude,r.longitude])}catch{t(void 0)}})()},[]);return[e,n]}const Ms=(e,t)=>(e.priority||1/0)-(t.priority||1/0),Re=(e,t)=>(t.standby.waitTime||-1)-(e.standby.waitTime||-1),$e=(e,t)=>{var n,r;return Ie(((n=e==null?void 0:e.flex)==null?void 0:n.nextAvailableTime)||"00:00")-Ie(((r=t==null?void 0:t.flex)==null?void 0:r.nextAvailableTime)||"00:00")},Os=(e,t)=>e.name.toLowerCase().localeCompare(t.name.toLowerCase()),rn=(e,t)=>Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)),Gs=(e,t,n)=>e.geo===t.geo?0:e.geo?t.geo?n?rn(e.geo,n)-rn(t.geo,n):0:-1:1,Us={priority:(e,t)=>Ms(e,t)||Re(e,t)||$e(e,t),standby:(e,t)=>Re(e,t)||$e(e,t),soonest:(e,t)=>$e(e,t)||Re(e,t),nearby:(e,t,n)=>Gs(e,t,n),aToZ:()=>0},Bs=new Map([["priority",{text:"Priority"}],["nearby",{text:"Nearby"}],["standby",{text:"Standby"}],["soonest",{text:"Soonest"}],["aToZ",{text:"A to Z"}]]);function zs(e,t){const{n,s:r,e:o,w:s}=e.geo,[a,c]=t;return a<n&&a>r&&c<o&&c>s}function Hs(){const{park:e}=V(),{experiences:t}=lt(),[n,r]=$s(),[o,s]=T("priority");C(()=>{o==="nearby"&&r()},[t,o,r]);const a=(d,u)=>{var l,f;return Number((l=u==null?void 0:u.flex)==null?void 0:l.available)-Number((f=d==null?void 0:d.flex)==null?void 0:f.available)||Us[o==="nearby"&&!(n&&zs(e,n))?"priority":o](d,u,n)||Os(d,u)},c=W(d=>i(bi,{...d,options:Bs,selected:o,onChange:s,title:"Sort By"}),[o]);return{sorter:a,SortSelect:c}}const Ws=30,Fs=60,sn="bg1.genie.tipBoard.starred",Ye="Lightning Pick",Ke="Upcoming Drop",Qe="Booked",on=e=>e.experienced&&!e.starred;function js({contentRef:e}){cs();const{goTo:t}=$(),n=F(),{park:r}=V(),{experiences:o,refreshExperiences:s,loaderElem:a}=lt(),{sorter:c,SortSelect:d}=Hs(),u=G(),[l,f]=T(()=>{const g=JSON.parse(localStorage.getItem(sn)||"[]");return new Set(Array.isArray(g)?g:[])}),p=j(!0);C(()=>{var g;p.current?p.current=!1:(g=e.current)==null||g.scroll(0,0)},[d,e]);function h({id:g}){f(N=>(N=new Set(N),N.has(g)?N.delete(g):N.add(g),localStorage.setItem(sn,JSON.stringify([...N])),N))}const _=n.nextDropTime(r),k=()=>t(i(Ys,{})),x=()=>t(i(Ks,{dropTime:_,park:r})),m=()=>t(i(Qs,{})),I=g=>i("li",{className:"pb-3 first:border-0 border-t-4 border-gray-300",children:[i("div",{className:"flex items-center gap-x-2 mt-2",children:[i(Vs,{experience:g,toggleStar:h}),i("h3",{className:"flex-1 mt-0 text-lg font-semibold leading-tight truncate",children:g.name}),g.lp?i(Me,{name:Ye,icon:Ve,onClick:k}):_&&g.drop?i(Me,{name:Ke,icon:Jt,onClick:x}):null,g.flex.preexistingPlan&&i(Me,{name:Qe,icon:Qt,onClick:m})]}),i("div",{className:"flex flex-wrap gap-1.5 mt-2",children:[i(Cs,{experience:g}),i(Es,{experience:g})]})]},g.id+(g.starred?"*":"")),E=Ie(D().time),y=o.filter(g=>!!g.flex).map(g=>{var mt;const N=g.standby.waitTime||0,R=(mt=g==null?void 0:g.flex)==null?void 0:mt.nextAvailableTime;return{...g,lp:!!R&&N>=Ws&&Ie(R)-E<=Math.min(Fs,(4-Math.trunc(g.priority||4))/3*N),starred:l.has(g.id)}}).sort((g,N)=>+!g.starred-+!N.starred||+!g.lp-+!N.lp||c(g,N)),w=y.filter(g=>!on(g)),v=y.filter(on).sort((g,N)=>g.name.localeCompare(N.name));return i(ct,{heading:"Genie+",buttons:i(S,{children:[i(d,{}),i(xi,{}),i(Ae,{name:"Experiences",onClick:s})]}),contentRef:e,children:[i(ai,{}),i(Ds,{bookTime:n.nextBookTime,dropTime:_}),i("ul",{"data-testid":"unexperienced",children:w.map(I)}),v.length>0&&i(S,{children:[i("h2",{className:`-mx-3 px-3 py-1 text-sm uppercase text-center ${u.bg} text-white`,children:"Previously Experienced"}),i("ul",{"data-testid":"experienced",children:v.map(I)})]}),y.length>0&&i(vi,{children:[i(le,{sym:i(Ve,{className:u.text}),def:Ye,onInfo:k}),i(le,{sym:i(Jt,{className:u.text}),def:Ke,onInfo:x}),i(le,{sym:i(Qt,{className:u.text}),def:Qe,onInfo:m})]}),a]})}function Me({name:e,icon:t,onClick:n}){const r=G();return i("button",{title:`${e} (more info)`,className:`-mx-2 px-2 ${r.text}`,onClick:n,children:i(t,{})})}function Vs({experience:e,toggleStar:t}){const n=G();return i("button",{title:`${e.starred?"Remove from":"Add to"} Favorites`,className:"-m-2 p-2",onClick:()=>t(e),children:i(os,{className:e.starred?n.text:"text-gray-300"})})}function Ys(){return i(M,{heading:Ye,children:i("p",{children:"When an attraction with a long standby wait has a Lightning Lane return time in the near future, it's highlighted as a Lightning Pick. Book these quick before they're gone!"})})}function Ks({dropTime:e,park:t}){const n=F(),{bg:r}=G();return i(M,{heading:Ke,children:[i("p",{children:["This attraction may be part of the"," ",e?i("time",{dateTime:e,className:"font-semibold",children:Z(e)}):"next"," ","drop of additional Lightning Lane inventory, with earlier return times than what's currently being offered. Availability varies but is always limited, so be sure you're ready to book when the drop time arrives!"]}),n.upcomingDrops(t).map(o=>i(si,{heading:Z(o.time),experiences:o.experiences,bg:r},o.time))]})}function Qs(){return i(M,{heading:Qe,children:i("p",{children:"You currently have a Lightning Lane reservation for this attraction."})})}/**
 * Exit icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function Js(e){return i(U,{...e,children:i("path",{d:"M12 10v-2h-5v-2h5v-2l3 3zM11 9v4h-5v3l-6-3v-13h11v5h-1v-4h-8l4 2v9h4v-3z"})})}/**
 * Heart icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function qs(e){return i(U,{...e,children:i("path",{d:"M11.8 1c-1.682 0-3.129 1.368-3.799 2.797-0.671-1.429-2.118-2.797-3.8-2.797-2.318 0-4.2 1.882-4.2 4.2 0 4.716 4.758 5.953 8 10.616 3.065-4.634 8-6.050 8-10.616 0-2.319-1.882-4.2-4.2-4.2z"})})}/**
 * News icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function Zs(e){return i(U,{...e,children:i("path",{d:"M14 4v-2h-14v11c0 0.552 0.448 1 1 1h13.5c0.828 0 1.5-0.672 1.5-1.5v-8.5h-2zM13 13h-12v-10h12v10zM2 5h10v1h-10zM8 7h4v1h-4zM8 9h4v1h-4zM8 11h3v1h-3zM2 7h5v5h-5z"})})}/**
 * Cog icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function Xs(e){return i(U,{...e,children:i("path",{d:"M14.59 9.535c-0.839-1.454-0.335-3.317 1.127-4.164l-1.572-2.723c-0.449 0.263-0.972 0.414-1.529 0.414-1.68 0-3.042-1.371-3.042-3.062h-3.145c0.004 0.522-0.126 1.051-0.406 1.535-0.839 1.454-2.706 1.948-4.17 1.106l-1.572 2.723c0.453 0.257 0.845 0.634 1.123 1.117 0.838 1.452 0.336 3.311-1.12 4.16l1.572 2.723c0.448-0.261 0.967-0.41 1.522-0.41 1.675 0 3.033 1.362 3.042 3.046h3.145c-0.001-0.517 0.129-1.040 0.406-1.519 0.838-1.452 2.7-1.947 4.163-1.11l1.572-2.723c-0.45-0.257-0.839-0.633-1.116-1.113zM8 11.24c-1.789 0-3.24-1.45-3.24-3.24s1.45-3.24 3.24-3.24c1.789 0 3.24 1.45 3.24 3.24s-1.45 3.24-3.24 3.24z"})})}/**
 * User icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function eo(e){return i(U,{...e,children:i("path",{d:"M9 11.041v-0.825c1.102-0.621 2-2.168 2-3.716 0-2.485 0-4.5-3-4.5s-3 2.015-3 4.5c0 1.548 0.898 3.095 2 3.716v0.825c-3.392 0.277-6 1.944-6 3.959h14c0-2.015-2.608-3.682-6-3.959z"})})}function to(){const{goTo:e}=$(),t=F(),[n]=T([{text:"Party Selection",icon:i(eo,{}),action:()=>e(i(ls,{}))},{text:"Log Out",icon:i(Js,{}),action:()=>t.logOut()},{text:"BG1 News",icon:i(Zs,{}),action:()=>e(i(Vn,{}))},{text:"Support BG1",icon:i(qs,{className:"text-red-600"}),action:()=>open("https://joelface.github.io/bg1/contact.html#donate")}]),[r,o]=T(!1),s=j(null);return i(S,{children:[i("button",{className:"absolute top-0 right-0 h-full px-4",onClick:()=>o(!0),title:"Settings Menu",children:i(Xs,{})}),r&&i(at,{onClick:a=>{var c;(c=s.current)!=null&&c.contains(a.target)||o(!1)},"data-testid":"shade",children:i("ul",{className:"overflow-auto min-w-[50%] max-h-[90%] rounded-lg bg-white text-black text-lg font-normal",ref:s,children:n.map(a=>i("li",{className:"border-t-2 first:border-0 border-gray-300",children:i("button",{className:"flex flex-row items-center w-full px-4 py-3",onClick:()=>{o(!1),setTimeout(a.action,50)},children:[i("span",{className:"mr-2.5 text-gray-700","aria-hidden":!0,children:a.icon}),a.text]})},a.text))})})]})}function Si(e){const[t,n]=e.split(":").map(Number);return t*60+n}const no=(e,t)=>Si(e)-t;function an({onSelect:e}){const t=Ce(),{park:n}=V(),[r,o]=T(),{loadData:s,loaderElem:a}=Y();return C(()=>{s(async()=>{const c=await t.experiences(n);o(c.filter(d=>d.available&&!!d.nextAvailableTime).sort((d,u)=>d.name.localeCompare(u.name)))})},[n,t,s]),i(M,{heading:"Select Experience",theme:n.theme,children:[r?r.length===0?i("p",{children:"There are currently no DAS experiences available."}):i(S,{children:[i(Oe,{heading:"Attractions",experiences:r.filter(c=>c.type==="ATTRACTION"),onSelect:e}),i(Oe,{heading:"Characters",experiences:r.filter(c=>c.type==="CHARACTER"),onSelect:e}),i(Oe,{heading:"Entertainment",experiences:r.filter(c=>c.type==="ENTERTAINMENT"),onSelect:e})]}):null,a]})}function Oe({experiences:e,heading:t,onSelect:n}){const{park:r}=V();if(e.length===0)return null;const o=Si(D().time);return i("div",{className:`mt-4 rounded overflow-hidden ${r.theme.bg}`,children:[i("h3",{className:"mt-0 py-1 text-white text-xs font-semibold text-center uppercase",children:t}),i("ul",{className:"bg-white bg-opacity-90 leading-snug",children:e.map(s=>i("li",{className:"flex items-center pt-3 last:pb-3",children:[i("div",{className:"flex-1 px-2",children:s.name}),i("div",{className:"px-2",children:i(L,{onClick:()=>n(s),children:i("span",{className:"min-w-[4rem]",children:[no(s.nextAvailableTime,o)," ",i("abbr",{title:"minutes",children:"min."})]})})})]},s.id))})]})}function cn({party:e}){const{goTo:t,goBack:n}=$(),r=Ce(),{park:o}=V(),{refreshPlans:s}=re(),[a,c]=T(),[d,u]=T(new Set(e)),[l,f]=T({}),{loadData:p,loaderElem:h}=Y();async function _(){a&&p(async()=>{try{const k=await r.book({park:o,experience:a,guests:[...d]});s(),await n({screen:ie}),t(i(he,{booking:k,isNew:!0}))}catch(k){throw k instanceof We&&f(k.conflicts),k}},{messages:{[We.name]:"Some guests not eligible"}})}return i(M,{heading:"DAS Selection",theme:o.theme,children:[i("h3",{children:"Experience"}),a?i("div",{className:"flex items-center mt-3",children:[i("div",{className:"text-lg font-semibold truncate",children:a.name}),i("div",{className:"ml-3",children:i(L,{type:"small",onClick:()=>t(i(an,{onSelect:k=>{c(k),n()}})),children:"Modify"})})]}):i("div",{className:"mt-3 text-center",children:i(L,{onClick:()=>t(i(an,{onSelect:k=>{c(k),n()}})),children:"Select Experience"})}),i("h3",{children:"DAS Guest"}),i(O,{guests:e.slice(0,1),conflicts:l}),e.length>1&&i(S,{children:[i("h3",{children:"Additional Guests"}),i(O,{guests:e.slice(1),selectable:{isSelected:k=>d.has(k),onToggle:k=>{d.has(k)?d.delete(k):d.add(k),u(new Set(d))}},conflicts:l})]}),i(H,{disabled:!e||!a,onClick:_,children:"Request Return Time"}),h]})}function io({parties:e}){const{goTo:t}=$(),{park:n}=V(),{plans:r,refreshPlans:o}=re(),[s,a]=T(!0);C(o,[o]),C(()=>a(!1),[r]),C(()=>a(!0),[]);const c=new Set(e.map(p=>p[0]).map(p=>p.id)),d=r.filter(p=>p.type==="DAS"&&p.subtype==="IN_PARK"),u=new Map(d.filter(p=>p.type==="DAS"&&p.subtype==="IN_PARK").map(p=>{var h;return[((h=p.guests.find(_=>c.has(_.id)))==null?void 0:h.id)??"",p]}));if(!s&&e.length===1){const p=e[0],h=u.get(p[0].id);return h?i(he,{booking:h}):i(cn,{party:p})}const l=e.filter(p=>!(u!=null&&u.has(p[0].id))),f=e.filter(p=>u==null?void 0:u.has(p[0].id));return i(M,{heading:`DAS ${e.length===1?"Selection":"Parties"}`,theme:n.theme,children:s?i(Jn,{}):e.length>0?i(S,{children:[l.length>0&&i(S,{children:[i("h3",{children:"Select Next Experience"}),i("ul",{className:"mt-2",children:l.map(p=>i("li",{className:"flex items-center gap-x-3 pl-3 py-1",children:[i("span",{className:"flex-shrink-0 w-[48px] h-[48px] leading-[48px] rounded-full text-3xl font-bold text-center bg-gray-400 text-white","aria-hidden":"true",children:p[0].avatarImageUrl?i("img",{src:p[0].avatarImageUrl,alt:"",width:"48",height:"48",className:"rounded-full"}):p[0].name[0]}),i("span",{className:"flex-1 leading-tight",children:p[0].name}),i(L,{type:"small",onClick:()=>t(i(cn,{party:p})),children:"Select"})]},p[0].id))})]}),f.length>0&&i(S,{children:[i("h3",{children:"Current Selection"}),i("ul",{className:"mt-2",children:f.map(p=>{const h=u.get(p[0].id);return i("li",{className:"flex items-center gap-x-3 pl-3 py-1",children:[i("span",{className:"flex-shrink-0 w-[48px] h-[48px] leading-[48px] rounded-full text-3xl font-bold text-center bg-gray-400 text-white","aria-hidden":"true",children:p[0].avatarImageUrl?i("img",{src:p[0].avatarImageUrl,alt:"",width:"48",height:"48",className:"rounded-full"}):p[0].name[0]}),i("div",{className:"flex-1",children:[i("div",{children:p[0].name}),h&&i("div",{className:"text-gray-500 text-xs font-semibold uppercase",children:[h.name," @"," ",i(q,{time:h.start.time})]})]}),i(L,{type:"small",onClick:()=>{h&&t(i(he,{booking:h}))},children:"Details"})]},p[0].id)})})]})]}):i("div",{})})}function ro({contentRef:e}){const{goTo:t}=$(),{resort:n}=me(),{experiences:r,refreshExperiences:o,loaderElem:s}=lt(),a=Kn(),c=u=>t(i(so,{exp:u})),d=new Map;return r.filter(u=>u.standby.available||u.standby.unavailableReason==="TEMPORARILY_DOWN").sort((u,l)=>u.land.sort-l.land.sort||(u.sort||1/0)-(l.sort||1/0)||u.name.localeCompare(l.name)).forEach(u=>{var l,f;d.has(u.land)||d.set(u.land,{ATTRACTION:[],ENTERTAINMENT:[],CHARACTER:[]}),(f=(l=d.get(u.land))==null?void 0:l[u.type])==null||f.push(u)}),i(ct,{heading:"Times Guide",buttons:i(S,{children:[n==="WDW"&&a.length>0&&i(L,{title:"Disability Access Service",onClick:()=>t(i(io,{parties:a})),children:"DAS"}),i(xi,{}),i(Ae,{name:"Times",onClick:o})]}),contentRef:e,children:[[...d].map(([u,l])=>i("div",{children:[i("h2",{className:`pr-1 ${u.theme.text} text-sm font-semibold text-right uppercase`,children:u.name}),i("div",{className:"rounded overflow-hidden",children:[i(Ge,{title:"Attractions",land:u,experiences:l.ATTRACTION,onInfoClick:c}),i(Ge,{title:"Entertainment",land:u,experiences:l.ENTERTAINMENT,onInfoClick:c}),i(Ge,{title:"Characters",land:u,experiences:l.CHARACTER,onInfoClick:c})]})]},u.name)),r.length>0&&i(vi,{children:[i(le,{sym:"*",def:"No listed wait/show time"}),i(le,{sym:"\u274C",def:"Temporarily down"})]}),s]})}function Ge({title:e,land:t,experiences:n,onInfoClick:r}){return n.length===0?null:i("div",{className:`${t.theme.bg}`,"data-testid":`${t.name}-${e}`,children:[i("h3",{className:"mt-0 py-1 text-white text-xs font-semibold text-center uppercase",children:e}),i("table",{className:"w-full bg-white bg-opacity-90 leading-snug",children:i("tbody",{children:n.map(o=>{var s;return i("tr",{className:"group",children:[i("td",{className:`${o.standby.displayNextShowTime?"min-w-[5.625rem]":"min-w-[2.75rem]"} px-2 py-0.5 group-first:pt-1 group-last:pb-1 ${t.theme.bg} bg-opacity-10 ${t.theme.text} font-bold text-center uppercase whitespace-nowrap`,children:o.standby.displayNextShowTime?(((s=o.displayAdditionalShowTimes)==null?void 0:s.length)??0)>0?i("button",{onClick:()=>r(o),className:"underline",children:o.standby.displayNextShowTime}):o.standby.displayNextShowTime:o.standby.available?o.standby.waitTime??"*":"\u274C"}),i("td",{className:"w-full px-1 pl-2 py-0.5 group-first:pt-1 group-last:pb-1",children:o.name})]},o.id)})})})]})}const so=({exp:e})=>{var t;return i(M,{heading:"Experience Info",children:[i("h2",{children:e.name}),i("div",{children:e.park.name}),i("h3",{children:["Upcoming ",e.type==="CHARACTER"?"Appearances":"Shows"]}),i("ul",{className:"list-disc mt-2 pl-6",children:[!!e.standby.displayNextShowTime&&i("li",{children:e.standby.displayNextShowTime}),(t=e.displayAdditionalShowTimes)==null?void 0:t.map(n=>i("li",{children:n},n))]})]})},ln=6e4,Ii="bg1.genie.merlock.tab",oo=()=>localStorage.getItem(Ii)??"Genie+",ao=[{name:"Genie+",icon:i(Ve,{}),component:js},{name:"Times",icon:i(ss,{}),component:ro},{name:"Plans",icon:i(ri,{}),component:mi}],co=i(to,{}),ie=ns({tabs:ao,footer:co},({tab:e})=>{const{current:t}=it(),n=te(),{park:r}=V(),o=rs(),{refreshExperiences:s}=o,{refreshPlans:a}=re(),c=j(null);return C(()=>{localStorage.setItem(Ii,e.name)},[e]),C(()=>st(()=>{t.type===ie&&(s(ln),a(ln))}),[t,s,a]),C(()=>{var d;n.current&&((d=c.current)==null||d.scroll(0,0))},[n]),i(jn,{value:r.theme,children:i(is,{value:o,children:i(e.component,{contentRef:c})})})});function lo(){return i(Wr,{value:Fr(),children:i(qr,{value:Zr(),children:i(Xr,{value:es(),children:i(jr,{value:Vr(),children:i(Wn,{children:i(ie,{tabName:oo()})})})})})})}function Ei({queue:e,screen:t}){const{current:n}=it(),{resort:r}=me();return e.isAcceptingJoins||n.type!==t?null:i(yi,{resort:r,time:e.nextScheduledOpenTime,label:"Next queue opening"})}function pt({queue:e,heading:t,children:n}){var r;return i(M,{heading:t,theme:(r=e.park)==null?void 0:r.theme,children:[i("h2",{children:e.name}),n]})}const uo=5e3;function ho({queue:e,guests:t,result:n}){const{boardingGroup:r,conflicts:o}=n,s=r!==null,a=t.filter(f=>!(f.id in o)),c=t.filter(f=>f.id in o),{goBack:d}=$(),[u,l]=T(!1);return C(()=>{s&&setTimeout(()=>l(!0),uo)},[s]),i(pt,{queue:e,heading:"Boarding Group",children:s?i(S,{children:[i("h3",{children:"Congratulations! \u{1F389}"}),i("p",{children:"You joined the virtual queue!"}),i("p",{className:"text-lg font-semibold",children:["Boarding Group: ",r]}),i(O,{guests:a}),Object.keys(o).length>0&&i(S,{children:[i("p",{className:"font-semibold",children:"These guests could not join:"}),i(O,{guests:c,conflicts:o})]}),i("p",{children:"Refer to the My Disney Experience app for return time and other information."}),u&&i(H,{onClick:()=>d({screen:ft}),children:"Done"})]}):i(S,{children:[i("h3",{children:"Sorry!"}),i("p",{children:"A boarding group could not be obtained. Go back and try again."}),i(O,{guests:c,conflicts:o})]})})}function Ti({queue:e,guests:t}){const{goTo:n}=$(),r=nt(),{loadData:o,loaderElem:s}=Y();async function a(){await o(async c=>{if(!e||!(await r.getQueue(e)).isAcceptingJoins){c("Queue not open yet");return}const d=await r.joinQueue(e,t);n(i(ho,{queue:e,guests:t,result:d}),{replace:!0}),d.boardingGroup!==null&&pi()},{minLoadTime:999})}return i(pt,{queue:e,heading:"Join Virtual Queue",children:[i(Ei,{queue:e,screen:Ti}),i("h3",{children:"Your Party"}),i(O,{guests:t}),i(H,{onClick:a,children:"Join Virtual Queue"}),s]})}function Ci({queue:e}){const{goTo:t}=$(),n=nt(),{loadData:r,loaderElem:o,flash:s}=Y(),[a,c]=T([]),[d,u]=T(new Set);C(()=>{r(async()=>{const f=await n.getLinkedGuests(e);c(f),u(new Set(f.filter(p=>p.preselected)))})},[e,n,r]);function l(f){const p=new Set(d);p[p.has(f)?"delete":"add"](f);const h=Number(e==null?void 0:e.maxPartySize);h>0&&p.size>h?s(`Maximum party size: ${h}`):(u(p),s(""))}return i(pt,{queue:e,heading:"Choose Your Party",children:[e.howToEnterMessage.split(`

`).map((f,p)=>i("p",{children:f},p)),i(Ei,{queue:e,screen:Ci}),i("h3",{children:"Choose Your Party"}),a.length>0?i(O,{guests:a,selectable:{isSelected:f=>d.has(f),onToggle:l}}):i("p",{children:"No guests available"}),i(H,{disabled:d.size===0,onClick:()=>t(i(Ti,{queue:e,guests:[...d]})),children:"Confirm Party"}),o]})}const dn=e=>e.categoryContentId==="attraction",oe=e=>e.isAcceptingPartyCreation||e.isAcceptingJoins;function ft(){const e=nt(),{goTo:t,goBack:n}=$(),r=G(),{loadData:o,loaderElem:s}=Y(),[a,c]=T([]),[d,u]=T(!1),[,l]=T(),f=W(()=>{o(async()=>{const p=await e.getQueues();p.sort((h,_)=>+oe(_)-+oe(h)||+dn(_)-+dn(h)),c(p),l(h=>{if(!h)return h;const _=p.find(k=>k.id===h.id);if(_&&oe(_))return h;l(void 0),n({screen:ft})}),u(!0)})},[e,n,o]);return C(()=>(f(),st(f)),[f]),i(M,{heading:"Virtual Queues",buttons:i(L,{title:"Refresh Queues",onClick:f,children:i(ot,{})}),footer:i("div",{className:"p-2 text-right",children:i(L,{className:`bg-opacity-90 bg-white ${r.text}`,onClick:()=>e.logOut(),children:"Log Out"})}),children:[a.length>0?i("ul",{className:"mt-1",children:a.map(p=>i("li",{className:"py-3 first:border-0 border-t-4 border-gray-300",children:[i("h2",{className:"mt-0",children:p.name}),i("div",{className:"flex items-center mt-2",children:[i("div",{className:"flex-1",children:p.isAcceptingJoins?i("span",{children:"Available now"}):p.nextScheduledOpenTime?i(S,{children:["Next opening:"," ",i("time",{dateTime:p.nextScheduledOpenTime,className:"font-semibold",children:Z(p.nextScheduledOpenTime)})]}):"No more openings today"}),i("div",{className:"pl-3",children:i(L,{disabled:!oe(p),onClick:()=>{l(p),t(i(Ci,{queue:p}))},children:oe(p)?"Join Queue":"Closed"})})]})]},p.id))}):d&&!s?i("p",{className:"text-gray-500 font-semibold text-center uppercase",children:"No virtual queues found"}):null,s]})}function po(){return i(Wn,{children:i(ft,{})})}const fo=1;function mo(){document.body.addEventListener("click",()=>null)}function _o({authStore:e}){const[t,n]=T(),[r,o]=T(i("div",{})),s=Mr(),a=Gr(fo),[c,d]=T(()=>{try{e.getData()}catch(u){if(!(u instanceof Rn))throw u;return!0}return!1});return C(()=>{mo()},[]),C(()=>{e.onUnauthorized=()=>d(!0);for(const[u,l]of[[zt,lo],[Fe,po]])try{const f=u.originToResort(origin);n(f),rr({WDW:"America/New_York",DLR:"America/Los_Angeles"}[f]),yr(f).then(p=>{o(i(Ir,{value:p,children:i(Sr,{value:new zt(p,e),children:i(Nr,{value:new fr(p,e),children:i(Er,{value:new Fe(p,e),children:i(l,{})})})})}))});return}catch(f){if(!(f instanceof $n))throw f}location.href="https://joelface.github.io/bg1/start.html"},[e]),C(()=>{function u(){if(!c)try{e.getData(),d(!1)}catch{d(!0)}}return u(),st(u)},[e,c]),s||a||c&&t&&i(Hr,{resort:t,onLogin:u=>{e.setData(u),d(!1)}})||r}Pi();function Pi(){if(!document.body){setTimeout(Pi,100);return}go(),yo().render(i(_o,{authStore:new or("bg1.auth")}))}function go(){const e=document.createElement("meta");e.name="viewport",e.content="width=device-width, initial-scale=1, maximum-scale=1",document.head.appendChild(e)}function yo(){return ir(document.body.appendChild(document.createElement("div")))}
